# GR Atom: Secure Transport
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "PROTO-SECURITY-SECUTRAN-001"
  name: "Secure Transport"
  normalized_name: "secure_transport"
  aliases:
    - "Apple Secure Transport"
    - "SecureTransport"
    - "SSLCreateContext"
    - "Apple TLS Implementation"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "protocol"
  abstraction_level: 3
  atom_tags:
    - TLS
    - ENCRYPT
    - NETWORK

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L5", "L6", "L7"]
  target_zones: ["Z1", "Z2", "Z3"]
  target_components: []

# ==== Section 5: Definition ====
definition:
  what: >-
    Secure Transport is Apple's native TLS/SSL implementation framework that provides
    cryptographic transport security for macOS, iOS, watchOS, and tvOS applications. It is a
    system-level API (Security.framework) that implements SSL 3.0 through TLS 1.3, handling
    certificate validation, cipher suite negotiation, and secure session management for Apple
    platform applications. Secure Transport serves as the default TLS provider for system
    services including Safari, Mail, and all apps using URLSession/NSURLConnection networking
    APIs. Apple deprecated the legacy Secure Transport API in favor of Network.framework
    (introduced in iOS 12/macOS 10.14) which provides a modern, protocol-agnostic networking
    interface while still using the underlying Secure Transport engine.
  why: >-
    Apple platforms require a tightly integrated TLS implementation that enforces platform
    security policies including App Transport Security (ATS), certificate transparency
    requirements, and managed certificate trust stores. Secure Transport provides this by
    controlling the entire TLS stack from cipher suite selection to certificate chain validation,
    ensuring consistent security behavior across all Apple applications. The framework enforces
    Apple's security requirements such as minimum TLS 1.2 for ATS compliance, mandatory
    forward secrecy cipher suites, and certificate transparency enforcement for publicly
    trusted certificates. The 2014 "goto fail" vulnerability (CVE-2014-1266) in Secure
    Transport highlighted the critical importance of this implementation, as a single code
    error bypassed all SSL certificate verification on Apple devices.
  how: >-
    Secure Transport operates as a Security.framework API on Apple platforms. Applications
    create SSL contexts via SSLCreateContext (legacy) or NWProtocolTLS.Options (modern),
    configure TLS parameters including minimum/maximum protocol versions and cipher suites,
    and associate the context with network connections. The framework performs the TLS handshake
    including server certificate validation against the Apple trust store, certificate
    transparency verification, and optional client certificate authentication. Apple maintains
    a curated root certificate program that determines which CAs are trusted on Apple devices.
    The framework integrates with the Keychain for certificate and private key storage.
    Network.framework wraps Secure Transport with a modern async/await API, connection
    lifecycle management, and automatic protocol selection including QUIC/HTTP3 support.
  core_concepts:
    - key: "App Transport Security (ATS)"
      value: >-
        Apple's policy framework enforced through Secure Transport that requires HTTPS with
        TLS 1.2 or higher, forward secrecy cipher suites, and certificates with at least
        SHA-256 signatures for all network connections by default.
    - key: "Apple Root Certificate Program"
      value: >-
        Apple maintains a curated set of trusted root certificates that Secure Transport
        uses for certificate chain validation, with periodic updates distributed through
        OS updates.
    - key: "goto fail Vulnerability"
      value: >-
        CVE-2014-1266 was a critical vulnerability in Secure Transport where a duplicate
        goto statement caused SSL certificate verification to be completely bypassed,
        allowing man-in-the-middle attacks on all Apple platforms.
    - key: "Network.framework Migration"
      value: >-
        Apple's modern networking API that wraps Secure Transport with async/await patterns,
        connection lifecycle management, and support for modern protocols including QUIC
        and HTTP/3.

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "PROTO-SECURITY-TLTRLASE-001"
    description: "Secure Transport is Apple's platform-specific implementation of the TLS protocol suite"
  - type: "enables"
    target: "PROTO-SECURITY-TLS13-001"
    description: "Secure Transport implements TLS 1.3 support for all Apple platform applications"
  - type: "enables"
    target: "PROTO-SECURITY-TLS12-001"
    description: "Secure Transport implements TLS 1.2 as the minimum required version for App Transport Security compliance"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "Apple Developer Documentation - Secure Transport. https://developer.apple.com/documentation/security/secure-transport"
    - "Apple Developer Documentation - Network Framework. https://developer.apple.com/documentation/network"
    - "CVE-2014-1266 - Apple Secure Transport goto fail. NIST NVD. https://nvd.nist.gov/vuln/detail/CVE-2014-1266"
    - "Apple App Transport Security - Preventing Insecure Network Connections. https://developer.apple.com/documentation/bundleresources/information_property_list/nsapptransportsecurity"
  search_keywords:
    - "Secure Transport"
    - "Apple TLS"
    - "SecureTransport"
    - "App Transport Security"
    - "goto fail"
    - "CVE-2014-1266"
    - "Apple SSL"
    - "Network.framework TLS"
    - "iOS TLS implementation"
  embedding_text: >-
    Secure Transport is Apple's native TLS/SSL implementation framework providing cryptographic
    transport security for macOS, iOS, watchOS, and tvOS. It implements SSL 3.0 through TLS 1.3
    as part of Security.framework, serving as the default TLS provider for Safari, Mail, and all
    apps using URLSession networking. The framework enforces Apple platform security policies
    including App Transport Security requiring minimum TLS 1.2 with forward secrecy, certificate
    transparency verification, and validation against the Apple root certificate program. The
    2014 goto fail vulnerability CVE-2014-1266 demonstrated the criticality of this implementation
    when a duplicate goto statement bypassed all SSL certificate verification. Apple deprecated
    the legacy Secure Transport API in favor of Network.framework which provides modern
    async/await networking with automatic QUIC/HTTP3 support while using the same underlying
    TLS engine. The framework integrates with Keychain for certificate and key storage.
