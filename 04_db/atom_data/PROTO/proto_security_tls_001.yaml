# GR Atom: Hybrid TLS
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "PROTO-SECURITY-TLS-001"
  name: "Hybrid TLS"
  normalized_name: "hybrid_tls"
  aliases:
    - "Hybrid Key Exchange TLS"
    - "Hybrid Post-Quantum TLS"
    - "PQ/T Hybrid TLS"
    - "Composite Key Exchange TLS"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "protocol"
  abstraction_level: 2
  atom_tags:
    - TLS
    - CRYPTO
    - ENCRYPT
    - NETWORK

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L5", "L6"]
  target_zones: ["Z1", "Z2", "Z3", "Z4"]
  target_components: []

# ==== Section 5: Definition ====
definition:
  what: >-
    Hybrid TLS is a key exchange approach that combines a traditional (classical) key exchange
    algorithm with a post-quantum key encapsulation mechanism (KEM) within a single TLS
    handshake, producing a shared secret that is secure as long as either algorithm remains
    unbroken. Defined in draft-ietf-tls-hybrid-design and implemented by major vendors including
    Cloudflare (X25519Kyber768) and Google (X25519Kyber768Draft00), Hybrid TLS addresses the
    cryptographic transition period where classical algorithms may be vulnerable to future
    quantum computers but post-quantum algorithms have not yet accumulated sufficient
    cryptanalytic confidence. NIST's post-quantum standardization (FIPS 203, ML-KEM) provides
    the foundation for the post-quantum component.
  why: >-
    The advent of cryptographically relevant quantum computers threatens all currently deployed
    key exchange algorithms based on discrete logarithms or elliptic curves. However, deploying
    purely post-quantum algorithms carries risk because these newer constructions lack the
    decades of cryptanalytic scrutiny that classical algorithms have undergone. Hybrid TLS
    provides defense-in-depth by ensuring that even if the post-quantum algorithm is broken by
    classical cryptanalysis, the classical component maintains security, and conversely, if a
    quantum computer breaks the classical component, the post-quantum component provides
    protection. NSA's CNSA 2.0 suite and NIST recommendations explicitly endorse hybrid
    approaches during the transition period. Major browsers and CDNs have deployed hybrid
    key exchange since 2023 to begin protecting against harvest-now-decrypt-later attacks.
  how: >-
    In Hybrid TLS, the client's key_share extension in ClientHello contains a hybrid key share
    that combines a classical ECDH share (typically X25519) with a post-quantum KEM public key
    (typically ML-KEM-768/Kyber768). The server performs both key exchanges: it computes the
    ECDH shared secret and encapsulates a KEM shared secret using the client's post-quantum
    public key. Both shared secrets are concatenated and fed into the TLS 1.3 key schedule via
    HKDF to derive the handshake and application traffic keys. The combined shared secret
    ensures security as long as either the ECDH or KEM problem remains hard. Named groups such
    as X25519Kyber768Draft00 (0x6399) and X25519MLKEM768 are registered for use in the TLS
    supported_groups extension. The additional KEM ciphertext increases the ServerHello size
    by approximately 1 KB.
  core_concepts:
    - key: "Defense-in-Depth Key Exchange"
      value: >-
        Combining classical and post-quantum algorithms ensures the overall key exchange
        remains secure even if one component algorithm is compromised, providing a safety
        net during the cryptographic transition.
    - key: "Harvest-Now-Decrypt-Later Protection"
      value: >-
        Hybrid TLS protects against adversaries recording encrypted traffic today with the
        intent of decrypting it when quantum computers become available, by incorporating
        quantum-resistant key material into current sessions.
    - key: "Concatenated Key Schedule"
      value: >-
        Both the classical ECDH shared secret and the KEM shared secret are concatenated
        and processed through TLS 1.3 HKDF key derivation, ensuring both contribute to
        the final traffic keys.
    - key: "X25519Kyber768"
      value: >-
        The most widely deployed hybrid key exchange combination, pairing the X25519 elliptic
        curve Diffie-Hellman with Kyber768 (ML-KEM-768) key encapsulation, offering
        approximately 128-bit classical and post-quantum security.

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "PROTO-SECURITY-TLTRLASE-001"
    description: "Hybrid TLS is a TLS key exchange variant that extends the standard TLS 1.3 handshake with combined key shares"
  - type: "requires"
    target: "PROTO-SECURITY-TLS13-001"
    description: "Hybrid TLS builds upon the TLS 1.3 key_share extension mechanism for composite key exchange"
  - type: "alternative_to"
    target: "PROTO-SECURITY-TLS-002"
    description: "Hybrid TLS is a transitional alternative to pure Post-Quantum TLS, combining classical and PQ algorithms"
  - type: "alternative_to"
    target: "PROTO-SECURITY-KEMTLS-001"
    description: "Hybrid TLS uses hybrid key exchange within standard TLS 1.3 as an alternative to the KEMTLS protocol redesign"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "draft-ietf-tls-hybrid-design - Hybrid Key Exchange in TLS 1.3. IETF. https://datatracker.ietf.org/doc/draft-ietf-tls-hybrid-design/"
    - "NIST FIPS 203 - Module-Lattice-Based Key-Encapsulation Mechanism Standard (ML-KEM). https://csrc.nist.gov/pubs/fips/203/final"
    - "CNSA 2.0 - Commercial National Security Algorithm Suite 2.0. NSA. https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF"
    - "Stebila, D. & Fluhrer, S. (2023). X25519Kyber768Draft00 Hybrid Post-Quantum Key Agreement. Cloudflare Research."
  search_keywords:
    - "hybrid TLS"
    - "hybrid key exchange"
    - "X25519Kyber768"
    - "post-quantum hybrid"
    - "ML-KEM TLS"
    - "PQ/T hybrid"
    - "harvest now decrypt later"
    - "composite key exchange"
    - "CNSA 2.0"
    - "quantum-safe TLS"
  embedding_text: >-
    Hybrid TLS combines a classical key exchange algorithm such as X25519 with a post-quantum
    key encapsulation mechanism like ML-KEM-768 (Kyber768) within a single TLS 1.3 handshake.
    The approach produces a shared secret that remains secure as long as either component
    algorithm is unbroken, providing defense-in-depth during the quantum transition period.
    Defined in draft-ietf-tls-hybrid-design, Hybrid TLS addresses both the threat of future
    quantum computers to classical algorithms and the insufficient cryptanalytic maturity of
    post-quantum constructions. The client sends combined key shares in the ClientHello
    key_share extension, the server performs both exchanges, and the concatenated shared
    secrets feed into the TLS 1.3 HKDF key schedule. Major deployments include Cloudflare
    and Google using X25519Kyber768. NSA CNSA 2.0 and NIST recommend hybrid approaches to
    protect against harvest-now-decrypt-later attacks where adversaries record encrypted
    traffic for future quantum decryption. The additional KEM ciphertext adds approximately
    1 KB to the handshake.
