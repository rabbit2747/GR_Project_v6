# GR Atom: Detecting Encrypted Botnet Traffic
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "DETECT-NETWORK-DEENBOTR-001"
  name: "Detecting Encrypted Botnet Traffic"
  normalized_name: "detecting_encrypted_botnet_traffic"
  aliases:
    - "Encrypted Botnet Detection"
    - "TLS Botnet Traffic Analysis"
    - "Encrypted C2 Botnet Detection"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 2
  atom_tags:
    - NETWORK
    - IDS
    - MONITOR
    - TLS
    - C2
    - THREAT_INTEL

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L4", "L5", "L7"]
  target_zones: ["Z2", "Z3", "Z4"]
  target_components: []

# ==== Section 5: Definition ====
definition:
  what: "A detection pattern targeting encrypted command-and-control traffic generated by botnets that use TLS/SSL encryption to evade content-based inspection. Since payload inspection is not possible with encrypted traffic, this pattern relies on metadata analysis including TLS handshake characteristics, certificate properties, JA3/JA3S fingerprints, connection timing patterns, flow statistics, and destination reputation to identify botnet communication without decrypting the traffic."
  why: "Modern botnets increasingly use encryption to hide their command-and-control communications within the large volume of legitimate HTTPS traffic. Traditional signature-based detection is ineffective against encrypted payloads. Detecting encrypted botnet traffic is essential for identifying compromised hosts participating in botnets, which may be used for DDoS attacks, spam distribution, credential harvesting, cryptomining, or as pivot points for further intrusions."
  how: "Detection techniques analyze TLS metadata without decryption: JA3 fingerprints identify client-side TLS parameters that distinguish malware from legitimate applications; certificate analysis examines issuer chains, validity periods, and Subject Alternative Names for anomalies; flow analysis detects characteristic botnet patterns such as uniform connection intervals, small fixed-size payloads, and many-to-one communication topologies; destination analysis flags connections to self-signed certificates, bullet-proof hosting providers, or domains with low reputation scores. Machine learning models trained on labeled botnet traffic features improve classification accuracy."
  core_concepts:
    - key: "TLS Fingerprinting"
      value: "Using JA3/JA3S hash values to identify malware families based on unique TLS client and server hello parameters."
    - key: "Certificate Anomaly Detection"
      value: "Analyzing TLS certificate properties for indicators of malicious infrastructure such as self-signed certs, short validity, or suspicious issuers."
    - key: "Encrypted Traffic Analysis"
      value: "Extracting behavioral features from encrypted sessions without decryption including timing, volume, and flow statistics."
    - key: "Botnet Topology Detection"
      value: "Identifying communication patterns characteristic of botnet architectures such as star, mesh, or hierarchical C2 structures."

# ==== Section 6: Relations ====
relations:
  - type: is_a
    target: "DETECT-NETWORK-BEACONING-001"
    description: "Encrypted botnet detection is a specialized form of beaconing detection for encrypted channels"
  - type: effective_against
    target: "ATK-C2-ENCRYPT-001"
    description: "Detects encrypted command-and-control communications used by botnets"
  - type: requires
    target: "DETECT-NETWORK-FLOWLOGS-001"
    description: "Requires flow log metadata for encrypted traffic analysis"
  - type: enables
    target: "DETECT-NETWORK-PROMETANO-001"
    description: "TLS metadata analysis enables broader protocol metadata anomaly detection"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1573"
    tactic:
      - "Command and Control"
    sub_techniques:
      - "T1573.001"
      - "T1573.002"
  defense_context:
    effectiveness: "medium"
    d3fend_mapping: "D3-NTCD"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "secondary"
  sources:
    - "MITRE ATT&CK - Encrypted Channel T1573"
    - "Cisco - Joy: A Package for Capturing and Analyzing Encrypted Network Traffic"
    - "Salesforce - JA3: SSL/TLS Client Fingerprinting"
    - "IEEE - Machine Learning for Encrypted Botnet Traffic Classification"
  search_keywords:
    - "encrypted botnet"
    - "TLS fingerprinting"
    - "JA3 fingerprint"
    - "encrypted C2"
    - "botnet detection"
    - "encrypted traffic analysis"
    - "certificate anomaly"
    - "TLS metadata"
    - "botnet communication"
    - "encrypted malware traffic"
  embedding_text: "Detecting encrypted botnet traffic is a network detection pattern that identifies command-and-control communications from botnets using TLS/SSL encryption without requiring payload decryption. It relies on TLS metadata analysis including JA3/JA3S fingerprinting, certificate property inspection, connection timing and flow statistics, and destination reputation scoring. The pattern detects characteristic botnet behaviors such as uniform connection intervals, fixed-size payloads, and suspicious certificate chains. This capability is critical for identifying compromised hosts participating in botnets that hide their C2 traffic within the volume of legitimate encrypted web traffic."
