# GR Atom: Windows Registry Value Update Event
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "DETECT-ENDPOINT-WIREVAUP-001"
  name: "Windows Registry Value Update Event"
  normalized_name: "windows_registry_value_update_event"
  aliases:
    - "Registry Value Modification"
    - "Registry Value Change"
    - "Registry Data Update"
    - "Registry Value Overwrite"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 1
  atom_tags:
    - EDR
    - SIEM
    - AUDIT
    - LOG
    - MONITOR
    - EVADE
    - PERSIST
    - WINDOWS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z1", "Z2", "Z3"]
  target_components: []

# ==== Section 5: Definition ====
definition:
  what: "A detection pattern that identifies when existing Windows registry values are modified or overwritten on an endpoint, specifically distinguishing updates to existing values from initial value creation. Sysmon Event ID 13 (RegistryEvent - Value Set) captures both creation and modification, with the distinction determined by whether the value previously existed. Windows Security Event ID 4657 differentiates between value creation and modification through the operation type field. The event records the previous value data, the new value data, the full registry path, the modifying process, and user context."
  why: "Registry value updates that change existing configuration data are critical for detecting adversaries modifying legitimate system settings. Unlike value creation which adds new entries, value updates alter existing configurations making them harder to detect through simple new-entry monitoring. Adversaries update values to redirect service execution paths, disable security features by changing configuration values, modify firewall rules, alter group policy settings, and tamper with existing autostart entries to substitute their own payloads."
  how: "Detection monitors Sysmon Event ID 13 for value set operations on pre-existing values, comparing against known-good baselines to identify unauthorized changes. Windows Security Event ID 4657 provides the operation type distinguishing creation from modification. EDR agents track value change history, maintaining previous and current values for comparison. SIEM rules implement change detection logic comparing new values against expected baselines, alerting on modifications to security-critical values such as service ImagePath, security policy settings, firewall configurations, and autostart executable paths."
  core_concepts:
    - key: "value_change_detection"
      value: "Comparing previous and new value data to identify the specific changes made and assess their security significance"
    - key: "baseline_comparison"
      value: "Maintaining known-good value data for critical registry values to detect unauthorized modifications through drift detection"
    - key: "legitimate_service_hijacking"
      value: "Modifying existing service ImagePath values to redirect execution from legitimate binaries to malicious payloads"
    - key: "security_setting_tampering"
      value: "Changing registry values that control security features from enabled to disabled states to weaken endpoint defenses"

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "DETECT-ENDPOINT-WINREGVAL-001"
    description: "Registry value update is a specific type of registry value operation event"
  - type: "requires"
    target: "DETECT-ENDPOINT-WIREVAGE-001"
    description: "Value update operations are typically preceded by value read operations to assess current data"

# ==== Section 7: Security Profile (optional) ====
security_profile:
  mitre_mapping:
    technique_id: "T1112"
    tactic:
      - "defense-evasion"
      - "persistence"
    sub_techniques: []
  defense_context:
    effectiveness: "high"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "Sysmon Documentation - Event ID 13 RegistryEvent Value Set"
    - "Microsoft Documentation - RegSetValueEx Function"
    - "MITRE ATT&CK T1112 - Modify Registry"
    - "Windows Security Event ID 4657 Reference"
  search_keywords:
    - "registry value update"
    - "registry value modification"
    - "registry value change"
    - "registry data update"
    - "Sysmon Event ID 13"
    - "registry value overwrite"
    - "Event ID 4657"
    - "registry drift detection"
    - "registry value tampering"
    - "security setting change"
  embedding_text: "Windows registry value update event detection pattern identifies when existing registry values are modified or overwritten, distinguishing updates from initial creation. Sysmon Event ID 13 and Windows Security Event ID 4657 capture value modifications with previous and new data comparison. Adversaries update values to redirect service execution paths, disable security features, modify firewall rules, and substitute autostart payloads. Maps to MITRE ATT&CK T1112 Modify Registry. Detection implements baseline comparison to identify unauthorized changes to security-critical values including service ImagePath, security policy settings, and autostart entries. Change detection logic assesses the security significance of specific data modifications."
