# GR Atom: Error Pages
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "DETECT-ENDPOINT-ERROPAGE-001"
  name: "Error Pages"
  normalized_name: "error_pages"
  aliases:
    - "Error Page Detection"
    - "Application Error Response"
    - "HTTP Error Page Monitoring"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 2
  atom_tags:
    - LOG
    - MONITOR
    - NETWORK
    - IDS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z2", "Z3", "Z4"]
  target_components: []

# ==== Section 5: Definition ====
definition:
  what: "Detection pattern for monitoring and analyzing error pages generated by applications and web services on endpoints. Error pages include HTTP status codes (4xx client errors, 5xx server errors), application stack traces, debug output, and custom error responses. Analysis of error page content and frequency patterns reveals reconnaissance activity, exploitation attempts, misconfigurations, and information disclosure vulnerabilities that expose internal system details to potential attackers."
  why: "Error pages frequently expose sensitive technical details including server software versions, internal file paths, database connection strings, stack traces, and framework information. Attackers deliberately trigger error conditions during reconnaissance to harvest this information. Monitoring error page patterns also reveals brute-force attempts, directory traversal attacks, and exploitation of input validation flaws."
  how: "Monitor application and web server logs for elevated error rates and unusual error code distributions. Analyze error page content for information leakage of internal paths, technology stack details, and configuration data. Correlate error bursts with source IP addresses to identify scanning and reconnaissance activity. Implement custom error pages that suppress detailed technical information while logging full details internally for analysis."
  core_concepts:
    - key: "Information Disclosure"
      value: "The unintended exposure of sensitive technical details through verbose error messages, stack traces, and debug output"
    - key: "Error Rate Analysis"
      value: "Statistical monitoring of error frequency and distribution patterns to detect reconnaissance scanning and exploitation attempts"
    - key: "Custom Error Pages"
      value: "Sanitized error responses that prevent information leakage to external users while preserving detailed diagnostics for internal logging"

# ==== Section 6: Relations ====
relations:
  - type: part_of
    target: "DETECT-ENDPOINT-EDRTELE-001"
    description: "Error page monitoring is a component of endpoint telemetry collection"
  - type: effective_against
    target: "ATK-RECON-SCANNING-001"
    description: "Error page analysis detects reconnaissance scanning and probing activity"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1190"
    tactic:
      - "Initial Access"
      - "Reconnaissance"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "medium"
  trust_source: "secondary"
  sources:
    - "OWASP - Information Disclosure Through Error Messages"
    - "OCSF HTTP Activity Event Schema"
    - "NIST SP 800-92 - Guide to Computer Security Log Management"
  search_keywords:
    - "error page detection"
    - "HTTP error monitoring"
    - "stack trace exposure"
    - "information disclosure"
    - "error rate analysis"
    - "application error"
    - "debug output"
    - "verbose error"
  embedding_text: "Error Pages is an endpoint detection pattern for monitoring and analyzing error responses generated by applications and web services. This includes HTTP 4xx and 5xx status codes, application stack traces, debug output, and custom error responses. Error page analysis reveals reconnaissance activity, exploitation attempts, and information disclosure vulnerabilities that expose internal system details such as server versions, file paths, database connections, and framework information. Detection methods include error rate statistical analysis, content inspection for sensitive data leakage, correlation of error bursts with source addresses, and monitoring for patterns indicative of scanning, brute-force, and directory traversal attacks."
