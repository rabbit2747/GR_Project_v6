# GR Atom: File Name Anomalies
# Schema: atom_schema.yaml v5.1
# Status: enriched

identity:
  id: "DETECT-BEHAVIOR-FILNAMANO-001"
  name: "File Name Anomalies"
  normalized_name: "file_name_anomalies"
  aliases:
    - "Suspicious Filename Detection"
    - "File Naming Pattern Anomaly"
    - "Malicious Filename Indicators"
    - "Filename-Based Threat Detection"

classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 2
  atom_tags:
    - EVADE
    - EDR
    - MONITOR
    - FORENSICS

scope:
  target_layers: ["L5", "L6"]
  target_zones: ["Z2", "Z3"]
  target_components: []

definition:
  what: "File Name Anomalies detection identifies files with naming patterns that deviate from legitimate conventions or exhibit characteristics associated with malicious activity. This includes files with randomized alphanumeric names generated by malware, files impersonating system binaries through similar but misspelled names, files using Unicode homoglyphs to disguise their identity, files with excessive length or unusual character combinations, files using double extensions to mask their true type, and files placed in directories where their naming pattern does not match the expected convention. The technique combines pattern matching, statistical analysis, and machine learning to evaluate filename suspiciousness."
  why: "Malware frequently uses distinctive filename patterns that differ from legitimate software naming conventions. Auto-generated malware names often contain random alphanumeric strings, while targeted attacks may use names designed to deceive users through typosquatting of system binaries or use of Unicode characters that visually resemble legitimate names. Detecting filename anomalies provides an early warning signal that supplements content-based analysis, particularly valuable when file content analysis is unavailable or when the file is encrypted. It is also effective for detecting lateral movement tools and post-exploitation frameworks that create files with characteristic naming patterns."
  how: "Detection systems analyze filenames using multiple approaches. Pattern matching identifies known suspicious patterns including random hex strings, GUIDs used as filenames, and names matching known malware families. Statistical analysis evaluates character distribution, length, and entropy to flag randomly generated names. Homoglyph detection identifies characters from different Unicode scripts that visually resemble ASCII characters used in system binary names. Directory context analysis compares filename conventions against expected patterns for the directory, flagging executables in document folders or scripts in image directories. Machine learning classifiers trained on datasets of legitimate and malicious filenames provide probabilistic scoring. The technique integrates with file creation monitoring to analyze new files in real-time and with retrospective scanning to identify previously undetected suspicious files."
  core_concepts:
    - key: "Filename Entropy"
      value: "The statistical randomness of characters in a filename, where high entropy suggests auto-generated names typical of malware"
    - key: "Binary Name Impersonation"
      value: "Files named to resemble legitimate system binaries through misspellings, extra characters, or Unicode substitution"
    - key: "Directory Context"
      value: "The expected naming conventions for files in a specific directory, used to identify files that do not belong"

relations:
  - type: part_of
    target: "DETECT-BEHAVIOR-FILRISSCO-001"
    description: "Filename anomalies contribute to comprehensive file risk scoring"
  - type: requires
    target: "DETECT-BEHAVIOR-FILNAMENT-001"
    description: "File name anomaly detection uses filename entropy as a key analysis metric"
  - type: enables
    target: "DETECT-BEHAVIOR-HOMOGLYPH-001"
    description: "Filename anomaly detection includes homoglyph analysis as a detection component"

security_profile:
  mitre_mapping:
    technique_id: "T1036"
    tactic: ["Defense Evasion"]

metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "secondary"
  sources:
    - "MITRE ATT&CK T1036 - Masquerading - https://attack.mitre.org/techniques/T1036/"
    - "SANS - File Name Analysis for Threat Detection - https://www.sans.org/white-papers/"
    - "Elastic Security - File Naming Convention Rules - https://www.elastic.co/guide/en/security/"
  search_keywords:
    - "file name anomaly detection"
    - "suspicious filename"
    - "malware naming patterns"
    - "filename masquerading"
    - "random filename detection"
    - "file name impersonation"
    - "filename analysis security"
    - "binary name spoofing"
  embedding_text: "File Name Anomalies detection identifies files with naming patterns deviating from legitimate conventions or exhibiting malicious characteristics. It detects randomized alphanumeric names from malware generators, system binary impersonation through misspellings, Unicode homoglyph substitution, double extensions, and files with names inappropriate for their directory location. Analysis combines pattern matching for known malicious patterns, statistical evaluation of character distribution and entropy, homoglyph detection across Unicode scripts, directory context analysis, and machine learning classifiers. This technique provides early warning signals supplementing content-based analysis, particularly valuable for detecting lateral movement tools and post-exploitation frameworks with characteristic naming patterns."
