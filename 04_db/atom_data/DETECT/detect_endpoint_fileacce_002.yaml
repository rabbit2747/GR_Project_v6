# GR Atom: File Access Event
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "DETECT-ENDPOINT-FILEACCE-002"
  name: "File Access Event"
  normalized_name: "file_access_event"
  aliases:
    - "File Access Alert"
    - "File Read Event"
    - "OCSF File Access Event"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 1
  atom_tags:
    - EDR
    - SIEM
    - LOG
    - AUDIT
    - MONITOR

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L5", "L6", "L7"]
  target_zones: ["Z1", "Z2", "Z3", "Z4"]
  target_components: []

# ==== Section 5: Definition ====
definition:
  what: "A specific normalized event record generated when a file access operation occurs on an endpoint. The file access event contains structured fields including the accessed file path, requesting process identity and lineage, user and session context, access disposition (granted or denied), requested access mask, and precise timestamp. This event type maps to OCSF category 4001 (File System Activity) and represents the individual telemetry record produced by file access monitoring infrastructure."
  why: "Normalized file access events provide the atomic data units required for security analytics, correlation rules, and forensic investigation. Each event enables granular attribution of file access to specific processes and users, supporting detection of credential theft, sensitive document access, and data staging for exfiltration. The structured format enables efficient querying across large-scale telemetry stores."
  how: "File access events are generated by EDR mini-filter drivers, OS audit subsystems (Windows Event 4663, Linux inotify/fanotify), and file integrity monitoring agents. Events are normalized to a common schema including file path, process ID, process image path, user SID, access mask, and disposition. SIEM correlation rules trigger alerts on events matching sensitive file paths, unusual process-file combinations, or access patterns deviating from established baselines."
  core_concepts:
    - key: "Access Mask"
      value: "Bitmask value specifying the type of access requested (read data, write data, execute, delete, change permissions) in a file access event"
    - key: "Event Normalization"
      value: "The process of converting raw OS-specific file access records into a standardized schema for cross-platform analysis and correlation"
    - key: "Access Disposition"
      value: "The outcome of the access attempt indicating whether the operation was granted or denied by the security subsystem"

# ==== Section 6: Relations ====
relations:
  - type: instance_of
    target: "DETECT-ENDPOINT-FILEACCE-001"
    description: "A specific event instance of the general file access detection pattern"
  - type: part_of
    target: "DETECT-ENDPOINT-FILE-001"
    description: "File access events are a subset of the broader file event category"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1005"
    tactic:
      - "Collection"
  defense_context:
    effectiveness: "medium"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "OCSF Schema - File System Activity (4001)"
    - "Microsoft Documentation - Event 4663 Audit File System"
    - "Linux man pages - fanotify, inotify"
  search_keywords:
    - "file access event"
    - "file system activity"
    - "OCSF 4001"
    - "access mask"
    - "file read event"
    - "file audit event"
    - "access disposition"
    - "file telemetry"
  embedding_text: "File Access Event is a specific normalized telemetry record generated when a file access operation occurs on an endpoint. The event contains structured fields including file path, requesting process identity and lineage, user context, access disposition, access mask, and timestamp. Mapping to OCSF category 4001, these events are produced by EDR mini-filter drivers, Windows Event 4663, and Linux inotify/fanotify subsystems. Events are normalized to a common schema for cross-platform analysis. SIEM correlation rules use file access events to detect sensitive file access, unusual process-file combinations, credential theft, and data staging patterns deviating from established baselines."
