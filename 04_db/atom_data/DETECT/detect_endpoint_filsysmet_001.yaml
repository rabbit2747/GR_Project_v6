# GR Atom: File System Metadata
# Schema: atom_schema.yaml v5.1
# Status: enriched

identity:
  id: "DETECT-ENDPOINT-FILSYSMET-001"
  name: "File System Metadata"
  normalized_name: "file_system_metadata"
  aliases:
    - "File Metadata Telemetry"
    - "Filesystem Attribute Collection"
    - "File System Property Monitoring"

classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 2
  atom_tags:
    - EDR
    - MONITOR
    - LOG
    - FORENSICS
    - OS

scope:
  target_layers: ["L2", "L6"]
  target_zones: ["Z1", "Z2", "Z3"]
  target_components: []

definition:
  what: "File System Metadata is an endpoint detection pattern that captures and analyzes metadata attributes associated with files on a file system, including timestamps (creation, modification, access, MFT entry change), ownership, permissions, file size, alternate data streams, extended attributes, and inode or MFT record information. This telemetry is generated by operating system kernel hooks, file system filter drivers, or audit subsystems without reading the actual file content, providing a lightweight but highly informative view of file activity and state."
  why: "File system metadata is essential for security monitoring because adversaries frequently manipulate timestamps (timestomping), hide data in alternate data streams, modify file ownership to escalate privileges, or create files with anomalous attributes as part of their attack lifecycle. Monitoring metadata changes enables detection of anti-forensics techniques, unauthorized file modifications, and persistence mechanisms without the overhead of full content inspection."
  how: "Endpoint agents collect metadata through kernel-level file system minifilter drivers on Windows, fanotify or inotify on Linux, and Endpoint Security Framework on macOS. The collected attributes include MACB timestamps, NTFS $STANDARD_INFORMATION and $FILE_NAME attributes, POSIX ownership and permission bits, file size, and extended attributes. Detection logic compares observed metadata against baselines, flags timestamp inconsistencies such as creation time newer than modification time, identifies hidden alternate data streams, and correlates metadata changes with process activity to attribute modifications to specific actors."
  core_concepts:
    - key: "MACB Timestamps"
      value: "The four key file system timestamps: Modified, Accessed, Changed (MFT entry), and Born (created), used extensively in forensic timeline analysis"
    - key: "Timestomping Detection"
      value: "Identifying discrepancies between $STANDARD_INFORMATION and $FILE_NAME timestamps in NTFS that indicate deliberate timestamp manipulation by adversaries"
    - key: "Alternate Data Streams"
      value: "NTFS feature allowing additional data to be associated with a file beyond its primary content stream, commonly abused for hiding malicious payloads"

relations:
  - type: enables
    target: "DETECT-ENDPOINT-FILGETATT-001"
    description: "File system metadata collection provides the data foundation for file attribute retrieval detection"
  - type: effective_against
    target: "ATK-EVASION-TIMESTOMP-001"
    description: "Metadata analysis detects timestamp manipulation attempts by comparing multiple timestamp sources"
  - type: part_of
    target: "DETECT-ENDPOINT-FILE-001"
    description: "File system metadata is a core component of the broader file event detection category"

security_profile:
  mitre_mapping:
    technique_id: "T1070.006"
    tactic: ["Defense Evasion"]

metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "secondary"
  sources:
    - "MITRE ATT&CK T1070.006 - Timestomp"
    - "Microsoft - NTFS File System Reference - https://learn.microsoft.com/en-us/windows/win32/fileio/file-management"
    - "SANS DFIR - File System Forensics - https://www.sans.org/white-papers/"
  search_keywords:
    - "file system metadata"
    - "file timestamps"
    - "MACB timestamps"
    - "timestomping detection"
    - "alternate data streams"
    - "file attribute monitoring"
    - "NTFS metadata"
    - "file system forensics"
  embedding_text: "File System Metadata detection captures and analyzes file attributes including timestamps, ownership, permissions, size, and alternate data streams from endpoint file systems. Operating system kernel hooks and file system filter drivers collect MACB timestamps, NTFS attributes, and POSIX metadata without reading file content. This lightweight telemetry enables detection of anti-forensics techniques like timestomping by comparing $STANDARD_INFORMATION and $FILE_NAME timestamps, identification of hidden data in alternate data streams, and correlation of metadata changes with process activity for forensic attribution. It is fundamental to endpoint security monitoring and incident response."
