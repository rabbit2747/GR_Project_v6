# GR Atom: File Deletion Event
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "DETECT-ENDPOINT-FILEDELE-002"
  name: "File Deletion Event"
  normalized_name: "file_deletion_event"
  aliases:
    - "File Deletion Record"
    - "OCSF File Delete Event"
    - "File Removal Event"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 1
  atom_tags:
    - EDR
    - SIEM
    - LOG
    - FORENSICS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L5", "L6", "L7"]
  target_zones: ["Z1", "Z2", "Z3", "Z4"]
  target_components: []

# ==== Section 5: Definition ====
definition:
  what: "A specific normalized event record generated when a file deletion operation occurs on an endpoint. The file deletion event contains structured fields including the deleted file path, the file hash captured before deletion, the deleting process identity and lineage, user context, deletion method (standard delete, secure wipe, or overwrite), and timestamp. This event type supports forensic recovery workflows by preserving file metadata even after the physical file has been removed."
  why: "Individual file deletion event records provide the evidentiary basis for forensic analysis of anti-forensic activities. Each record preserves critical metadata about deleted files that would otherwise be lost, enabling investigators to reconstruct what files existed, who deleted them, and when. This supports detection of evidence tampering, tool cleanup, and data destruction during incident response."
  how: "Generated by Sysmon Event ID 23 (FileDelete) with optional file archiving via Event 26 (FileDeleteDetected), EDR kernel mini-filter callbacks on IRP_MJ_SET_INFORMATION with FileDispositionInformation, and Windows Security Event 4663 with delete access flags. Events are enriched with pre-deletion file hashes and metadata, then indexed for efficient forensic querying."
  core_concepts:
    - key: "Pre-Deletion Hash"
      value: "Cryptographic hash of file content captured before deletion, enabling identification of the deleted file through threat intelligence and reputation databases"
    - key: "Deletion Method Classification"
      value: "Categorization of how a file was deleted (standard removal, secure overwrite, or recycle bin) which indicates the intent behind the deletion"
    - key: "File Archive on Delete"
      value: "Sysmon capability to automatically archive deleted file content for later forensic analysis and recovery"

# ==== Section 6: Relations ====
relations:
  - type: instance_of
    target: "DETECT-ENDPOINT-FILEDELE-001"
    description: "Specific deletion event instance of the general file delete detection pattern"
  - type: part_of
    target: "DETECT-ENDPOINT-FILE-001"
    description: "File deletion events are part of the broader file event category"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1070.004"
    tactic:
      - "Defense Evasion"
    sub_techniques:
      - "T1070.004"
  defense_context:
    effectiveness: "high"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "Microsoft Sysinternals - Sysmon Event 23/26"
    - "OCSF File Activity Event Schema"
    - "MITRE ATT&CK T1070.004 - Indicator Removal: File Deletion"
  search_keywords:
    - "file deletion event"
    - "file delete record"
    - "pre-deletion hash"
    - "Sysmon event 23"
    - "file archive on delete"
    - "forensic file recovery"
    - "deletion method"
    - "file removal event"
  embedding_text: "File Deletion Event is a specific normalized telemetry record generated when a file deletion operation occurs on an endpoint. The event preserves deleted file path, pre-deletion content hash, deleting process identity and lineage, user context, deletion method, and timestamp. This supports forensic recovery by preserving file metadata after physical removal. Events are generated by Sysmon Event IDs 23 and 26 with optional file archiving, EDR kernel mini-filter callbacks, and Windows Security Event 4663. Pre-deletion hashes enable identification through threat intelligence databases, and deletion method classification indicates attacker intent behind the file removal."
