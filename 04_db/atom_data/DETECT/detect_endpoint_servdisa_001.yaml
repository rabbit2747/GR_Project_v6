# GR Atom: Service Disable Event
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "DETECT-ENDPOINT-SERVDISA-001"
  name: "Service Disable Event"
  normalized_name: "service_disable_event"
  aliases:
    - "Service Disabled Detection"
    - "Service Startup Type Disabled"
    - "Service Deactivation Event"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 1
  atom_tags:
    - EDR
    - SIEM
    - AUDIT
    - LOG
    - MONITOR
    - EVADE
    - WINDOWS
    - LINUX

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z1", "Z2", "Z3"]
  target_components: []

# ==== Section 5: Definition ====
definition:
  what: "A detection pattern that identifies when a system service is disabled on an endpoint, meaning its startup type is changed to prevent automatic or manual execution. On Windows, this is detected when the Start registry value under HKLM\\SYSTEM\\CurrentControlSet\\Services\\<ServiceName> is set to 4 (Disabled), or when sc.exe config commands set the start type to disabled. On Linux, this corresponds to systemctl disable commands that remove symlinks from systemd target directories, or update-rc.d remove operations for SysV init services."
  why: "Disabling services is a primary defense evasion technique used by adversaries to neutralize security controls without triggering deletion alerts. Attackers commonly disable EDR agents, Windows Defender, firewall services, event logging, and backup services before executing their primary attack objectives. Monitoring service disable events is essential for detecting impaired defenses and ensuring security tool integrity across the environment."
  how: "Detection monitors Windows registry changes to service Start values via Sysmon Event ID 13 (Registry Value Set), Windows Security Event ID 4657 for registry auditing, and command-line auditing for sc.exe config and Set-Service PowerShell commands. On Linux, auditd rules capture systemctl disable operations and file system changes in systemd target directories. EDR agents provide real-time alerts when monitored services transition to disabled state. SIEM correlation rules compare disabled services against a whitelist of approved changes."
  core_concepts:
    - key: "startup_type_modification"
      value: "Changing a service startup configuration from automatic or manual to disabled, preventing the service from starting"
    - key: "defense_impairment"
      value: "Adversaries disable security services to remove protective controls before executing malicious activities"
    - key: "service_baseline"
      value: "Maintaining a baseline of expected service states to detect unauthorized disabling of critical services"
    - key: "cascading_impact"
      value: "Disabling a service can affect dependent services and compromise the overall security posture of the endpoint"

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "DETECT-ENDPOINT-SERVICE-001"
    description: "A service disable event is a specific type of service lifecycle event"
  - type: "enables"
    target: "DETECT-ENDPOINT-SERVSTOP-001"
    description: "Disabling a service often precedes or accompanies service stop events"
  - type: "alternative_to"
    target: "DETECT-ENDPOINT-SERVDELE-001"
    description: "Disabling is an alternative to deletion for neutralizing services without removing evidence"

# ==== Section 7: Security Profile (optional) ====
security_profile:
  mitre_mapping:
    technique_id: "T1562.001"
    tactic:
      - "defense-evasion"
    sub_techniques: []
  defense_context:
    effectiveness: "high"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "Microsoft Documentation - Service Control Manager"
    - "MITRE ATT&CK T1562.001 - Impair Defenses: Disable or Modify Tools"
    - "Windows Registry Reference - Service Start Types"
    - "Systemd Documentation - Unit Management"
  search_keywords:
    - "service disable"
    - "service disabled event"
    - "startup type disabled"
    - "impair defenses"
    - "disable security service"
    - "sc config disabled"
    - "systemctl disable"
    - "service deactivation"
    - "defense evasion"
    - "security tool disable"
  embedding_text: "Service disable event detection pattern identifies when system services are disabled on endpoints by changing their startup type to prevent execution. On Windows this monitors registry changes to service Start values and command-line operations using sc.exe or PowerShell. On Linux it tracks systemctl disable operations. This is a critical defense evasion indicator as adversaries commonly disable EDR agents, antivirus, firewalls, and logging services before executing attacks. Maps to MITRE ATT&CK T1562.001 Impair Defenses. Detection uses Sysmon registry monitoring, security event log auditing, and EDR telemetry to identify unauthorized service disabling with comparison against approved service baselines."
