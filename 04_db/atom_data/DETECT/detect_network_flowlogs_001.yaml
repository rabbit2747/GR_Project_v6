# GR Atom: Flow Logs
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "DETECT-NETWORK-FLOWLOGS-001"
  name: "Flow Logs"
  normalized_name: "flow_logs"
  aliases:
    - "NetFlow Logs"
    - "Network Flow Records"
    - "IPFIX Records"
    - "sFlow Data"
    - "VPC Flow Logs"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "concept"
  abstraction_level: 2
  atom_tags:
    - NETWORK
    - LOG
    - MONITOR
    - SIEM
    - CLOUD

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L2", "L3", "L4"]
  target_zones: ["Z0A", "Z0B", "Z1", "Z2", "Z3", "Z4", "Z5"]
  target_components: []

# ==== Section 5: Definition ====
definition:
  what: "Flow logs are structured records of network communication sessions capturing metadata about connections without storing full packet payloads. Each flow record typically contains source and destination IP addresses, ports, protocol, byte and packet counts, timestamps, duration, TCP flags, and direction. Standards include NetFlow (v5/v9), IPFIX, sFlow, and cloud-native variants such as AWS VPC Flow Logs, Azure NSG Flow Logs, and GCP VPC Flow Logs. Flow data provides scalable network visibility at a fraction of the storage cost of full packet capture."
  why: "Flow logs are the foundational data source for network security monitoring, providing comprehensive visibility into all network communications. They enable detection of anomalous traffic patterns, unauthorized connections, data exfiltration, lateral movement, and reconnaissance activity without the storage overhead and privacy concerns of full packet capture. Flow data is essential for baseline establishment, threat hunting, incident investigation, compliance reporting, and capacity planning."
  how: "Flow logs are generated by network infrastructure (routers, switches, firewalls) or through software agents and cloud service APIs. Collection is centralized through flow collectors or SIEM platforms. Analysis involves establishing traffic baselines per host and subnet, detecting anomalous patterns through statistical methods, enriching flows with threat intelligence and asset context, correlating flows across time windows for multi-stage attack detection, and applying machine learning models for behavioral classification. Retention periods and sampling rates are configured to balance visibility, performance, and storage requirements."
  core_concepts:
    - key: "Flow Record Structure"
      value: "The standard tuple of source IP, destination IP, source port, destination port, protocol, byte count, packet count, and timestamps that defines a network flow."
    - key: "Sampling vs Full Capture"
      value: "Trade-off between capturing every flow for complete visibility versus sampling for performance on high-bandwidth networks."
    - key: "Flow Enrichment"
      value: "Adding context to raw flow records including asset ownership, threat intelligence, geolocation, and application classification."
    - key: "Baseline Establishment"
      value: "Building statistical models of normal network behavior from historical flow data to enable anomaly detection."

# ==== Section 6: Relations ====
relations:
  - type: enables
    target: "DETECT-NETWORK-BEACONING-001"
    description: "Flow logs provide the data foundation for beaconing detection"
  - type: enables
    target: "DETECT-NETWORK-DATAEXFI-001"
    description: "Flow logs enable volumetric analysis for data exfiltration detection"
  - type: enables
    target: "DETECT-NETWORK-NETPORANO-001"
    description: "Flow logs provide port usage data for port anomaly detection"

# ==== Section 7: Security Profile ====
security_profile:
  defense_context:
    effectiveness: "high"
    d3fend_mapping: "D3-NTA"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "Cisco - NetFlow v9 and IPFIX Standards"
    - "NIST SP 800-86 Guide to Integrating Forensic Techniques"
    - "AWS Documentation - VPC Flow Logs"
    - "SANS Institute - Network Flow Analysis for Security Monitoring"
  search_keywords:
    - "flow logs"
    - "NetFlow"
    - "IPFIX"
    - "sFlow"
    - "network flow"
    - "VPC flow logs"
    - "traffic metadata"
    - "flow records"
    - "network visibility"
    - "flow analysis"
  embedding_text: "Flow logs are structured records of network communication sessions capturing connection metadata including source and destination addresses, ports, protocols, byte counts, timestamps, and TCP flags without storing full payloads. Standards include NetFlow, IPFIX, sFlow, and cloud-native variants like AWS VPC Flow Logs. They provide the foundational data source for network security monitoring, enabling baseline establishment, anomaly detection, threat hunting, and incident investigation at a fraction of the storage cost of full packet capture. Flow data is essential for detecting beaconing, data exfiltration, lateral movement, and reconnaissance across all network zones."
