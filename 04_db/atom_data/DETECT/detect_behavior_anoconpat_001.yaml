# GR Atom: Anomalous Consent Patterns
# Schema: atom_schema.yaml v5.1
# Status: enriched

identity:
  id: "DETECT-BEHAVIOR-ANOCONPAT-001"
  name: "Anomalous Consent Patterns"
  normalized_name: "anomalous_consent_patterns"
  aliases:
    - "OAuth Consent Anomaly Detection"
    - "Suspicious Permission Grant Patterns"
    - "Abnormal Application Consent"
    - "Consent Phishing Detection"

classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 2
  atom_tags:
    - AUTHN
    - AUTHZ
    - MONITOR
    - CLOUD
    - EVADE

scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z2", "Z3", "Z4"]
  target_components: []

definition:
  what: "Anomalous Consent Patterns is a behavioral detection technique that identifies unusual or suspicious OAuth/application consent grant activity within identity platforms such as Azure AD, Google Workspace, or other OAuth 2.0 providers. It monitors for deviations from normal consent behavior including bulk consent grants, consent to high-privilege scopes by non-admin users, consent to previously unseen applications, consent grants outside business hours, and consent to applications with suspicious metadata such as recently registered publisher domains or misleading application names."
  why: "Consent phishing and illicit consent grant attacks are increasingly used by threat actors to gain persistent access to cloud environments without requiring credentials. By tricking users into granting OAuth permissions to attacker-controlled applications, adversaries can read emails, access files, and exfiltrate data while bypassing traditional authentication controls including MFA. Detecting anomalous consent patterns is critical because these attacks leave minimal traditional indicators of compromise and can provide long-term persistent access."
  how: "Detection systems baseline normal consent behavior per user, department, and organization to establish patterns including typical applications consented to, scope levels granted, timing of consent events, and frequency. Anomaly detection algorithms then flag deviations such as first-time consent to unknown applications, grants of sensitive scopes like Mail.Read or Files.ReadWrite.All, consent events from unusual locations or devices, rapid successive consent grants suggesting automated attacks, and consent to applications with publisher domains registered within the past 30 days. Alerts are correlated with other signals like phishing email delivery and suspicious sign-in activity."
  core_concepts:
    - key: "OAuth Consent Grant"
      value: "The process by which a user authorizes a third-party application to access specific resources on their behalf via delegated permissions"
    - key: "Illicit Consent Grant"
      value: "An attack where adversaries trick users into granting OAuth permissions to malicious applications, enabling persistent data access"
    - key: "Scope Sensitivity"
      value: "Classification of OAuth permission scopes by risk level, with high-sensitivity scopes like mail and file access requiring elevated scrutiny"

relations:
  - type: enables
    target: "DETECT-BEHAVIOR-PRIACCPAT-001"
    description: "Anomalous consent patterns can indicate privileged account compromise requiring privileged account pattern analysis"
  - type: effective_against
    target: "ATK-CRED-MFABYPA-001"
    description: "Detects OAuth-based attacks that bypass MFA through consent phishing"

security_profile:
  mitre_mapping:
    technique_id: "T1550.001"
    tactic: ["Defense Evasion", "Lateral Movement"]

metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "secondary"
  sources:
    - "Microsoft - Detect and Remediate Illicit Consent Grants - https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-illicit-consent-grants"
    - "MITRE ATT&CK T1550.001 - Application Access Token"
    - "CISA - Detecting OAuth Consent Phishing - https://www.cisa.gov/news-events/cybersecurity-advisories"
  search_keywords:
    - "OAuth consent anomaly"
    - "consent phishing detection"
    - "illicit consent grant"
    - "application consent monitoring"
    - "Azure AD consent patterns"
    - "OAuth scope analysis"
    - "suspicious application permissions"
    - "consent grant baseline"
  embedding_text: "Anomalous Consent Patterns detection identifies unusual OAuth and application consent grant activity in identity platforms like Azure AD and Google Workspace. It baselines normal consent behavior per user and organization, then flags deviations including bulk consent grants, high-privilege scope approvals by non-admin users, consent to unknown applications, and grants outside business hours. This technique is critical for detecting consent phishing attacks where adversaries trick users into authorizing malicious applications, gaining persistent access to email, files, and other resources while bypassing MFA. Detection correlates consent events with phishing indicators and sign-in anomalies."
