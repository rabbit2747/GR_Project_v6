# GR Atom: WinEvent
# Schema: atom_schema.yaml v5.1
# Status: enriched

identity:
  id: "DETECT-LOG-WINEVENT-001"
  name: "WinEvent"
  normalized_name: "winevent"
  aliases:
    - "Windows Event"
    - "Win32 Event"
    - "Windows Event Object"
    - "Get-WinEvent"

classification:
  is_infrastructure: false
  type: "pattern"
  abstraction_level: 2
  atom_tags:
    - LOG
    - MONITOR
    - WINDOWS
    - AUDIT

scope:
  target_layers: ["L5", "L6"]
  target_zones: ["Z0A", "Z0B", "Z1", "Z2", "Z3"]
  target_components: []

definition:
  what: >-
    WinEvent refers to the individual event records generated by the Windows operating system
    and its components, as well as the PowerShell cmdlet (Get-WinEvent) and programmatic
    interfaces used to query and interact with these events. Each WinEvent is a structured
    data record containing an Event ID (numeric identifier for the event type), a Provider Name
    (the source component), a Level (Critical, Error, Warning, Information, Verbose), a Channel
    (the log to which the event is written, such as Security, System, Application, or custom
    channels), a TimeCreated timestamp, and an XML-structured EventData payload containing
    event-specific fields. WinEvents are the fundamental unit of Windows telemetry used across
    security monitoring, system administration, application troubleshooting, and compliance
    auditing. The Get-WinEvent PowerShell cmdlet provides the modern interface for querying
    events using FilterXPath, FilterHashtable, and FilterXML parameters.
  why: >-
    WinEvents are the primary source of security telemetry on Windows systems, which dominate
    enterprise environments. Understanding WinEvent structure and querying capabilities is
    essential for security operations, detection engineering, incident response, and forensic
    analysis. Key security-relevant Event IDs include 4624/4625 (logon success/failure),
    4688 (process creation), 4720-4738 (account management), 4719 (audit policy change),
    1102 (Security log cleared), and thousands more. Detection rules, SIEM correlation logic,
    and forensic tools all operate on WinEvent data. Sigma rules primarily target WinEvent
    log sources. The structured XML format enables precise field-level filtering critical for
    reducing false positives in detection rules.
  how: >-
    WinEvent processing operates through: (1) Event generation by Windows components based on
    configured audit policies (Advanced Audit Policy Configuration) and application-specific
    logging; (2) Event storage in .evtx files organized by channel in
    C:\Windows\System32\winevt\Logs\; (3) Event querying via Get-WinEvent with FilterHashtable
    for structured queries (e.g., @{LogName='Security'; ID=4625}), FilterXPath for XML path
    queries, or FilterXML for complex XML filter expressions; (4) Event forwarding via Windows
    Event Forwarding (WEF) subscriptions for centralized collection; (5) Event collection by
    SIEM agents (NXLog, Winlogbeat, Elastic Agent) that parse .evtx format and forward events;
    (6) Event enrichment in SIEM platforms with asset context, user context, and threat
    intelligence; (7) Event analysis through detection rules, correlation logic, and forensic
    timeline reconstruction.
  core_concepts:
    - key: "Event ID"
      value: "Numeric identifier for each event type that enables precise filtering and detection rule targeting, with different ID ranges assigned to different Windows components and audit categories."
    - key: "Event Channel"
      value: "The log destination for events (Security, System, Application, or custom channels like Microsoft-Windows-Sysmon/Operational), each capturing specific categories of telemetry."
    - key: "EventData XML"
      value: "The structured XML payload within each event that contains event-specific fields, enabling precise field-level querying and detection rule conditions."
    - key: "Get-WinEvent"
      value: "The modern PowerShell cmdlet for querying Windows events, replacing the deprecated Get-EventLog, supporting FilterHashtable, FilterXPath, and FilterXML parameters."

relations:
  - type: "is_a"
    target: "DETECT-LOG-SECURITY-001"
    description: "Windows events are a primary source of security event data"
  - type: "part_of"
    target: "DETECT-LOG-WINEVENTLO-001"
    description: "Individual WinEvents are stored within the Windows Event Log system"
  - type: "enables"
    target: "DETECT-LOG-SIGCORRUL-001"
    description: "WinEvents are the primary log source targeted by Sigma detection rules"

metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "Microsoft — Windows Event Log Reference"
    - "Microsoft — Get-WinEvent PowerShell Documentation"
    - "SANS — Windows Event Log Reference"
    - "MITRE ATT&CK — Data Source: Windows Event Logs"
  search_keywords:
    - "WinEvent"
    - "Windows event"
    - "Get-WinEvent"
    - "Event ID"
    - "Windows event log"
    - "evtx"
    - "Windows telemetry"
    - "FilterHashtable"
    - "FilterXPath"
    - "Windows audit"
    - "security event ID"
  embedding_text: >-
    WinEvent refers to individual event records generated by the Windows operating system,
    structured as Event ID, Provider Name, Level, Channel, TimeCreated, and XML EventData
    payload. WinEvents are the fundamental unit of Windows security telemetry, queried via
    Get-WinEvent PowerShell cmdlet with FilterHashtable, FilterXPath, and FilterXML parameters.
    Key security Event IDs include 4624/4625 (logon), 4688 (process creation), 4720-4738
    (account management), and 1102 (log cleared). WinEvents feed SIEM correlation rules, Sigma
    detection rules, and forensic analysis tools. Collection uses Windows Event Forwarding, SIEM
    agents, and .evtx file parsing. The structured XML format enables precise field-level
    detection filtering.
