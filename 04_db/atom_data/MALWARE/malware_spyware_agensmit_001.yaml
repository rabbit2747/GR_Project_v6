# GR Atom: Agent Smith
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-SPYWARE-AGENSMIT-001"
  name: "Agent Smith"
  normalized_name: "agent_smith"
  aliases: ["AgentSmith", "Agent Smith Malware"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["PERSIST", "COLLECT", "MOBILE", "ANDROID", "INJ"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L7", "L6"]
  target_zones: ["Z2", "Z3"]
  target_components: ["Mobile Applications", "Android OS", "APK Files", "Advertising Frameworks"]

# ==== Section 5: Definition ====
definition:
  what: "Agent Smith is an Android malware that infects legitimate applications by replacing their core components with malicious versions, automatically propagating across installed apps to inject advertising fraud code while maintaining the original app functionality to avoid detection."
  why: "Cybercriminals developed Agent Smith primarily for large-scale advertising fraud operations, generating revenue through hidden ad impressions and clicks while simultaneously establishing surveillance capabilities on millions of compromised devices across multiple countries, particularly targeting users in Asia."
  how: "The malware exploits Android vulnerabilities and framework weaknesses to silently replace installed application APKs with infected versions containing malicious advertising and data collection modules. It spreads through third-party app stores and malicious utility apps, then automatically infects other applications on the device without user interaction."
  core_concepts: ["APK Replacement", "App Infection", "Advertising Fraud", "Auto-Propagation", "Framework Exploitation"]

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "MALWARE-CATEGORY-SPYWARE-001"
    context: "Self-propagating mobile malware"
  - type: "enables"
    target: "ATTACK-PERSIST-T1398"
    context: "Enables persistent infection through app replacement"
  - type: "implements"
    target: "ATTACK-EXECUTION-T1575"
    context: "Implements native code execution for app infection"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1398"
    tactic: ["Persistence", "Defense Evasion", "Collection", "Impact"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "https://www.check.com/blog/agent-smith/"
    - "https://www.checkpoint.com/press/2019/agent-smith-a-new-android-malware-that-hides-inside-a-file-manager-app-and-automatically-replaces-installed-apps-with-malicious-versions-without-users-knowledge/"
    - "https://attack.mitre.org/software/S0422/"
  search_keywords: ["agent smith", "android malware", "apk replacement", "app infection", "advertising fraud malware", "self-propagating android malware", "framework exploitation", "third party app store malware"]
  embedding_text: "Agent Smith represents a highly sophisticated Android malware campaign that infected over 25 million devices worldwide, primarily through third-party app stores popular in Asia. The malware demonstrates advanced capabilities in automatically replacing legitimate application APKs with infected versions that maintain original functionality while injecting malicious advertising and surveillance code. Agent Smith exploits Android framework vulnerabilities and weaknesses in app installation mechanisms to silently propagate across installed applications without requiring user interaction. The malware focuses primarily on advertising fraud through hidden ad impressions and click injection, while simultaneously establishing data collection infrastructure. Its self-propagating nature and ability to maintain app functionality while injecting malicious code make it particularly dangerous and difficult to detect through traditional security measures."
