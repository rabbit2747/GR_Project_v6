# GR Atom: PSH Surrogate
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-BACKDOOR-PSHSURR-001"
  name: "PSH Surrogate"
  normalized_name: "psh_surrogate"
  aliases: ["PowerShell Surrogate", "PSH-Surr"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["C2", "WINDOWS", "EVADE", "EXEC", "PERSIST"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z2", "Z3"]
  target_components: ["PowerShell", "WMI", "Windows Services", "Registry"]

# ==== Section 5: Definition ====
definition:
  what: "PSH Surrogate is a sophisticated PowerShell-based backdoor that uses process hollowing and surrogate parent process techniques to execute malicious code while masquerading as legitimate Windows processes. The malware leverages PowerShell's reflection capabilities to inject and execute payloads in trusted system processes, evading behavioral detection."
  why: "Attackers use PSH Surrogate to bypass process-based security controls and establish persistent access that appears as normal system activity. By executing within legitimate processes and using surrogate parent techniques, the malware evades EDR solutions and heuristic analysis that rely on process tree analysis."
  how: "The backdoor operates by creating legitimate Windows processes in a suspended state, hollowing out their memory space, injecting malicious PowerShell code, and resuming execution with spoofed parent process IDs. It establishes C2 communication through these surrogate processes, executes commands with inherited system privileges, and maintains persistence through WMI event subscriptions or service modifications."
  core_concepts: ["Process Hollowing", "Parent PID Spoofing", "PowerShell Reflection", "Living-off-the-Land Binary", "Defense Evasion"]

# ==== Section 6: Relations ====
relations:
  - type: "implements"
    target: "ATT&CK-T1055.012"
    context: "Process hollowing technique"
  - type: "implements"
    target: "ATT&CK-T1134.004"
    context: "Parent PID spoofing"
  - type: "enables"
    target: "ATT&CK-T1059.001"
    context: "PowerShell execution in surrogate process"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: ["T1055.012", "T1134.004", "T1059.001", "T1547.001"]
    tactic: ["defense-evasion", "privilege-escalation", "execution", "persistence"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "Process Hollowing Technique Analysis"
    - "PowerShell Evasion Research"
    - "EDR Bypass Documentation"
  search_keywords: ["psh surrogate", "process hollowing", "parent pid spoofing", "powershell injection", "surrogate process", "powershell evasion"]
  embedding_text: "PSH Surrogate is an advanced PowerShell backdoor employing process hollowing and parent PID spoofing to evade security controls. It creates legitimate Windows processes, hollows their memory, injects malicious PowerShell code, and executes with spoofed parent process relationships. This technique bypasses EDR solutions relying on process tree analysis and behavioral heuristics. The malware establishes C2 through surrogate processes, inherits system privileges, and maintains persistence via WMI or services. Detection requires memory analysis, behavioral anomaly detection, and monitoring for process creation with unusual parent-child relationships. PSH Surrogate represents sophisticated defense evasion techniques that challenge traditional security monitoring approaches."
