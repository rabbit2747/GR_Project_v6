# GR Atom: Agent Flayer
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-SPYWARE-AGENFLAY-001"
  name: "Agent Flayer"
  normalized_name: "agent_flayer"
  aliases: ["AgentFlayer"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["COLLECT", "C2", "MOBILE", "ANDROID", "PERSIST"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L7"]
  target_zones: ["Z2", "Z3"]
  target_components: ["Mobile Applications", "Android OS", "SMS", "Contacts"]

# ==== Section 5: Definition ====
definition:
  what: "Agent Flayer is an Android spyware variant that monitors and exfiltrates user communications including SMS messages, call logs, contacts, and location data while maintaining covert persistence on infected devices through system-level permissions."
  why: "Attackers employ Agent Flayer for targeted surveillance campaigns to gather intelligence on specific individuals or groups, typically for espionage, stalking, or corporate intelligence gathering by monitoring all communication channels and device activities."
  how: "The malware establishes persistence through Android system services, requests administrative privileges, monitors communication channels in real-time, and establishes encrypted C2 connections to exfiltrate collected data. It disguises itself as legitimate system applications to avoid user detection."
  core_concepts: ["Android Spyware", "Communication Monitoring", "Persistent Surveillance", "SMS Interception", "Location Tracking"]

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "MALWARE-CATEGORY-SPYWARE-001"
    context: "Mobile spyware category"
  - type: "enables"
    target: "ATTACK-COLLECTION-T1430"
    context: "Enables location tracking and communication monitoring"
  - type: "implements"
    target: "ATTACK-PERSIST-T1398"
    context: "Implements Android persistence mechanisms"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1430"
    tactic: ["Collection", "Persistence", "Command and Control"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/agent_flayer"
    - "https://securelist.com/mobile-malware-evolution-2020/101029/"
  search_keywords: ["agent flayer", "android spyware", "communication monitoring", "sms interception", "mobile surveillance malware", "android stalkerware", "persistent mobile spyware"]
  embedding_text: "Agent Flayer is a sophisticated Android surveillance tool designed for covert monitoring of mobile device communications and user activities. The spyware focuses on comprehensive data collection including SMS messages, phone call metadata, contact lists, GPS location coordinates, and application usage patterns. It maintains persistent access through system-level service installation and administrative privilege escalation. Agent Flayer employs stealth techniques including process name obfuscation, legitimate app mimicry, and encrypted data transmission to evade detection by mobile security solutions. The malware represents targeted surveillance operations often associated with intimate partner surveillance, corporate espionage, or nation-state intelligence gathering against specific high-value targets on Android mobile platforms."
