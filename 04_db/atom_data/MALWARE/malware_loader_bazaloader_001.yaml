# GR Atom: BazaLoader
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-LOADER-BAZALOADER-001"
  name: "BazaLoader"
  normalized_name: "bazaloader"
  aliases: ["BazarLoader", "BazaBackdoor", "KEGTAP", "Team9Loader"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["INITIAL", "EXEC", "C2", "WINDOWS", "PERSIST", "EVADE"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L5", "L6", "L7"]
  target_zones: ["Z2", "Z3"]
  target_components: ["Windows Services", "System Memory", "Network Communications", "Office Applications"]

# ==== Section 5: Definition ====
definition:
  what: "BazaLoader is a sophisticated downloader malware developed by the TrickBot group (ITG23) first observed in April 2020, designed to establish backdoor access and deploy secondary payloads including ransomware (particularly Conti and Ryuk), Cobalt Strike beacons, and banking trojans. It features advanced evasion techniques, modular architecture, and multiple communication protocols to maintain persistent access to compromised networks."
  why: "BazaLoader serves as a critical initial access tool for ransomware operations and advanced persistent threat campaigns. The malware enables threat actors to conduct reconnaissance, establish command-and-control infrastructure, and deploy devastating payloads while evading detection through sophisticated anti-analysis mechanisms. Its development by the TrickBot group reflects a strategic shift toward targeted intrusions and ransomware deployment rather than mass credential theft."
  how: "BazaLoader typically arrives through highly targeted spear-phishing campaigns using call center themes, fake subscription notices, or malicious documents embedded in emails. Upon execution, it employs multiple evasion techniques including API hashing, string encryption, and domain generation algorithms (DGA) for C2 communication. The malware loads via DLL sideloading or exploits signed binaries, establishes persistence through Windows services or scheduled tasks, and communicates using HTTPS or custom protocols to receive commands and download additional modules or payloads."
  core_concepts: ["Backdoor Malware", "Targeted Intrusion", "Ransomware Delivery", "TrickBot Group", "DGA Communication", "Multi-Stage Infection"]

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "MALWARE-CATEGORY-LOADER-001"
    label: "malware loader category"
  - type: "enables"
    target: "MALWARE-RANSOMWARE-CONTI-001"
    label: "deploys Conti ransomware"
  - type: "implements"
    target: "TECHNIQUE-DGA-001"
    label: "uses domain generation algorithm"
  - type: "precedes"
    target: "MALWARE-COBALTSTRIKE-001"
    label: "often delivers Cobalt Strike"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1204.002"
    tactic: ["execution"]
    subtechniques: ["T1204.002"]
  additional_mappings:
    - technique_id: "T1574.002"
      tactic: ["persistence", "defense-evasion", "privilege-escalation"]
      description: "Hijack Execution Flow: DLL Side-Loading"
    - technique_id: "T1055"
      tactic: ["defense-evasion", "privilege-escalation"]
      description: "Process Injection"
    - technique_id: "T1568.002"
      tactic: ["command-and-control"]
      description: "Dynamic Resolution: Domain Generation Algorithms"
    - technique_id: "T1027"
      tactic: ["defense-evasion"]
      description: "Obfuscated Files or Information"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "MITRE ATT&CK Framework"
    - "IBM X-Force: BazaLoader Analysis (ITG23)"
    - "CISA Alert AA21-265A: Conti Ransomware"
    - "Mandiant Threat Intelligence: TrickBot Evolution"
    - "SANS Internet Storm Center Reports"
  search_keywords: ["bazaloader", "bazarloader malware", "trickbot loader", "team9 loader", "conti ransomware loader", "kegtap", "dga malware", "ransomware downloader"]
  embedding_text: "BazaLoader is an advanced backdoor and loader malware developed by the TrickBot cybercrime group, first appearing in 2020. It serves as a critical tool for ransomware operations, particularly deploying Conti and Ryuk ransomware families alongside Cobalt Strike beacons. The malware arrives through sophisticated spear-phishing campaigns using social engineering tactics like fake customer service calls and subscription cancellation themes. BazaLoader employs multiple evasion techniques including domain generation algorithms for C2 communication, DLL side-loading, API hashing, and string encryption. It establishes persistence through Windows services and scheduled tasks, enabling threat actors to conduct network reconnaissance and lateral movement before deploying final payloads. The malware represents a significant evolution in targeted intrusion capabilities for financially motivated cybercrime groups."
