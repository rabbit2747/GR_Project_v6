# GR Atom: MegaCortex
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-RANSOM-MEGACORTEX-001"
  name: "MegaCortex"
  normalized_name: "megacortex"
  aliases: ["MegaCortex v2", "MegaCortex v3"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["IMPACT", "LATERAL", "PERSIST", "EVADE", "WINDOWS", "NETWORK"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L5", "L6", "L7"]
  target_zones: ["Z1", "Z2", "Z3", "Z4"]
  target_components: ["Windows Systems", "Active Directory", "Domain Controllers", "File Servers", "Backup Systems"]

# ==== Section 5: Definition ====
definition:
  what: "MegaCortex is a sophisticated, manually deployed ransomware family that emerged in May 2019, targeting enterprise networks with multi-stage attacks requiring extensive reconnaissance and privilege escalation. It features advanced techniques including signed malicious drivers for anti-virus termination, Active Directory Group Policy deployment, scheduled task creation, and process injection. MegaCortex uses AES-256 and RSA-2048 encryption and demands large ransoms from enterprises and government organizations."
  why: "MegaCortex operates as a targeted ransomware campaign focusing on large enterprises and government entities for maximum ransom potential. The sophisticated deployment methods and anti-detection techniques suggest financially motivated threat actors with significant technical capabilities, possibly operating as a private ransomware service for select affiliates or as a dedicated threat group targeting high-value organizations."
  how: "MegaCortex attacks typically begin with initial access through Emotet or Qbot trojan infections, followed by extensive network reconnaissance, credential harvesting, lateral movement, and privilege escalation to Domain Admin level. Attackers deploy ransomware using Active Directory Group Policy Objects, scheduled tasks, or PsExec across the network. MegaCortex drops and loads signed (though revoked) drivers to terminate security processes, uses rundll32.exe for execution, encrypts files with AES-256 and RSA-2048, and leaves ransom notes with unique victim IDs."
  core_concepts: ["Targeted Ransomware", "Signed Malicious Driver", "GPO Deployment", "Anti-AV Techniques", "Manual Deployment", "Multi-Stage Attack", "Enterprise Targeting"]

# ==== Section 6: Relations ====
relations:
  - type: "part_of"
    target: "MALWARE-CATEGORY-RANSOMWARE-001"
    context: "MegaCortex is a targeted ransomware family"
  - type: "requires"
    target: "MALWARE-EMOTET-001"
    context: "Often delivered via Emotet trojan"
  - type: "requires"
    target: "MALWARE-QBOT-001"
    context: "Sometimes delivered via Qbot trojan"
  - type: "enables"
    target: "ATTACK-GPO-ABUSE-001"
    context: "Uses Group Policy for network-wide deployment"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1486"
    tactic: ["Impact", "Lateral Movement", "Persistence", "Defense Evasion", "Privilege Escalation"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "https://attack.mitre.org/software/S0576/"
    - "https://www.sophos.com/en-us/medialibrary/PDFs/technical-papers/MegaCortex-ransomware.pdf"
    - "https://www.fireeye.com/blog/threat-research/2019/11/megacortex-revisited.html"
  search_keywords: ["megacortex", "megacortex ransomware", "signed driver malware", "gpo ransomware", "targeted ransomware", "emotet megacortex", "qbot megacortex", "anti-av driver", "megacortex v2", "enterprise ransomware"]
  embedding_text: "MegaCortex is a sophisticated, manually deployed ransomware family that emerged in May 2019, specifically targeting enterprise networks and government organizations for large ransom demands. The malware features advanced techniques including the use of signed (though later revoked) malicious drivers to terminate anti-virus processes, Active Directory Group Policy deployment for network-wide execution, and multi-stage attack chains. MegaCortex attacks typically begin with Emotet or Qbot trojan infections providing initial access, followed by extensive network reconnaissance, credential harvesting, lateral movement, and privilege escalation to Domain Admin level. Attackers use sophisticated deployment methods including GPO abuse, scheduled tasks, and PsExec to distribute the ransomware payload across enterprise networks. MegaCortex uses rundll32.exe for execution, terminates security processes via signed drivers, encrypts files with AES-256 and RSA-2048 encryption algorithms, and deploys ransom notes with unique victim identifiers. The manual nature of the attacks and sophisticated evasion techniques indicate well-resourced threat actors targeting high-value organizations for maximum financial gain."
