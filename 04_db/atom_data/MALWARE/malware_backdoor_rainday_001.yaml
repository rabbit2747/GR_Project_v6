# GR Atom: Rainy Day
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-BACKDOOR-RAINDAY-001"
  name: "Rainy Day"
  normalized_name: "rainy_day"
  aliases: ["RainyDay"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["C2", "WINDOWS", "LINUX", "EXFIL", "COLLECT"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z2", "Z3"]
  target_components: ["DNS Services", "Network Stack", "Operating System Services"]

# ==== Section 5: Definition ====
definition:
  what: "Rainy Day is a cross-platform backdoor that uses DNS tunneling for command-and-control communication and data exfiltration. The malware encodes commands and stolen data within DNS queries and responses, allowing it to operate through restrictive network environments that permit only DNS traffic while evading traditional security controls."
  why: "Attackers deploy Rainy Day to maintain covert communication channels in highly restricted network environments where direct internet access is blocked but DNS resolution is permitted. DNS tunneling bypasses firewall rules, web proxies, and DLP solutions that focus on HTTP/HTTPS traffic while appearing as legitimate name resolution activity."
  how: "The backdoor operates by encoding commands within DNS query subdomains sent to attacker-controlled authoritative name servers, receiving responses through DNS TXT or CNAME records, executing commands on the compromised system, and exfiltrating data through sequences of DNS queries. It supports multiple DNS record types for data transfer, implements error correction for reliable communication, and can adapt query patterns to evade DNS traffic analysis."
  core_concepts: ["DNS Tunneling", "Covert Channel", "Protocol Abuse", "Data Encoding", "Network Evasion"]

# ==== Section 6: Relations ====
relations:
  - type: "implements"
    target: "ATT&CK-T1071.004"
    context: "Application Layer Protocol: DNS"
  - type: "enables"
    target: "ATT&CK-T1041"
    context: "Exfiltration over C2 channel"
  - type: "implements"
    target: "ATT&CK-T1132.001"
    context: "Data encoding within DNS queries"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: ["T1071.004", "T1041", "T1132.001", "T1573"]
    tactic: ["command-and-control", "exfiltration", "defense-evasion"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "DNS Tunneling Malware Analysis"
    - "Covert Channel Research Papers"
    - "Network Security Threat Intelligence"
  search_keywords: ["rainy day", "dns tunneling", "dns backdoor", "covert channel", "dns c2", "dns exfiltration"]
  embedding_text: "Rainy Day is a cross-platform backdoor leveraging DNS tunneling for command-and-control and data exfiltration. It encodes commands within DNS query subdomains, receives responses via TXT or CNAME records, executes instructions, and exfiltrates data through DNS traffic. The malware operates in restricted networks where only DNS is permitted, bypassing firewalls, proxies, and HTTP-focused security controls. Rainy Day supports multiple DNS record types, implements error correction, and adapts query patterns to evade detection. Detection requires DNS traffic anomaly analysis, query pattern recognition, monitoring for unusual subdomain structures, and correlation of DNS volume with legitimate resolution needs. This technique represents protocol abuse for covert communication."
