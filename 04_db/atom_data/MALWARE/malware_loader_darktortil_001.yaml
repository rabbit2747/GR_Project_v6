# GR Atom: DarkTortilla
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-LOADER-DARKTORTIL-001"
  name: "DarkTortilla"
  normalized_name: "darktortilla"
  aliases: ["Dark Tortilla", "DarkTortilla Crypter"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["INITIAL", "EXEC", "C2", "WINDOWS", "EVADE", "PERSIST"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L5", "L6"]
  target_zones: ["Z2", "Z3"]
  target_components: ["Windows Processes", ".NET Framework", "System Memory", "AutoIT Runtime"]

# ==== Section 5: Definition ====
definition:
  what: "DarkTortilla is a sophisticated .NET-based crypter and malware loader first identified in 2022, designed to decrypt and execute multiple types of malicious payloads including RATs, information stealers, and backdoors while evading detection through advanced obfuscation and anti-analysis techniques. The malware employs a multi-layer architecture with AutoIT script wrappers, encrypted payloads, and injection capabilities to deliver over 40 different malware families to Windows systems."
  why: "DarkTortilla provides cybercriminals with a robust platform for deploying diverse malware families while maintaining persistent access and evading security software. The crypter's primary value lies in its ability to protect malicious payloads from detection through multiple layers of encryption and obfuscation, significantly extending the operational lifespan of delivered malware. Its versatility in supporting numerous payload types makes it attractive for various attack campaigns from cryptocurrency theft to espionage operations."
  how: "DarkTortilla typically arrives via phishing emails with malicious attachments, drive-by downloads, or bundled with pirated software. The initial loader is often wrapped in AutoIT executables to evade static analysis. Upon execution, it performs extensive environment checks including sandbox detection, virtual machine identification, and debugging detection. The malware decrypts multiple layers of encrypted payloads using custom decryption routines, then injects the final payload into legitimate Windows processes using process hollowing or reflective DLL injection. It establishes persistence through registry modifications, scheduled tasks, and startup folder entries. The crypter maintains C2 communication for updates and payload retrieval, supporting modular deployment of RATs like AsyncRAT, NanoCore, and RedLine Stealer."
  core_concepts: ["Crypter Malware", ".NET Loader", "Multi-Stage Execution", "Payload Obfuscation", "Process Injection", "Anti-Analysis"]

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "MALWARE-CATEGORY-LOADER-001"
    label: "malware loader category"
  - type: "implements"
    target: "TECHNIQUE-PROCESS-INJECTION-001"
    label: "uses process injection"
  - type: "enables"
    target: "MALWARE-RAT-ASYNCRAT-001"
    label: "delivers AsyncRAT"
  - type: "implements"
    target: "TECHNIQUE-ANTI-DEBUGGING-001"
    label: "implements anti-analysis"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1027"
    tactic: ["defense-evasion"]
    subtechniques: ["T1027.002"]
  additional_mappings:
    - technique_id: "T1055"
      tactic: ["defense-evasion", "privilege-escalation"]
      description: "Process Injection"
    - technique_id: "T1140"
      tactic: ["defense-evasion"]
      description: "Deobfuscate/Decode Files or Information"
    - technique_id: "T1497"
      tactic: ["defense-evasion", "discovery"]
      description: "Virtualization/Sandbox Evasion"
    - technique_id: "T1204.002"
      tactic: ["execution"]
      description: "User Execution: Malicious File"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "Secureworks: DarkTortilla Analysis 2022"
    - "MITRE ATT&CK Framework"
    - "ANY.RUN Malware Sandbox: DarkTortilla Campaigns"
    - "Cisco Talos Intelligence: Multi-Payload Crypter Analysis"
  search_keywords: ["darktortilla crypter", "darktortilla malware", "dotnet crypter loader", "autoit malware wrapper", "multi-payload loader", "asyncrat loader", "crypter evasion techniques"]
  embedding_text: "DarkTortilla is an advanced .NET-based crypter and malware loader discovered in 2022, capable of delivering over 40 different malware families including AsyncRAT, NanoCore, RedLine Stealer, and various information stealers to Windows systems. The malware employs sophisticated multi-layer architecture combining AutoIT script wrappers, custom encryption schemes, and multiple obfuscation techniques to evade detection by security software. Distribution occurs through phishing campaigns, malicious downloads, and software bundling, with the loader performing extensive anti-analysis checks including sandbox detection, virtual machine identification, and debugger detection. DarkTortilla decrypts and executes payloads using process injection techniques such as process hollowing and reflective DLL injection, targeting legitimate Windows processes to hide malicious activity. Persistence mechanisms include registry modifications, scheduled tasks, and startup folder entries, while C2 communication enables dynamic payload updates and configuration changes. The crypter represents a significant threat due to its versatility, evasion capabilities, and support for numerous malware families across different attack campaigns."
