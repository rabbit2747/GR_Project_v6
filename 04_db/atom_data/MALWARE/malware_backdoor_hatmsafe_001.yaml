# GR Atom: HatMan Safety
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-BACKDOOR-HATMSAFE-001"
  name: "HatMan Safety"
  normalized_name: "hatman_safety"
  aliases: ["Triton Safety Module", "TRISIS Safety Component"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["ICS", "IMPACT", "EVADE", "PERSIST", "FIRMWARE"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L1", "L2"]
  target_zones: ["Z0A", "Z0B"]
  target_components: ["sis_safety_logic", "triconex_safety_controllers", "emergency_shutdown_systems", "safety_plc"]

# ==== Section 5: Definition ====
definition:
  what: "HatMan Safety is a specialized module within the HatMan/Triton malware framework specifically designed to manipulate Safety Instrumented System (SIS) logic and safety functions in industrial control environments. This component focuses on bypassing, disabling, or modifying safety mechanisms that prevent catastrophic industrial accidents. It targets the safety controller logic that governs emergency shutdown procedures, alarm systems, and fail-safe operations."
  why: "Attackers use the HatMan Safety module to compromise industrial safety systems that serve as the last line of defense against dangerous conditions. By targeting safety logic, attackers can either cause unsafe industrial conditions or mask malicious activity that would normally trigger safety alarms. This enables sabotage operations that could result in physical damage, environmental disasters, or loss of life."
  how: "The HatMan Safety module injects malicious ladder logic into Triconex safety controllers, modifying the safety instrumented functions that control emergency shutdowns and safety interlocks. It manipulates safety threshold values, disables alarm conditions, and can force safety systems into unsafe states. The module operates at the firmware level, making detection difficult, and includes logic to evade safety system diagnostics and integrity checks."
  core_concepts: ["safety_logic_manipulation", "sis_bypass", "emergency_shutdown_disable", "safety_alarm_suppression", "fail_unsafe_conditions", "ladder_logic_injection"]

# ==== Section 6: Relations ====
relations:
  - type: "part_of"
    target: "MALWARE-BACKDOOR-HATMAN-001"
  - type: "enables"
    target: "ATTACK-PATTERN-ICS-SABOTAGE-001"
  - type: "applies_to"
    target: "INFRA-COMPONENT-ICS-001"

# ==== Section 7: Security Profile (optional) ====
security_profile:
  mitre_mapping:
    technique_id: "T0836"
    tactic: ["Inhibit Response Function", "Impair Process Control"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "Dragos - Triton Safety System Analysis"
    - "FireEye - HatMan Framework Components"
    - "MITRE ATT&CK ICS - T0836 Modify Parameter"
    - "ICS-CERT - Safety System Compromise Analysis"
  search_keywords: ["hatman safety", "triton safety module", "sis manipulation", "safety logic attack", "emergency shutdown disable", "triconex safety", "fail unsafe", "safety bypass malware"]
  embedding_text: "HatMan Safety is a critical component of the Triton/HatMan malware framework specifically engineered to compromise Safety Instrumented Systems in industrial environments. This module directly manipulates safety controller logic that governs emergency shutdown systems, safety interlocks, and alarm functions designed to prevent catastrophic accidents. By injecting malicious ladder logic into Triconex controllers, it can disable safety mechanisms, suppress alarms, alter safety thresholds, or force systems into unsafe states. The module operates at the firmware level with sophisticated evasion techniques to avoid detection by safety system diagnostics. This represents an extremely dangerous attack capability that could enable industrial sabotage resulting in physical damage, environmental disasters, or casualties by compromising the final protective layer in safety-critical systems."
