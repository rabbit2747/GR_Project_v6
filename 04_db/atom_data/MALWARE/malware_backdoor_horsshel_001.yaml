# GR Atom: Horse Shell
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-BACKDOOR-HORSSHEL-001"
  name: "Horse Shell"
  normalized_name: "horse_shell"
  aliases: ["HorseShell", "WebShell Backdoor", "PHP Shell"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["WEB", "C2", "EXEC", "PERSIST", "PHP"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z3", "Z4", "Z5"]
  target_components: ["web_servers", "php_applications", "web_applications", "content_management_systems"]

# ==== Section 5: Definition ====
definition:
  what: "Horse Shell is a web shell backdoor malware that provides remote command execution and file management capabilities through web server interfaces. Typically deployed as PHP, ASP, or JSP scripts, it enables attackers to execute system commands, upload/download files, and maintain persistent access to compromised web servers through HTTP/HTTPS requests. The backdoor masquerades as legitimate web application files to avoid detection."
  why: "Attackers deploy Horse Shell on compromised web servers to establish persistent remote access through standard web protocols, bypassing firewall restrictions and blending with legitimate web traffic. Web shells are particularly valuable for maintaining access to internet-facing servers, conducting reconnaissance, lateral movement within DMZ environments, and serving as pivot points for deeper network penetration."
  how: "Horse Shell operates as a server-side script that receives commands via HTTP requests (GET/POST parameters or custom headers), executes them using system shell functions (system(), exec(), passthru()), and returns results in HTTP responses. It provides file browser interfaces, database access, process management, and sometimes includes obfuscation or password protection. The web shell is typically deployed through web application vulnerabilities, file upload exploits, or supply chain compromises."
  core_concepts: ["web_shell", "remote_command_execution", "http_backdoor", "server_side_script", "file_management", "web_persistence"]

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "MALWARE-CATEGORY-BACKDOOR-001"
  - type: "implements"
    target: "ATTACK-PATTERN-WEBSHELL-001"
  - type: "enables"
    target: "ATTACK-PATTERN-REMOTE-ACCESS-001"

# ==== Section 7: Security Profile (optional) ====
security_profile:
  mitre_mapping:
    technique_id: "T1505.003"
    tactic: ["Persistence", "Command and Control"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "MITRE ATT&CK T1505.003 - Server Software Component: Web Shell"
    - "OWASP - Web Shell Detection and Prevention"
    - "Web Application Security - Web Shell Analysis"
  search_keywords: ["horse shell", "web shell", "php backdoor", "webshell malware", "http backdoor", "server shell", "web command execution", "web persistence"]
  embedding_text: "Horse Shell is a web shell backdoor that enables remote command execution and file management through compromised web servers. Implemented as server-side scripts in PHP, ASP, or JSP, it provides attackers with persistent access via standard HTTP/HTTPS protocols that bypass firewall restrictions and blend with legitimate traffic. The backdoor receives commands through HTTP request parameters or headers, executes them using system shell functions, and returns results in responses. Horse Shell typically includes file browsing, upload/download capabilities, database access, and process management features. It often incorporates password protection and code obfuscation to evade detection. Web shells are commonly deployed through web application vulnerabilities, file upload exploits, or compromised content management systems. They serve as persistent footholds for reconnaissance, lateral movement, and maintaining access to internet-facing infrastructure."
