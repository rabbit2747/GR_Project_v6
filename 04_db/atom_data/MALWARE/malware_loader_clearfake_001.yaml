# GR Atom: ClearFake
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-LOADER-CLEARFAKE-001"
  name: "ClearFake"
  normalized_name: "clearfake"
  aliases: ["Clear Fake", "ClearFake Campaign"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["INITIAL", "EXEC", "WEB", "WINDOWS", "EVADE", "C2"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z2", "Z3"]
  target_components: ["Web Browsers", "JavaScript Engines", "Windows Installer", "PowerShell"]

# ==== Section 5: Definition ====
definition:
  what: "ClearFake is a sophisticated malware distribution campaign first observed in 2023 that employs fake browser update notifications and CAPTCHA verification prompts to deliver information stealers and loaders to Windows systems. The campaign leverages compromised WordPress sites, injected JavaScript, and social engineering to trick users into executing PowerShell commands that download and install malicious payloads including Lumma Stealer, RedLine Stealer, and various loader malware families."
  why: "ClearFake represents an evolution in drive-by download attacks, combining website compromise, legitimate-looking UI elements, and user interaction requirements to bypass security controls. The campaign's effectiveness stems from exploiting user trust in browser update mechanisms and CAPTCHA systems, both of which users encounter regularly and are trained to complete. By requiring manual command execution, the attack evades automated sandbox detection while maintaining high success rates through convincing social engineering tactics."
  how: "ClearFake compromises WordPress websites by exploiting vulnerabilities or using stolen credentials, then injects malicious JavaScript that triggers fake browser update alerts or CAPTCHA prompts. When users encounter these prompts, they are instructed to copy and paste PowerShell or Command Prompt commands to resolve the issue or complete verification. These commands download Base64-encoded payloads from attacker-controlled infrastructure, decode them, and execute information stealers or loaders. The malware establishes persistence, conducts system reconnaissance, harvests credentials and sensitive data, then exfiltrates information to C2 servers. The campaign continuously evolves its lures, scripts, and payloads to evade detection."
  core_concepts: ["Drive-By Download", "Website Compromise", "Social Engineering", "PowerShell Abuse", "Fake CAPTCHA", "Information Stealer Distribution"]

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "TECHNIQUE-DRIVE-BY-COMPROMISE-001"
    label: "drive-by compromise technique"
  - type: "implements"
    target: "TECHNIQUE-SOCIAL-ENGINEERING-001"
    label: "uses social engineering"
  - type: "enables"
    target: "MALWARE-STEALER-LUMMA-001"
    label: "distributes Lumma Stealer"
  - type: "requires"
    target: "TECHNIQUE-USER-EXECUTION-001"
    label: "requires manual command execution"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1189"
    tactic: ["initial-access"]
    subtechniques: []
  additional_mappings:
    - technique_id: "T1059.001"
      tactic: ["execution"]
      description: "Command and Scripting Interpreter: PowerShell"
    - technique_id: "T1027"
      tactic: ["defense-evasion"]
      description: "Obfuscated Files or Information"
    - technique_id: "T1204.002"
      tactic: ["execution"]
      description: "User Execution: Malicious File"
    - technique_id: "T1583.001"
      tactic: ["resource-development"]
      description: "Acquire Infrastructure: Domains"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "GuardiCore Labs: ClearFake Campaign Analysis 2023"
    - "MITRE ATT&CK Framework"
    - "Sucuri Website Security: WordPress Compromise Trends"
    - "SANS Internet Storm Center: Fake Update Campaigns"
  search_keywords: ["clearfake campaign", "fake browser captcha malware", "wordpress compromise loader", "powershell stealer distribution", "fake update 2023", "lumma stealer clearfake", "fake captcha powershell"]
  embedding_text: "ClearFake is a sophisticated malware distribution campaign identified in 2023 that compromises WordPress websites to deliver information stealers and loaders through fake browser update notifications and CAPTCHA verification prompts. The attack chain begins with compromised legitimate websites injected with malicious JavaScript that displays convincing fake alerts mimicking browser security warnings or CAPTCHA challenges. Victims are socially engineered to copy and execute PowerShell commands that download Base64-encoded payloads, primarily delivering Lumma Stealer, RedLine Stealer, and various loader malware. The campaign's success relies on exploiting user familiarity with routine browser updates and CAPTCHA systems, combined with legitimate website compromise to establish trust. ClearFake represents an evolution in drive-by attacks by requiring manual user interaction to evade automated detection systems while maintaining effectiveness through psychological manipulation and technical obfuscation. The campaign demonstrates ongoing attacker innovation in bypassing security controls through hybrid technical and social engineering approaches."
