# GR Atom: Hidden Key
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-BACKDOOR-HIDDKEY-001"
  name: "Hidden Key"
  normalized_name: "hidden_key"
  aliases: ["HiddenKey", "HK Backdoor", "Crypto Key Stealer"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["CRED", "CRYPTO", "COLLECT", "EVADE", "C2"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L5", "L6", "L7"]
  target_zones: ["Z2", "Z3", "Z4"]
  target_components: ["cryptographic_keys", "credential_stores", "key_management_systems", "certificate_stores", "ssh_keys"]

# ==== Section 5: Definition ====
definition:
  what: "Hidden Key is a specialized backdoor malware focused on stealing cryptographic keys, certificates, and authentication credentials from compromised systems. It targets key storage locations including Windows Certificate Store, SSH key directories, PGP keyrings, and application-specific credential stores. The malware employs stealth techniques to extract sensitive key material without triggering security alerts or leaving obvious forensic traces."
  why: "Attackers use Hidden Key to steal cryptographic material that can be leveraged for lateral movement, decryption of sensitive data, impersonation, and bypassing authentication mechanisms. Stolen keys provide persistent access credentials that often remain valid even after initial compromise is detected, enabling long-term espionage and unauthorized access to encrypted systems and communications."
  how: "Hidden Key operates by scanning common key storage locations and memory for cryptographic material. It hooks Windows Crypto API functions, monitors SSH agent processes, and extracts keys from browser credential stores. The malware employs anti-forensic techniques including memory-only operation, encrypted exfiltration channels, and time-delayed execution to avoid detection. Stolen keys are transmitted to C2 servers using encrypted protocols."
  core_concepts: ["credential_theft", "key_extraction", "crypto_api_hooking", "memory_scraping", "certificate_theft", "stealth_exfiltration"]

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "MALWARE-CATEGORY-BACKDOOR-001"
  - type: "enables"
    target: "ATTACK-PATTERN-CREDENTIAL-THEFT-001"
  - type: "implements"
    target: "ATTACK-PATTERN-API-HOOKING-001"

# ==== Section 7: Security Profile (optional) ====
security_profile:
  mitre_mapping:
    technique_id: "T1555"
    tactic: ["Credential Access", "Collection"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "MITRE ATT&CK T1555 - Credentials from Password Stores"
    - "Cryptographic Key Theft Analysis Report"
    - "Windows Credential Theft Techniques"
  search_keywords: ["hidden key", "key theft malware", "credential stealer", "crypto key extraction", "certificate theft", "ssh key stealer", "cryptographic backdoor", "key harvesting"]
  embedding_text: "Hidden Key is specialized backdoor malware engineered for stealing cryptographic keys, digital certificates, and authentication credentials from compromised systems. It systematically targets Windows Certificate Stores, SSH private keys, PGP keyrings, browser credential stores, and application-specific key storage locations. The malware employs sophisticated techniques including Crypto API hooking, memory scraping, and process monitoring to extract key material without detection. Hidden Key uses anti-forensic methods such as memory-only operation and encrypted exfiltration channels to avoid security monitoring. Stolen cryptographic material enables attackers to decrypt sensitive data, impersonate legitimate users, bypass authentication, and maintain persistent access even after initial compromise detection. The backdoor's focus on key theft makes it particularly dangerous for organizations relying on cryptographic security controls."
