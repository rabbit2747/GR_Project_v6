# GR Atom: HatMan
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-BACKDOOR-HATMAN-001"
  name: "HatMan"
  normalized_name: "hatman"
  aliases: ["Triton", "TRISIS", "HatMan Framework"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["ICS", "IMPACT", "FIRMWARE", "PERSIST", "C2", "EVADE"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L1", "L2", "L3"]
  target_zones: ["Z0A", "Z0B", "Z1"]
  target_components: ["triconex_safety_systems", "sis_controllers", "ics_plc", "safety_instrumented_systems", "industrial_firmware"]

# ==== Section 5: Definition ====
definition:
  what: "HatMan (also known as Triton or TRISIS) is sophisticated ICS-targeted malware specifically designed to attack Triconex Safety Instrumented Systems (SIS) used in critical infrastructure. First discovered in 2017, it represents one of the most dangerous ICS attack frameworks ever observed, capable of disabling or manipulating safety systems designed to prevent catastrophic industrial accidents. The malware can reprogram Triconex controllers at the firmware level, potentially causing physical damage or safety incidents."
  why: "Attackers developed HatMan to sabotage industrial safety systems in critical infrastructure facilities, particularly targeting energy sector operations. Unlike typical ICS malware that affects operational systems, HatMan specifically targets safety systems that serve as the last line of defense against catastrophic failures. This represents an escalation in ICS attacks from disruption to potential physical harm and environmental disasters."
  how: "HatMan operates through a Python-based framework that communicates with Triconex controllers using proprietary TriStation protocol. It exploits the lack of authentication in legacy SIS systems to inject malicious ladder logic and modify safety controller firmware. The malware can remain dormant, activated only under specific conditions, and includes capabilities to modify safety logic, disable alarms, or cause unsafe states while masking its presence from operators."
  core_concepts: ["ics_safety_system_attack", "triconex_targeting", "sis_manipulation", "firmware_reprogramming", "tristation_protocol", "safety_bypass", "industrial_sabotage"]

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "MALWARE-CATEGORY-BACKDOOR-001"
  - type: "applies_to"
    target: "INFRA-COMPONENT-ICS-001"
  - type: "enables"
    target: "ATTACK-PATTERN-ICS-SABOTAGE-001"
  - type: "implements"
    target: "ATTACK-PATTERN-FIRMWARE-CORRUPTION-001"

# ==== Section 7: Security Profile (optional) ====
security_profile:
  mitre_mapping:
    technique_id: "T0856"
    tactic: ["Inhibit Response Function", "Impair Process Control", "Impact"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "FireEye - TRITON Attribution Report"
    - "Dragos - TRISIS Malware Analysis"
    - "MITRE ATT&CK ICS - T0856 Damage to Property"
    - "ICS-CERT Advisory - Triton/Trisis Safety System Attack"
  search_keywords: ["hatman", "triton malware", "trisis", "triconex attack", "ics safety system", "sis malware", "tristation protocol", "industrial sabotage", "safety controller compromise"]
  embedding_text: "HatMan (Triton/TRISIS) is highly sophisticated ICS malware discovered in 2017 that specifically targets Schneider Electric Triconex Safety Instrumented Systems used in critical infrastructure. It represents a dangerous escalation in ICS attacks by targeting safety systems rather than operational systems. The malware uses a Python framework to communicate with Triconex controllers via the proprietary TriStation protocol, exploiting lack of authentication to reprogram safety logic and firmware. HatMan can disable safety mechanisms, modify alarm settings, and create unsafe industrial conditions while concealing its activity. Attributed to state-sponsored actors, it demonstrates advanced knowledge of ICS protocols and safety system architecture. The framework includes reconnaissance, exploitation, and payload deployment modules specifically engineered for Triconex environments."
