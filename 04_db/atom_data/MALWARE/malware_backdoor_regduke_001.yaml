# GR Atom: RegDuke
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "MALWARE-BACKDOOR-REGDUKE-001"
  name: "RegDuke"
  normalized_name: "regduke"
  aliases: ["RegistryDuke"]

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "technique"
  abstraction_level: 2
  atom_tags: ["C2", "WINDOWS", "PERSIST", "EVADE", "EXEC"]

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z2", "Z3"]
  target_components: ["Windows Registry", "Registry Keys", "System Services", "File System"]

# ==== Section 5: Definition ====
definition:
  what: "RegDuke is a sophisticated registry-based backdoor associated with APT29 (Cozy Bear) that stores malicious payloads and configuration data within Windows registry keys. The malware uses the registry for both persistence and as a storage mechanism for encrypted commands and stolen data, minimizing file system artifacts."
  why: "APT29 employs RegDuke to maintain stealthy long-term access with minimal forensic footprint. By storing operational data in the registry rather than files, the backdoor evades file-based security scans and reduces detection risks while providing reliable persistence across system reboots."
  how: "RegDuke operates by creating hidden registry keys in system or user hives, storing encrypted payload code and configuration within registry values, executing the payload directly from memory after registry extraction, receiving commands through registry updates from other compromised systems or C2 channels, and storing collected data in registry keys before exfiltration. The backdoor uses Windows API calls for registry manipulation and encryption to protect stored content."
  core_concepts: ["APT29 Tool", "Registry-Based Storage", "Fileless Persistence", "In-Registry Encryption", "Living-off-the-Land"]

# ==== Section 6: Relations ====
relations:
  - type: "implements"
    target: "ATT&CK-T1547.001"
    context: "Registry run keys persistence"
  - type: "implements"
    target: "ATT&CK-T1112"
    context: "Registry modification"
  - type: "enables"
    target: "ATT&CK-T1140"
    context: "Deobfuscate/decode files or information from registry"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: ["T1547.001", "T1112", "T1140", "T1027"]
    tactic: ["persistence", "defense-evasion", "command-and-control"]

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  version: "1.0"
  confidence: "high"
  trust_source: "primary"
  sources:
    - "APT29 Cozy Bear Analysis"
    - "Registry-Based Malware Research"
    - "MITRE ATT&CK APT29 Documentation"
  search_keywords: ["regduke", "apt29", "cozy bear", "registry backdoor", "fileless malware", "registry persistence"]
  embedding_text: "RegDuke is an APT29 registry-based backdoor that stores payloads and data within Windows registry keys to minimize file system artifacts. It creates hidden registry keys, stores encrypted code and configuration in registry values, executes payloads from memory after extraction, receives commands through registry updates, and stages collected data before exfiltration. The malware uses Windows API for registry manipulation and encryption for content protection. RegDuke represents advanced fileless techniques that evade traditional file-scanning security controls. Detection requires registry monitoring for suspicious key creation, value modifications, unusually large registry data, behavioral analysis of registry-based execution, and memory forensics to identify in-memory payloads loaded from registry sources."
