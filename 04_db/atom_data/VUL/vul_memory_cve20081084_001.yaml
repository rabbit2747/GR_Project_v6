# GR Atom: CVE-2008-1084
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20081084-001"
  name: "CVE-2008-1084"
  normalized_name: "cve_2008_1084"
  aliases:
    - "Windows Kernel win32k.sys Privilege Escalation"
    - "MS08-025"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - PRIV
    - OVERFLOW
    - WINDOWS
    - OS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L1", "L2"]
  target_zones: ["Z3"]
  target_components:
    - "Microsoft Windows win32k.sys"
    - "Windows XP SP2"
    - "Windows Server 2003"
    - "Windows Vista"
    - "Windows Server 2008"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2008-1084 (CVSS 7.2) is a privilege escalation vulnerability in the Windows kernel-mode
    driver win32k.sys affecting Windows XP, Server 2003, Vista, and Server 2008. The vulnerability
    exists in the handling of Windows system calls where improper validation of user-supplied
    parameters allows a local attacker to trigger a buffer overflow in kernel memory. Successful
    exploitation grants SYSTEM-level privileges. Patched in Microsoft Security Bulletin MS08-025
    (April 2008).
  why: >-
    win32k.sys is the Windows kernel-mode component responsible for the Window Manager, GDI
    graphics subsystem, and user input handling. Vulnerabilities in this driver are particularly
    dangerous because exploitation provides kernel-level code execution, bypassing all user-mode
    security controls. This CVE established win32k.sys as a high-value target for local privilege
    escalation, a pattern that continued for over a decade of Windows exploitation.
  how: >-
    The vulnerability is triggered by making specific Windows system calls with carefully crafted
    parameters that bypass input validation in win32k.sys. The insufficient parameter checking
    leads to a kernel buffer overflow, allowing an attacker to overwrite kernel memory structures.
    By controlling the overflow data, the attacker can redirect kernel execution flow to
    attacker-controlled code running at SYSTEM privilege level. Exploitation requires local
    access or execution of malicious code through another vulnerability.
  core_concepts:
    - key: "win32k.sys Kernel Driver"
      value: "Windows kernel-mode driver for window management and GDI graphics, running at the highest privilege level"
    - key: "Kernel Buffer Overflow"
      value: "Insufficient parameter validation in system call handling allows kernel memory corruption and SYSTEM-level code execution"
    - key: "Local Privilege Escalation"
      value: "Enables escalation from any user context to SYSTEM privileges by exploiting kernel-mode vulnerability"

# ==== Section 6: Relations ====
relations:
  - type: "precedes"
    target: "VUL-MEMORY-CVE20104398-001"
    description: "Early win32k.sys kernel privilege escalation, followed by a long series of similar win32k.sys vulnerabilities"
  - type: "enables"
    target: "VUL-MEMORY-CVE20112005-001"
    description: "Same vulnerability class in win32k.sys enabling local privilege escalation on Windows systems"
  - type: "applies_to"
    target: "INFRA-OS-WINDOWS-001"
    description: "Affects Windows XP through Server 2008 kernel"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1068"
    tactic:
      - "Privilege Escalation"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Bulletin MS08-025"
    - "CVE-2008-1084 - NIST NVD"
    - "MITRE ATT&CK T1068 - Exploitation for Privilege Escalation"
  search_keywords:
    - "CVE-2008-1084"
    - "MS08-025"
    - "win32k.sys"
    - "Windows kernel privilege escalation"
    - "kernel buffer overflow"
    - "local privilege escalation"
    - "Windows kernel vulnerability"
  embedding_text: >-
    CVE-2008-1084 is a privilege escalation vulnerability (CVSS 7.2) in the Windows kernel-mode
    driver win32k.sys (MS08-025). Improper validation of user-supplied parameters in Windows
    system calls allows kernel buffer overflow, enabling local attackers to gain SYSTEM privileges.
    Affects Windows XP, Server 2003, Vista, and Server 2008. This vulnerability established
    win32k.sys as a primary target for privilege escalation attacks, a pattern that persisted
    across many subsequent Windows vulnerabilities.
