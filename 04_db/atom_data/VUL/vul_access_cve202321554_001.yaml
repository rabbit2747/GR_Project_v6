# GR Atom: CVE-2023-21554
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-ACCESS-CVE202321554-001"
  name: "CVE-2023-21554"
  normalized_name: "cve_2023_21554"
  aliases:
    - "QueueJumper"
    - "Microsoft Message Queuing RCE"
    - "MSMQ Vulnerability"
    - "Windows MSMQ RCE"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - INITIAL
    - WINDOWS
    - NETWORK
    - OVERFLOW

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L4", "L5"]
  target_zones: ["Z1", "Z2"]
  target_components:
    - "Microsoft Message Queuing (MSMQ)"
    - "Windows Server with MSMQ role"
    - "TCP port 1801"
    - "Windows 10, 11, Server 2012-2022"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2023-21554, dubbed QueueJumper, is a critical remote code execution vulnerability
    in the Microsoft Message Queuing (MSMQ) service, disclosed in April 2023 with a CVSS
    score of 9.8. The vulnerability allows an unauthenticated remote attacker to execute
    arbitrary code on the target system by sending a specially crafted MSMQ packet to TCP
    port 1801. The flaw exists in the way MSMQ processes incoming messages, specifically
    in parsing malformed packet headers that trigger a memory corruption condition. MSMQ
    is an optional Windows component but is enabled in many enterprise environments for
    application messaging and is installed as a dependency by several Microsoft products
    including Exchange Server and certain database configurations.
  why: >-
    QueueJumper is particularly dangerous because it combines pre-authentication remote code
    execution with the widespread deployment of MSMQ in enterprise Windows environments.
    Check Point Research estimated over 360,000 internet-facing MSMQ instances at disclosure.
    MSMQ runs as a privileged service, so exploitation grants SYSTEM-level access. The
    vulnerability requires no user interaction and no authentication, making it ideal for
    automated exploitation and worm propagation. Many administrators are unaware that MSMQ
    is installed as it is often added as a silent dependency.
  how: >-
    An attacker sends a specially crafted network packet to TCP port 1801 where the MSMQ
    service listens. The malformed packet header triggers a heap-based memory corruption
    in the MSMQ message parsing logic. This memory corruption can be leveraged for
    arbitrary code execution in the context of the MSMQ service, which runs with SYSTEM
    privileges. Exploitation requires only network connectivity to port 1801 and no
    authentication. Mitigation includes applying the April 2023 Patch Tuesday update,
    disabling MSMQ if not needed, blocking TCP port 1801 at the firewall, and auditing
    systems for unintended MSMQ installations. Microsoft also recommended restricting
    MSMQ network access through Windows Firewall rules.
  core_concepts:
    - key: "MSMQ Message Parsing"
      value: "Memory corruption in Microsoft Message Queuing packet header parsing enables pre-authentication remote code execution on TCP port 1801"
    - key: "Silent Dependency Risk"
      value: "MSMQ is often installed as a silent dependency by Exchange Server and other products, creating an unknown attack surface for administrators"
    - key: "SYSTEM-Level RCE"
      value: "MSMQ service runs with SYSTEM privileges, granting attackers the highest privilege level on Windows upon successful exploitation"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-ACCESS-ACCESS-001"
    description: "QueueJumper exploits unauthenticated access to the MSMQ service enabling remote code execution without any access control"
  - type: "applies_to"
    target: "VUL-ACCESS-BLUEKEEP-001"
    description: "Both are critical wormable Windows service vulnerabilities enabling pre-authentication RCE through network protocols"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1190"
    tactic:
      - "Initial Access"
      - "Execution"
  cve_id: "CVE-2023-21554"
  cvss_score: 9.8
  affected_product: "Microsoft Message Queuing (MSMQ)"
  disclosure_year: 2023

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Advisory CVE-2023-21554"
    - "Check Point Research - QueueJumper MSMQ Vulnerability"
    - "NVD CVE-2023-21554 CVSS 9.8"
    - "MITRE ATT&CK T1190 - Exploit Public-Facing Application"
  search_keywords:
    - "CVE-2023-21554"
    - "QueueJumper"
    - "MSMQ vulnerability"
    - "Microsoft Message Queuing"
    - "port 1801 exploit"
    - "Windows MSMQ RCE"
    - "message queue vulnerability"
    - "MSMQ remote code execution"
  embedding_text: >-
    CVE-2023-21554 (QueueJumper) is a critical remote code execution vulnerability (CVSS 9.8)
    in Microsoft Message Queuing service. Unauthenticated attackers send crafted packets to
    TCP port 1801 triggering heap memory corruption for SYSTEM-level code execution. Over
    360,000 internet-facing MSMQ instances identified. MSMQ often installed as silent
    dependency by Exchange Server and other products. Requires no authentication or user
    interaction. Affects Windows 10, 11, and Server 2012 through 2022. Mitigation includes
    April 2023 patches, disabling MSMQ, blocking port 1801, and auditing for unintended
    installations. Wormable pre-authentication RCE comparable to BlueKeep in severity.
