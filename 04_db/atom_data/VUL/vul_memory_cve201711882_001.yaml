# GR Atom: CVE-2017-11882
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE201711882-001"
  name: "CVE-2017-11882"
  normalized_name: "cve_2017_11882"
  aliases:
    - "Microsoft Equation Editor RCE"
    - "EQNEDT32 Stack Buffer Overflow"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - INITIAL
    - OVERFLOW
    - WINDOWS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z3", "Z4"]
  target_components:
    - "Microsoft Office Equation Editor (EQNEDT32.EXE)"
    - "Microsoft Office 2007-2016"
    - "Microsoft Office 365"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2017-11882 is a stack-based buffer overflow vulnerability (CVSS 7.8) in Microsoft
    Office Equation Editor component (EQNEDT32.EXE) that allows remote code execution when
    a user opens a specially crafted Office document. The Equation Editor is a legacy 17-year-old
    component compiled without modern exploit mitigations like ASLR or DEP, making exploitation
    highly reliable. Disclosed in November 2017, it became one of the most heavily exploited
    Office vulnerabilities in history, used by dozens of threat actors including APT groups
    and commodity malware campaigns. Microsoft patched it in November 2017 and later removed
    Equation Editor entirely in January 2018.
  why: >-
    CVE-2017-11882 is critically important because the Equation Editor binary lacked all modern
    memory protections, making exploitation trivially reliable across all Office versions without
    requiring user interaction beyond opening a document. Its ubiquitous exploitation by both
    APT groups and commodity malware made it one of the top exploited vulnerabilities for years
    after disclosure. The vulnerability demonstrates how legacy components embedded in modern
    software create hidden attack surfaces that persist for decades.
  how: >-
    The vulnerability is triggered by embedding a malicious OLE object referencing Equation
    Editor in an Office document (typically .doc or .rtf). When the document is opened, Office
    invokes EQNEDT32.EXE which processes the crafted equation data, overflowing a stack buffer
    in the font name field. Because EQNEDT32.EXE lacks ASLR and DEP protections, the attacker
    directly overwrites the return address to redirect execution to shellcode. No additional
    user interaction is needed beyond opening the document, enabling delivery via spear-phishing
    email attachments.
  core_concepts:
    - key: "Legacy Component Exploitation"
      value: "EQNEDT32.EXE was a 17-year-old binary compiled without ASLR, DEP, or stack canaries making exploitation trivially reliable"
    - key: "Stack Buffer Overflow"
      value: "Overflow in font name processing overwrites stack return address enabling direct code execution without modern bypass techniques"
    - key: "Mass Exploitation"
      value: "Became one of the most exploited Office vulnerabilities used by APT groups and commodity malware globally for years"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "CVE-2017-11882 is a stack buffer overflow memory corruption vulnerability in Office Equation Editor"
  - type: "enables"
    target: "VUL-MEMORY-CVE20180798-001"
    description: "CVE-2018-0798 exploits the same Equation Editor component with a different memory corruption vector"
  - type: "enables"
    target: "VUL-MEMORY-CVE20180802-001"
    description: "CVE-2018-0802 is a patch bypass for the same Equation Editor component discovered after CVE-2017-11882"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1203"
    tactic:
      - "Execution"
      - "Initial Access"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Advisory CVE-2017-11882"
    - "Embedi Research - Skeleton in the Closet (EQNEDT32 Analysis)"
    - "MITRE ATT&CK T1203 - Exploitation for Client Execution"
    - "NVD Entry CVE-2017-11882 - CVSS 7.8"
  search_keywords:
    - "CVE-2017-11882"
    - "Equation Editor"
    - "EQNEDT32"
    - "Office RCE"
    - "stack buffer overflow"
    - "Microsoft Office exploit"
    - "legacy component"
    - "spear-phishing"
  embedding_text: >-
    CVE-2017-11882 is a stack-based buffer overflow in Microsoft Office Equation Editor
    component EQNEDT32.EXE with CVSS 7.8 enabling remote code execution through crafted
    Office documents. The 17-year-old legacy binary lacked ASLR, DEP, and stack canaries
    making exploitation trivially reliable. Triggered by opening a document containing a
    malicious OLE equation object, the overflow in font name processing overwrites the
    stack return address for direct shellcode execution. It became one of the most heavily
    exploited Office vulnerabilities in history, used by dozens of APT groups and commodity
    malware campaigns. Microsoft patched it in November 2017 and removed Equation Editor
    entirely in January 2018.
