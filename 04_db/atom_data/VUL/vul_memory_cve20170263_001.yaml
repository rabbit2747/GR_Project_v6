# GR Atom: CVE-2017-0263
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20170263-001"
  name: "CVE-2017-0263"
  normalized_name: "cve_2017_0263"
  aliases:
    - "Win32k Elevation of Privilege"
    - "Windows Win32k Use-After-Free"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - PRIV
    - EXEC
    - OVERFLOW
    - WINDOWS
    - OS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L1", "L2"]
  target_zones: ["Z3", "Z4"]
  target_components:
    - "Windows Win32k kernel driver"
    - "Windows GDI subsystem"
    - "Windows kernel memory manager"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2017-0263 is a use-after-free vulnerability in the Windows Win32k kernel-mode
    driver (CVSS 7.8) that allows local privilege escalation from user to SYSTEM context.
    Discovered being exploited in the wild in 2017 as part of a multi-stage attack chain
    alongside CVE-2017-0262 (an EPS vulnerability), the flaw exists in how Win32k handles
    window objects in kernel memory. It was actively exploited by APT28 (Fancy Bear/Sofacy)
    in targeted spear-phishing campaigns against government entities. Microsoft patched
    this vulnerability in May 2017 (MS17-May).
  why: >-
    Win32k kernel vulnerabilities are among the most commonly exploited privilege escalation
    vectors in Windows because the Win32k driver runs in kernel mode and has a large legacy
    attack surface. Successful exploitation grants SYSTEM-level privileges, enabling complete
    host compromise. This vulnerability was chained with document-based exploits for full
    attack chains from initial access through privilege escalation, demonstrating the layered
    approach used by sophisticated threat actors.
  how: >-
    The vulnerability is triggered by manipulating window objects to create a use-after-free
    condition in Win32k kernel memory. An attacker first obtains code execution through a
    companion vulnerability (such as CVE-2017-0262 via a malicious EPS file in an Office
    document), then exploits CVE-2017-0263 to elevate privileges. The use-after-free allows
    kernel memory corruption, enabling arbitrary code execution in kernel context. Exploitation
    typically involves heap spraying to control freed memory content and redirect execution
    flow to attacker-controlled code running at SYSTEM privilege level.
  core_concepts:
    - key: "Win32k Use-After-Free"
      value: "Memory corruption in Windows kernel-mode Win32k driver through improper handling of window object lifetimes in kernel memory"
    - key: "Kernel Privilege Escalation"
      value: "Exploitation grants SYSTEM-level privileges from unprivileged user context by corrupting kernel memory structures"
    - key: "APT28 Attack Chain"
      value: "Actively exploited by Fancy Bear/Sofacy as privilege escalation stage chained with document-based initial access exploits"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "CVE-2017-0263 is a use-after-free memory corruption vulnerability in Windows Win32k kernel driver"
  - type: "enables"
    target: "VUL-MEMORY-CVE20190803-001"
    description: "Both are Win32k elevation of privilege vulnerabilities exploiting similar kernel memory corruption patterns"
  - type: "precedes"
    target: "VUL-MEMORY-CVE20190859-001"
    description: "CVE-2019-0859 is a later Win32k use-after-free privilege escalation following similar exploitation patterns"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1068"
    tactic:
      - "Privilege Escalation"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Bulletin MS17-May (CVE-2017-0263)"
    - "ESET Research - APT28 Exploitation of CVE-2017-0263"
    - "MITRE ATT&CK T1068 - Exploitation for Privilege Escalation"
    - "NVD Entry CVE-2017-0263 - CVSS 7.8"
  search_keywords:
    - "CVE-2017-0263"
    - "Win32k use-after-free"
    - "Windows privilege escalation"
    - "APT28"
    - "Fancy Bear"
    - "kernel exploit"
    - "Win32k EoP"
    - "MS17-May"
  embedding_text: >-
    CVE-2017-0263 is a use-after-free vulnerability in the Windows Win32k kernel-mode
    driver with CVSS 7.8 that enables local privilege escalation to SYSTEM. The flaw
    resides in how Win32k handles window objects in kernel memory. It was actively
    exploited by APT28 (Fancy Bear) in 2017 as part of targeted spear-phishing campaigns
    against government entities, chained with CVE-2017-0262 for a complete attack chain
    from document-based initial access through kernel privilege escalation. The Win32k
    driver's large legacy attack surface makes it a frequent target for privilege
    escalation exploits. Microsoft patched the vulnerability in May 2017.
