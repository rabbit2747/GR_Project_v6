# GR Atom: CVE-2021-26857
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE202126857-001"
  name: "CVE-2021-26857"
  normalized_name: "cve_2021_26857"
  aliases:
    - "Exchange Server Deserialization RCE"
    - "ProxyLogon Chain Component"
    - "Hafnium Exchange Exploit"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - DESER
    - WINDOWS
    - NETWORK

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L5", "L7"]
  target_zones: ["Z1", "Z2"]
  target_components:
    - "Microsoft Exchange Server 2013-2019"
    - "Exchange Unified Messaging service"
    - "Exchange Server OWA/ECP"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2021-26857 is an insecure deserialization vulnerability (CVSS 7.8) in Microsoft
    Exchange Server's Unified Messaging service that allows code execution as SYSTEM. It is
    one of four vulnerabilities in the ProxyLogon attack chain exploited by the HAFNIUM
    threat actor (Chinese state-sponsored) in a massive campaign affecting over 250,000
    Exchange servers worldwide beginning in January 2021. The vulnerability allows an
    authenticated attacker (or one who has achieved authentication bypass via CVE-2021-26855)
    to execute arbitrary code on the Exchange server through crafted serialized objects sent
    to the Unified Messaging service. Microsoft issued emergency patches in March 2021.
  why: >-
    CVE-2021-26857 is a critical component of the ProxyLogon attack chain that was one of
    the most impactful cyber campaigns in history. The Unified Messaging deserialization
    vulnerability provided a reliable code execution path after initial authentication bypass.
    The ProxyLogon chain compromised hundreds of thousands of Exchange servers globally,
    affecting government agencies, defense contractors, and critical infrastructure. The
    campaign's scope prompted a rare FBI operation to remotely remove web shells from
    compromised Exchange servers.
  how: >-
    After gaining authenticated access to Exchange (typically via CVE-2021-26855 SSRF), the
    attacker sends a crafted serialized .NET object to the Unified Messaging service. The
    service deserializes the malicious object without proper validation, triggering arbitrary
    code execution as SYSTEM. The deserialization exploit leverages known .NET deserialization
    gadget chains to achieve command execution. In the ProxyLogon chain, this vulnerability
    is used alongside CVE-2021-26855, CVE-2021-26858, and CVE-2021-27065 to achieve
    unauthenticated remote code execution and web shell deployment on Exchange servers.
  core_concepts:
    - key: "Insecure .NET Deserialization"
      value: "Unified Messaging service deserializes untrusted .NET objects enabling arbitrary code execution as SYSTEM"
    - key: "ProxyLogon Attack Chain"
      value: "Component of four-vulnerability chain that compromised over 250,000 Exchange servers globally"
    - key: "HAFNIUM Campaign"
      value: "Exploited by Chinese state-sponsored HAFNIUM group in one of the most impactful cyber campaigns in history"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "CVE-2021-26857 involves deserialization-based memory manipulation in Exchange Unified Messaging"
  - type: "part_of"
    target: "VUL-MEMORY-CVE202140444-001"
    description: "Both are Microsoft product vulnerabilities exploited in sophisticated multi-stage attack chains"
  - type: "enables"
    target: "VUL-MEMORY-CVE20201938-001"
    description: "Both are server-side vulnerabilities enabling code execution through crafted protocol messages"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1190"
    tactic:
      - "Initial Access"
      - "Execution"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Advisory CVE-2021-26857"
    - "Microsoft - HAFNIUM Targeting Exchange Servers"
    - "Volexity - Operation Exchange Marauder"
    - "NVD Entry CVE-2021-26857 - CVSS 7.8"
    - "CISA Emergency Directive 21-02"
  search_keywords:
    - "CVE-2021-26857"
    - "ProxyLogon"
    - "Exchange Server"
    - "HAFNIUM"
    - "deserialization"
    - "Unified Messaging"
    - "Exchange exploit"
    - "web shell"
  embedding_text: >-
    CVE-2021-26857 is an insecure deserialization vulnerability in Microsoft Exchange
    Server's Unified Messaging service with CVSS 7.8 enabling code execution as SYSTEM.
    A component of the ProxyLogon attack chain exploited by Chinese state-sponsored HAFNIUM
    group, it contributed to the compromise of over 250,000 Exchange servers worldwide.
    After authentication bypass via CVE-2021-26855, crafted .NET serialized objects trigger
    arbitrary code execution through the Unified Messaging service. The ProxyLogon campaign
    was one of the most impactful cyber operations in history, prompting emergency patches
    in March 2021 and a rare FBI operation to remotely clean compromised servers.
