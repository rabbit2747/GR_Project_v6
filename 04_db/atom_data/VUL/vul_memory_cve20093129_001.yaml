# GR Atom: CVE-2009-3129
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20093129-001"
  name: "CVE-2009-3129"
  normalized_name: "cve_2009_3129"
  aliases:
    - "Microsoft Excel FEATHEADER Record Memory Corruption"
    - "MS09-067"
    - "Excel Featheader Heap Overflow"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - OVERFLOW
    - WINDOWS
    - INITIAL

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L7"]
  target_zones: ["Z2", "Z3"]
  target_components:
    - "Microsoft Office Excel 2002"
    - "Microsoft Office Excel 2003"
    - "Microsoft Office Excel 2007"
    - "Microsoft Office 2004 for Mac"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2009-3129 (CVSS 9.3) is a critical memory corruption vulnerability in Microsoft Excel
    caused by improper parsing of FEATHEADER records in Excel binary file format (.xls). When
    Excel processes a specially crafted spreadsheet containing a malformed FEATHEADER record,
    a heap-based buffer overflow occurs that allows arbitrary code execution with the privileges
    of the current user. The vulnerability affects Excel 2002, 2003, 2007, and Office 2004 for
    Mac. Patched in MS09-067 (November 2009). Actively exploited in targeted attacks.
  why: >-
    Microsoft Excel is a ubiquitous business application, making Excel file-based exploits
    highly effective for spearphishing campaigns targeting corporate environments. This CVE
    was actively exploited by APT groups in targeted attacks against government and defense
    organizations, establishing Excel as a preferred vector for delivering malware through
    seemingly legitimate business documents.
  how: >-
    The vulnerability is triggered when Excel parses a FEATHEADER record in the binary .xls
    file format with a malformed cbHdrData field that specifies an incorrect size. Excel
    allocates a heap buffer based on the specified size but copies more data than allocated,
    causing a heap overflow. Attackers embed the malicious Excel file in spearphishing emails
    as attachments. When the victim opens the file, the heap corruption enables controlled
    code execution, typically used to install backdoor malware.
  core_concepts:
    - key: "Excel Binary Format Parsing"
      value: "FEATHEADER record parsing in .xls binary format fails to validate cbHdrData size, causing heap buffer overflow"
    - key: "Spearphishing Vector"
      value: "Excel documents used as delivery mechanism in targeted APT campaigns against government and corporate targets"
    - key: "APT Exploitation"
      value: "Actively exploited in the wild by advanced persistent threat groups for targeted intrusions"

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "VUL-MEMORY-CVE20040200-001"
    description: "Both are Microsoft product memory corruption vulnerabilities exploitable through crafted document files"
  - type: "precedes"
    target: "VUL-MEMORY-CVE20103333-001"
    description: "Office document parsing vulnerability pattern continued with Word RTF stack overflow in 2010"
  - type: "applies_to"
    target: "INFRA-OS-WINDOWS-001"
    description: "Affects Microsoft Excel on Windows platforms"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1203"
    tactic:
      - "Execution"
      - "Initial Access"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Bulletin MS09-067"
    - "CVE-2009-3129 - NIST NVD"
    - "MITRE ATT&CK T1203 - Exploitation for Client Execution"
  search_keywords:
    - "CVE-2009-3129"
    - "MS09-067"
    - "Excel FEATHEADER"
    - "Excel memory corruption"
    - "Office spearphishing"
    - "Excel heap overflow"
    - "xls file exploit"
  embedding_text: >-
    CVE-2009-3129 is a critical heap-based buffer overflow (CVSS 9.3) in Microsoft Excel
    FEATHEADER record parsing (MS09-067). Malformed cbHdrData fields in .xls binary format
    trigger heap corruption enabling arbitrary code execution. Affects Excel 2002-2007 and
    Office 2004 for Mac. Actively exploited by APT groups in spearphishing campaigns targeting
    government and defense organizations, this vulnerability established Excel documents as a
    preferred vector for targeted malware delivery through business documents.
