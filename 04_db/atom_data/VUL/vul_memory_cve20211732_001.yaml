# GR Atom: CVE-2021-1732
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20211732-001"
  name: "CVE-2021-1732"
  normalized_name: "cve_2021_1732"
  aliases:
    - "Win32k Window Type Confusion EoP"
    - "Bitter APT Win32k Exploit"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - PRIV
    - EXEC
    - OVERFLOW
    - WINDOWS
    - OS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L1", "L2"]
  target_zones: ["Z3", "Z4"]
  target_components:
    - "Windows Win32k kernel-mode driver"
    - "Windows 10 versions 1803-20H2"
    - "Windows Server 2019"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2021-1732 is a Win32k elevation of privilege vulnerability (CVSS 7.8) that allows
    local privilege escalation through a type confusion in window object handling. Discovered
    by DBAPPSecurity being exploited as a zero-day by the Bitter APT group (also known as
    T-APT-17) targeting organizations in China and Pakistan, it was patched by Microsoft in
    February 2021. The vulnerability specifically affects the win32kfull.sys driver on
    Windows 10 and Server 2019, exploiting how the kernel handles the xxxClientAllocWindowClassExtraBytes
    callback to achieve an out-of-bounds write.
  why: >-
    CVE-2021-1732 is notable for its use by the Bitter APT group, a South Asian threat actor
    conducting espionage operations. The vulnerability provided a reliable Windows 10 kernel
    privilege escalation that was integrated into targeted attack chains. Its exploitation
    pattern demonstrated how Win32k vulnerabilities continue to be discovered and weaponized
    by APT groups for targeted operations, maintaining the pattern of Win32k being the most
    frequently exploited Windows kernel component.
  how: >-
    The exploit manipulates the win32kfull.sys driver by triggering a specific user-mode
    callback (xxxClientAllocWindowClassExtraBytes) during window creation. By returning
    crafted data from the callback, the attacker causes a type confusion in how the kernel
    interprets window object extra bytes. This enables an out-of-bounds write in kernel
    memory. The attacker uses this primitive to corrupt kernel structures and achieve
    arbitrary read/write, ultimately executing code in kernel context. The exploit is
    delivered as a second stage after initial access through document-based exploits.
  core_concepts:
    - key: "Win32k Type Confusion"
      value: "User-mode callback manipulation causes type confusion in window object extra bytes handling for kernel memory corruption"
    - key: "Bitter APT Zero-Day"
      value: "Exploited by South Asian Bitter APT group in targeted espionage campaigns against China and Pakistan"
    - key: "Callback-Based Exploitation"
      value: "Exploits kernel-to-user-mode callback mechanism in Win32k for controlled kernel memory corruption"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "CVE-2021-1732 is a type confusion memory corruption in Win32k kernel driver"
  - type: "enables"
    target: "VUL-MEMORY-CVE20170263-001"
    description: "Both are Win32k kernel privilege escalation vulnerabilities exploited by APT groups"
  - type: "enables"
    target: "VUL-MEMORY-CVE20190859-001"
    description: "Both are Win32k window object handling vulnerabilities enabling local privilege escalation"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1068"
    tactic:
      - "Privilege Escalation"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Advisory CVE-2021-1732"
    - "DBAPPSecurity - Bitter APT Win32k Zero-Day Analysis"
    - "NVD Entry CVE-2021-1732 - CVSS 7.8"
    - "MITRE ATT&CK T1068 - Exploitation for Privilege Escalation"
  search_keywords:
    - "CVE-2021-1732"
    - "Win32k"
    - "type confusion"
    - "Bitter APT"
    - "privilege escalation"
    - "kernel exploit"
    - "win32kfull.sys"
    - "T-APT-17"
  embedding_text: >-
    CVE-2021-1732 is a Win32k elevation of privilege vulnerability with CVSS 7.8 exploiting
    a type confusion in window object handling in win32kfull.sys. Discovered by DBAPPSecurity
    as a zero-day exploited by the Bitter APT group targeting organizations in China and
    Pakistan, it was patched in February 2021. The exploit manipulates user-mode callbacks
    during window creation to cause a type confusion in kernel window object extra bytes,
    enabling out-of-bounds writes for kernel memory corruption. This provides arbitrary
    read/write primitives for SYSTEM privilege escalation, continuing the pattern of Win32k
    being the most frequently exploited Windows kernel component.
