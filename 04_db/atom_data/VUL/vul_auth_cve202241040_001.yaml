# GR Atom: CVE-2022-41040
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-AUTH-CVE202241040-001"
  name: "CVE-2022-41040"
  normalized_name: "cve_2022_41040"
  aliases:
    - "ProxyNotShell SSRF"
    - "Microsoft Exchange Server-Side Request Forgery"
    - "Exchange SSRF CVE-2022-41040"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - INITIAL
    - SSRF
    - WEB
    - WINDOWS
    - HTTP

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L7"]
  target_zones: ["Z2", "Z3"]
  target_components:
    - "Microsoft Exchange Server 2013"
    - "Microsoft Exchange Server 2016"
    - "Microsoft Exchange Server 2019"
    - "Exchange Autodiscover endpoint"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2022-41040 is a server-side request forgery (SSRF) vulnerability in Microsoft Exchange
    Server affecting versions 2013, 2016, and 2019. Known as part of the ProxyNotShell attack
    chain, this vulnerability allows an authenticated attacker to remotely trigger SSRF via the
    Exchange Autodiscover endpoint, enabling access to back-end services and internal resources.
    When chained with CVE-2022-41082 (a remote code execution flaw), it enables full remote code
    execution on the target Exchange server. CVSS v3.1 score is 8.8.
  why: >-
    This vulnerability is significant because it provides the initial access stage of the
    ProxyNotShell attack chain against Microsoft Exchange Server, one of the most widely deployed
    enterprise email platforms. Although authentication is required, valid credentials are frequently
    obtained through phishing, credential stuffing, or prior breaches. The vulnerability was
    exploited in the wild as a zero-day before patches were available, and it was used by
    state-sponsored threat actors for espionage and data exfiltration operations.
  how: >-
    The attacker authenticates to the Exchange server with valid credentials, then sends a specially
    crafted request to the Autodiscover endpoint that triggers a server-side request forgery. This
    SSRF allows the attacker to reach back-end Exchange PowerShell endpoints that are not normally
    accessible from the internet. When combined with CVE-2022-41082, the attacker achieves remote
    code execution as SYSTEM. Mitigation includes applying Microsoft patches from the November 2022
    security update, implementing URL rewrite rules to block known exploit patterns on the
    Autodiscover endpoint, and disabling remote PowerShell access for non-administrative users.
  core_concepts:
    - key: "ProxyNotShell Attack Chain"
      value: "A two-vulnerability exploit chain in Exchange Server where SSRF (CVE-2022-41040) provides access to internal endpoints enabling RCE (CVE-2022-41082)"
    - key: "Authenticated SSRF"
      value: "Server-side request forgery requiring valid credentials but allowing access to otherwise protected internal Exchange services and PowerShell remoting"

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "VUL-AUTH-AUTHENTICA-001"
    description: "CVE-2022-41040 is an authentication bypass via SSRF that circumvents access controls to internal Exchange services"
  - type: "enables"
    target: "VUL-AUTH-PROXYSHELL-001"
    description: "ProxyNotShell follows the same proxy-based attack pattern as ProxyShell, targeting similar Exchange architecture weaknesses"
  - type: "precedes"
    target: "VUL-AUTH-PROXYLOGON-001"
    description: "ProxyNotShell is a successor to the ProxyLogon class of Exchange proxy exploitation vulnerabilities"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1190"
    tactic:
      - "Initial Access"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-11"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "MITRE CVE-2022-41040"
    - "NIST NVD CVE-2022-41040 (CVSS v3.1: 8.8)"
    - "Microsoft Security Response Center - Exchange SSRF Advisory"
    - "MITRE ATT&CK T1190 - Exploit Public-Facing Application"
    - "CISA KEV Catalog - CVE-2022-41040"
  search_keywords:
    - "CVE-2022-41040"
    - "ProxyNotShell"
    - "Exchange SSRF"
    - "Microsoft Exchange vulnerability"
    - "Exchange server-side request forgery"
    - "Autodiscover exploit"
    - "Exchange zero-day 2022"
  embedding_text: >-
    CVE-2022-41040 is a server-side request forgery vulnerability in Microsoft Exchange Server
    2013, 2016, and 2019, known as part of the ProxyNotShell attack chain, with CVSS v3.1
    score 8.8. An authenticated attacker exploits the Autodiscover endpoint to perform SSRF,
    gaining access to internal Exchange PowerShell services. When chained with CVE-2022-41082,
    it enables remote code execution as SYSTEM. Exploited as a zero-day by state-sponsored
    actors before patches were available. Mitigation includes applying November 2022 Microsoft
    security updates, implementing URL rewrite rules to block exploit patterns, and restricting
    remote PowerShell access. This vulnerability continues the pattern of Exchange proxy-based
    attacks following ProxyLogon and ProxyShell.
