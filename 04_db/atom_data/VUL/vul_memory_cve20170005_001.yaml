# GR Atom: CVE-2017-0005
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20170005-001"
  name: "CVE-2017-0005"
  normalized_name: "cve_2017_0005"
  aliases:
    - "Win32k GDI EoP"
    - "Windows GDI Elevation of Privilege"
    - "Zirconium Win32k Exploit"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - PRIV
    - OVERFLOW
    - WINDOWS
    - OS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L1", "L2"]
  target_zones: ["Z3", "Z4"]
  target_components:
    - "Windows GDI component (win32k.sys)"
    - "Windows 7 through Windows 10"
    - "Windows Server 2008 R2 through 2016"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2017-0005 is a privilege escalation vulnerability (CVSS 7.8) in the Windows
    Graphics Device Interface (GDI) component within the win32k.sys kernel driver. The
    vulnerability exists due to improper handling of objects in memory by the GDI
    component, allowing a locally authenticated attacker to execute code in kernel mode
    and escalate to SYSTEM privileges. It was patched by Microsoft in March 2017 as
    part of the MS17-013 security update. The vulnerability was reportedly exploited
    by the Zirconium (APT31) threat group in targeted espionage operations.
  why: >-
    CVE-2017-0005 represents another in the long series of Win32k/GDI kernel-mode
    vulnerabilities that APT groups consistently target for privilege escalation in
    Windows environments. Its exploitation by Zirconium (APT31) demonstrates how
    nation-state actors stockpile and deploy Windows kernel exploits for espionage
    campaigns. The GDI attack surface remains one of the most exploited kernel
    components in Windows security history.
  how: >-
    The exploit targets the GDI component in win32k.sys by manipulating specific GDI
    objects to trigger a memory corruption condition in kernel mode. An attacker who
    has already achieved local code execution through another vector (browser exploit,
    document exploit) uses the flaw to escape sandbox restrictions and elevate to SYSTEM
    level. The vulnerability is triggered by crafting specific GDI object operations
    that cause the kernel to mishandle memory, leading to arbitrary kernel-mode code
    execution.
  core_concepts:
    - key: "GDI Kernel Memory Corruption"
      value: "Improper GDI object handling in win32k.sys enables kernel-mode code execution from user-space"
    - key: "APT31 Zero-Day Usage"
      value: "Exploited by Zirconium/APT31 threat group for privilege escalation in targeted espionage operations"
    - key: "Win32k Attack Surface"
      value: "Part of the persistent pattern of Win32k kernel vulnerabilities exploited by nation-state actors"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "CVE-2017-0005 is a memory corruption vulnerability in the Windows GDI kernel component"
  - type: "enables"
    target: "VUL-MEMORY-CVE20167255-001"
    description: "Both are Win32k.sys privilege escalation vulnerabilities exploited by APT groups"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1068"
    tactic:
      - "Privilege Escalation"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-11"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Bulletin MS17-013"
    - "NVD Entry CVE-2017-0005 - CVSS 7.8"
    - "MITRE ATT&CK T1068 - Exploitation for Privilege Escalation"
    - "Microsoft Threat Intelligence - Zirconium/APT31 activity report"
  search_keywords:
    - "CVE-2017-0005"
    - "Win32k.sys"
    - "GDI"
    - "Windows kernel"
    - "privilege escalation"
    - "Zirconium"
    - "APT31"
    - "MS17-013"
  embedding_text: >-
    CVE-2017-0005 is a privilege escalation vulnerability in the Windows GDI component
    of win32k.sys with CVSS 7.8. The memory corruption flaw allows local attackers to
    execute code in kernel mode and escalate to SYSTEM privileges by manipulating GDI
    objects. Exploited by the Zirconium (APT31) threat group in targeted espionage
    campaigns, it was patched in MS17-013 in March 2017. The vulnerability continues
    the pattern of Win32k kernel attack surface exploitation by nation-state actors
    for privilege escalation in Windows environments.
