# GR Atom: CVE-2017-8570
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20178570-001"
  name: "CVE-2017-8570"
  normalized_name: "cve_2017_8570"
  aliases:
    - "Microsoft Office Composite Moniker RCE"
    - "Office OLE Object RCE"
    - "Sandworm CVE-2017-8570"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - INITIAL
    - WINDOWS
    - OVERFLOW

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z3", "Z4"]
  target_components:
    - "Microsoft Office OLE engine"
    - "Microsoft Office 2007-2016"
    - "Windows Composite Moniker"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2017-8570 is a remote code execution vulnerability (CVSS 7.8) in Microsoft Office
    caused by improper handling of OLE objects using the Composite Moniker. When a user opens
    a specially crafted Office document containing a malicious Composite Moniker-based OLE
    object (typically a .ppsx or .ppt file), arbitrary code execution occurs in the context
    of the current user. Patched by Microsoft in July 2017, the vulnerability was extensively
    exploited in the wild by multiple APT groups and commodity malware campaigns for delivering
    payloads via spear-phishing. It is closely related to CVE-2017-0199 (HTA handler) but
    uses a different OLE activation mechanism.
  why: >-
    CVE-2017-8570 is significant because it provides another reliable method for executing
    arbitrary code through Office documents without requiring macros. The Composite Moniker
    OLE object technique bypasses many security controls that block macro execution, making
    it an effective initial access vector. Its exploitation by both state-sponsored and
    commodity threat actors demonstrates the broad appeal of Office-based code execution
    vulnerabilities for social engineering campaigns.
  how: >-
    The exploit embeds a malicious Composite Moniker OLE object inside an Office document,
    typically a PowerPoint presentation (.ppsx). When the user opens or previews the file,
    Office processes the OLE object which triggers the Composite Moniker to instantiate a
    scriptlet (.sct) file. The scriptlet executes arbitrary commands through the Windows
    Script Host, downloading and executing the attacker's payload. The attack requires only
    that the victim open the document; no additional interaction like enabling macros is
    needed. Delivery is typically via spear-phishing email attachments.
  core_concepts:
    - key: "Composite Moniker Abuse"
      value: "Exploits Windows Composite Moniker OLE mechanism to instantiate scriptlet objects for code execution without macro activation"
    - key: "Macro-Free Exploitation"
      value: "Achieves code execution through OLE object processing without requiring the user to enable macros"
    - key: "Scriptlet Execution"
      value: "Leverages Windows Script Host through .sct scriptlet files to download and execute arbitrary payloads"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "CVE-2017-8570 exploits memory handling in Office OLE processing for code execution"
  - type: "enables"
    target: "VUL-MEMORY-CVE201711882-001"
    description: "Both provide macro-free Office document code execution vectors commonly chained in multi-stage campaigns"
  - type: "applies_to"
    target: "VUL-MEMORY-CVE20180802-001"
    description: "Both target Microsoft Office document processing components for initial access through spear-phishing"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1203"
    tactic:
      - "Execution"
      - "Initial Access"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Advisory CVE-2017-8570"
    - "MITRE ATT&CK T1203 - Exploitation for Client Execution"
    - "NVD Entry CVE-2017-8570 - CVSS 7.8"
    - "Unit 42 Research - Office OLE Exploitation Analysis"
  search_keywords:
    - "CVE-2017-8570"
    - "Composite Moniker"
    - "Office RCE"
    - "OLE object"
    - "PowerPoint exploit"
    - "scriptlet execution"
    - "macro-free exploit"
    - "spear-phishing"
  embedding_text: >-
    CVE-2017-8570 is a remote code execution vulnerability in Microsoft Office with CVSS 7.8
    caused by improper handling of Composite Moniker OLE objects. When a user opens a crafted
    Office document, typically a PowerPoint presentation, the malicious OLE object instantiates
    a scriptlet file through Windows Script Host for arbitrary code execution without requiring
    macros. Patched in July 2017, it was widely exploited by APT groups and commodity malware
    for spear-phishing initial access. The vulnerability provides a reliable macro-free code
    execution path through Office documents, bypassing security controls that block macro
    execution while requiring only that the victim open the document.
