# GR Atom: CVE-2018-8174
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20188174-001"
  name: "CVE-2018-8174"
  normalized_name: "cve_2018_8174"
  aliases:
    - "Double Kill"
    - "VBScript Engine Use-After-Free"
    - "Internet Explorer VBScript RCE"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - INITIAL
    - OVERFLOW
    - WINDOWS
    - WEB

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z3", "Z4"]
  target_components:
    - "Windows VBScript Engine (vbscript.dll)"
    - "Internet Explorer"
    - "Microsoft Office with embedded ActiveX"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2018-8174, dubbed "Double Kill," is a use-after-free vulnerability (CVSS 7.5) in
    the Windows VBScript engine that enables remote code execution through Internet Explorer
    or Office documents containing embedded VBScript content. Discovered as a zero-day being
    actively exploited in the wild in April 2018 by Qihoo 360, the vulnerability was
    weaponized by APT group DarkHotel and exploit kit operators. It affects all Windows
    versions supporting VBScript in IE and Office. Microsoft patched it in May 2018 and
    subsequently disabled VBScript in Internet Explorer for Internet and Restricted zones.
  why: >-
    Double Kill was significant because VBScript was a powerful attack vector accessible
    through both Internet Explorer and Office documents, giving attackers multiple delivery
    options. The vulnerability was rapidly integrated into exploit kits like RIG and used
    for both targeted attacks and mass exploitation campaigns. Its discovery accelerated
    Microsoft's decision to disable VBScript in Internet Explorer, eliminating a long-standing
    attack surface. The exploit was notable for its reliability and ease of weaponization.
  how: >-
    The exploit triggers a use-after-free in the VBScript engine by manipulating class
    objects and their destruction order. Crafted VBScript code embedded in a web page (via IE)
    or Office document (via ActiveX) creates objects, triggers garbage collection at a
    controlled point, then accesses freed memory. The attacker controls the reallocated
    memory content to achieve arbitrary read/write primitives, bypassing ASLR and DEP
    through information leak techniques. Code execution is achieved in the context of the
    browser or Office process. The exploit was delivered via both watering hole attacks
    through compromised websites and spear-phishing with Office documents.
  core_concepts:
    - key: "VBScript Use-After-Free"
      value: "Class object destruction order manipulation in VBScript engine creates use-after-free for arbitrary code execution"
    - key: "Dual Delivery Vector"
      value: "Exploitable through both Internet Explorer web browsing and Office documents containing embedded VBScript ActiveX"
    - key: "VBScript Deprecation Catalyst"
      value: "Exploitation accelerated Microsoft's decision to disable VBScript in IE for untrusted zones"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "CVE-2018-8174 is a use-after-free memory corruption vulnerability in Windows VBScript engine"
  - type: "enables"
    target: "VUL-MEMORY-CVE20200674-001"
    description: "CVE-2020-0674 is a later scripting engine use-after-free following similar exploitation patterns in JScript"
  - type: "enables"
    target: "VUL-MEMORY-CVE20201380-001"
    description: "Both are scripting engine use-after-free vulnerabilities in Internet Explorer enabling code execution"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1189"
    tactic:
      - "Initial Access"
      - "Execution"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Advisory CVE-2018-8174"
    - "Qihoo 360 - Double Kill VBScript Zero-Day Discovery"
    - "Kaspersky - CVE-2018-8174 Exploitation Analysis"
    - "NVD Entry CVE-2018-8174 - CVSS 7.5"
    - "MITRE ATT&CK T1189 - Drive-by Compromise"
  search_keywords:
    - "CVE-2018-8174"
    - "Double Kill"
    - "VBScript"
    - "use-after-free"
    - "Internet Explorer"
    - "DarkHotel"
    - "exploit kit"
    - "vbscript.dll"
  embedding_text: >-
    CVE-2018-8174, known as Double Kill, is a use-after-free vulnerability in the Windows
    VBScript engine with CVSS 7.5 enabling remote code execution through Internet Explorer
    or Office documents. Discovered as a zero-day in April 2018 by Qihoo 360, it was
    exploited by DarkHotel APT and RIG exploit kit. The flaw manipulates VBScript class
    object destruction to create a use-after-free condition, gaining arbitrary read/write
    primitives for code execution. Deliverable through both watering hole web attacks and
    spear-phishing with Office documents. Its exploitation accelerated Microsoft's decision
    to disable VBScript in Internet Explorer for untrusted security zones.
