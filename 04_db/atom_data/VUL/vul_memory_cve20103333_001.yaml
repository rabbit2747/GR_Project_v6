# GR Atom: CVE-2010-3333
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20103333-001"
  name: "CVE-2010-3333"
  normalized_name: "cve_2010_3333"
  aliases:
    - "Microsoft Word RTF Stack Buffer Overflow"
    - "MS10-087"
    - "Word pFragments Stack Overflow"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - OVERFLOW
    - WINDOWS
    - INITIAL

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L7"]
  target_zones: ["Z2", "Z3"]
  target_components:
    - "Microsoft Office Word 2002/2003/2007/2010"
    - "Microsoft Office for Mac 2011"
    - "RTF file parser"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2010-3333 (CVSS 9.3) is a critical stack buffer overflow vulnerability in Microsoft
    Word's RTF file parser. The vulnerability exists in the handling of the pFragments property
    in RTF documents, where a specially crafted value triggers a stack-based buffer overflow
    allowing arbitrary code execution. The vulnerability affects Microsoft Word 2002 through
    2010 and Office for Mac 2011. Extensively exploited in targeted spearphishing attacks.
    Patched in MS10-087 (November 2010).
  why: >-
    This vulnerability became one of the most widely exploited Office vulnerabilities for
    spearphishing campaigns, particularly by Chinese APT groups. RTF format exploitation was
    preferred because RTF files could be opened directly by Word without the Protected View
    sandbox that was introduced for other formats. The vulnerability remained actively exploited
    for years after the patch was released due to slow enterprise patching cycles.
  how: >-
    The vulnerability is triggered when Word parses an RTF document containing a malformed
    pFragments property with an oversized data value. The RTF parser copies the pFragments
    data onto the stack without proper bounds checking, overwriting the return address and
    enabling control of execution flow. Exploitation is straightforward using return-oriented
    programming (ROP) to bypass DEP. Delivered primarily through spearphishing emails with
    RTF document attachments targeting government and corporate organizations.
  core_concepts:
    - key: "RTF pFragments Stack Overflow"
      value: "Malformed pFragments property data in RTF documents overflows stack buffer in Word's RTF parser"
    - key: "Persistent Exploitation"
      value: "Remained actively exploited for years post-patch due to reliability and slow enterprise patching cycles"
    - key: "APT Spearphishing Weapon"
      value: "Widely adopted by Chinese APT groups as a preferred delivery mechanism for targeted intrusions"

# ==== Section 6: Relations ====
relations:
  - type: "supersedes"
    target: "VUL-MEMORY-CVE20093129-001"
    description: "Replaced Excel exploits as the preferred Office document exploitation vector for APT campaigns"
  - type: "precedes"
    target: "VUL-MEMORY-CVE20120158-001"
    description: "Office document memory corruption exploitation pattern continued with MSCOMCTL ListView exploit"
  - type: "applies_to"
    target: "INFRA-OS-WINDOWS-001"
    description: "Affects Microsoft Word on Windows platforms"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1203"
    tactic:
      - "Execution"
      - "Initial Access"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Bulletin MS10-087"
    - "CVE-2010-3333 - NIST NVD"
    - "MITRE ATT&CK T1203 - Exploitation for Client Execution"
  search_keywords:
    - "CVE-2010-3333"
    - "MS10-087"
    - "Word RTF overflow"
    - "pFragments vulnerability"
    - "RTF stack overflow"
    - "Office spearphishing"
    - "Word document exploit"
  embedding_text: >-
    CVE-2010-3333 is a critical stack buffer overflow (CVSS 9.3) in Microsoft Word RTF parsing
    (MS10-087). The pFragments property in RTF documents triggers a stack overflow when
    malformed data bypasses bounds checking. Affects Word 2002-2010 and Office for Mac 2011.
    Extensively exploited by Chinese APT groups in spearphishing campaigns, this vulnerability
    remained a preferred weapon for years due to its reliability and the lack of Protected View
    sandbox protection for RTF format documents. One of the most widely used Office exploits
    in targeted attack history.
