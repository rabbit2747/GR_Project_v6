# GR Atom: CVE-2021-40444
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE202140444-001"
  name: "CVE-2021-40444"
  normalized_name: "cve_2021_40444"
  aliases:
    - "MSHTML Remote Code Execution"
    - "Office MSHTML ActiveX RCE"
    - "CAB-less MSHTML Exploit"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - INITIAL
    - OVERFLOW
    - WINDOWS
    - WEB

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z3", "Z4"]
  target_components:
    - "Windows MSHTML (Trident) engine"
    - "Microsoft Office 2019/365"
    - "Internet Explorer ActiveX controls"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2021-40444 is a remote code execution vulnerability (CVSS 7.8) in the MSHTML
    (Trident) engine that allows attackers to execute arbitrary code through specially
    crafted Microsoft Office documents. Discovered being actively exploited as a zero-day
    in August 2021, the exploit embeds a malicious ActiveX control in an Office document
    that invokes the MSHTML engine to load remote content and execute code. Microsoft
    patched it in September 2021, but multiple bypass variants were subsequently discovered.
    The vulnerability was widely exploited by multiple threat actors including state-sponsored
    groups and ransomware operators.
  why: >-
    CVE-2021-40444 was significant because it provided reliable code execution through Office
    documents without requiring macros, which many organizations block. The MSHTML engine
    processes content silently when invoked through ActiveX controls in Office documents.
    Multiple exploit variants emerged after the initial patch, including CAB-less techniques
    that bypassed initial mitigations. The widespread exploitation by diverse threat actors
    from ransomware to espionage highlighted the persistent danger of MSHTML as an attack
    surface in Office documents.
  how: >-
    The original exploit embeds an ActiveX control in an Office document (typically .docx)
    that references a remote HTML file. When opened, Office invokes MSHTML to render the
    HTML, which downloads a CAB file containing a malicious DLL. The DLL is extracted and
    executed through a path traversal in the CAB extraction process. Later variants eliminated
    the CAB requirement, using alternative MSHTML features to achieve code execution. The
    Preview Pane in Windows Explorer could also trigger the vulnerability, making it
    exploitable without fully opening the document.
  core_concepts:
    - key: "MSHTML ActiveX Code Execution"
      value: "Office documents invoke MSHTML engine through ActiveX controls to load and execute remote malicious content"
    - key: "Macro-Free Office Exploitation"
      value: "Achieves code execution without macros, bypassing organizational macro blocking policies"
    - key: "Multiple Bypass Variants"
      value: "CAB-less and alternative MSHTML techniques emerged after initial patch, requiring multiple remediation rounds"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "CVE-2021-40444 exploits memory handling in MSHTML engine for code execution"
  - type: "enables"
    target: "VUL-MEMORY-CVE202126411-001"
    description: "Both exploit MSHTML engine vulnerabilities through crafted content for code execution"
  - type: "enables"
    target: "VUL-MEMORY-CVE201711882-001"
    description: "Both provide macro-free Office document code execution vectors for initial access"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1203"
    tactic:
      - "Execution"
      - "Initial Access"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Advisory CVE-2021-40444"
    - "MITRE ATT&CK T1203 - Exploitation for Client Execution"
    - "NVD Entry CVE-2021-40444 - CVSS 7.8"
    - "EXPMON - CVE-2021-40444 Zero-Day Discovery"
  search_keywords:
    - "CVE-2021-40444"
    - "MSHTML"
    - "ActiveX"
    - "Office RCE"
    - "Trident"
    - "CAB-less"
    - "macro-free"
    - "Office exploit"
  embedding_text: >-
    CVE-2021-40444 is a remote code execution vulnerability in the Windows MSHTML engine
    with CVSS 7.8 enabling code execution through crafted Office documents without macros.
    Discovered as an active zero-day in August 2021, the exploit embeds ActiveX controls
    that invoke MSHTML to load remote malicious content. The original technique used CAB
    file extraction path traversal; later variants eliminated this requirement. Exploitable
    through Preview Pane without fully opening documents. Widely exploited by ransomware
    operators and state-sponsored groups, multiple bypass variants required several
    remediation rounds. Patched in September 2021 by Microsoft.
