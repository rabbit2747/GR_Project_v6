# GR Atom: CVE-2021-1675
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20211675-001"
  name: "CVE-2021-1675"
  normalized_name: "cve_2021_1675"
  aliases:
    - "PrintNightmare (Original)"
    - "Windows Print Spooler EoP"
    - "Print Spooler RCE"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - PRIV
    - EXEC
    - OVERFLOW
    - WINDOWS
    - OS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L2", "L5"]
  target_zones: ["Z2", "Z3"]
  target_components:
    - "Windows Print Spooler service (spoolsv.exe)"
    - "All Windows versions"
    - "Windows Server domain controllers"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2021-1675, the original PrintNightmare vulnerability, is a remote code execution
    and privilege escalation vulnerability (CVSS 8.8) in the Windows Print Spooler service.
    Initially classified as a local privilege escalation and patched in June 2021, its severity
    was dramatically upgraded when researchers demonstrated it could be exploited remotely for
    code execution as SYSTEM on domain controllers. The vulnerability exists in the
    RpcAddPrinterDriverEx function which allows authenticated users to install printer drivers.
    It is closely related to CVE-2021-34527, which Microsoft assigned as a separate CVE for
    the remote code execution variant.
  why: >-
    PrintNightmare caused widespread panic because the Print Spooler service runs on virtually
    every Windows system including domain controllers, and the initial June 2021 patch was
    incomplete. The ability for any authenticated domain user to achieve SYSTEM-level code
    execution on domain controllers threatened the security of every Windows domain. The
    confused disclosure (accidental PoC publication) and incomplete patching created an
    extended window of exploitation. It led to widespread recommendations to disable Print
    Spooler on domain controllers.
  how: >-
    The exploit calls the RpcAddPrinterDriverEx function in the Print Spooler service,
    providing a path to a malicious DLL hosted on an attacker-controlled SMB share. The
    Print Spooler loads and executes the DLL as SYSTEM without proper privilege validation.
    Any authenticated domain user can invoke this function remotely, meaning a low-privileged
    domain account can achieve SYSTEM on domain controllers. The malicious driver DLL
    executes arbitrary code in the context of the Print Spooler service running as SYSTEM.
  core_concepts:
    - key: "Print Spooler Driver Loading"
      value: "RpcAddPrinterDriverEx allows authenticated users to load arbitrary DLLs as SYSTEM through printer driver installation"
    - key: "Domain Controller Compromise"
      value: "Any authenticated domain user can achieve SYSTEM on domain controllers running Print Spooler"
    - key: "Incomplete Patch Saga"
      value: "Initial patch was incomplete, accidental PoC publication created extended exploitation window"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "PrintNightmare exploits improper memory and access control handling in Print Spooler service"
  - type: "precedes"
    target: "VUL-MEMORY-CVE202134527-001"
    description: "CVE-2021-34527 was assigned as a separate CVE for the remote code execution variant of PrintNightmare"
  - type: "enables"
    target: "VUL-MEMORY-CVE20211732-001"
    description: "Both are Windows privilege escalation vulnerabilities exploited in 2021 attack campaigns"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1547.012"
    tactic:
      - "Privilege Escalation"
      - "Execution"
      - "Persistence"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Advisory CVE-2021-1675"
    - "CISA Alert AA21-189A - PrintNightmare"
    - "NVD Entry CVE-2021-1675 - CVSS 8.8"
    - "MITRE ATT&CK T1547.012 - Print Processors"
  search_keywords:
    - "CVE-2021-1675"
    - "PrintNightmare"
    - "Print Spooler"
    - "spoolsv.exe"
    - "RpcAddPrinterDriverEx"
    - "privilege escalation"
    - "domain controller"
    - "printer driver"
  embedding_text: >-
    CVE-2021-1675, the original PrintNightmare, is a remote code execution and privilege
    escalation vulnerability in Windows Print Spooler with CVSS 8.8. The
    RpcAddPrinterDriverEx function allows any authenticated domain user to load arbitrary
    DLLs as SYSTEM on domain controllers through printer driver installation. Initially
    patched as a local EoP in June 2021, severity was upgraded when remote RCE on domain
    controllers was demonstrated. The incomplete patch and accidental PoC publication created
    widespread exploitation. It affected virtually every Windows system and led to
    recommendations to disable Print Spooler on domain controllers. Closely related to
    CVE-2021-34527 which covers the remote code execution variant.
