# GR Atom: CVE-2018-0798
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20180798-001"
  name: "CVE-2018-0798"
  normalized_name: "cve_2018_0798"
  aliases:
    - "Equation Editor Memory Corruption"
    - "EQNEDT32 Heap Corruption"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - INITIAL
    - OVERFLOW
    - WINDOWS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z3", "Z4"]
  target_components:
    - "Microsoft Office Equation Editor (EQNEDT32.EXE)"
    - "Microsoft Office 2007-2016"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2018-0798 is a memory corruption vulnerability (CVSS 8.8) in the Microsoft Office
    Equation Editor component (EQNEDT32.EXE) that allows remote code execution through
    specially crafted Office documents. Unlike CVE-2017-11882 which was a stack overflow,
    this vulnerability involves a different memory corruption vector in the same legacy
    Equation Editor binary. Patched by Microsoft in January 2018, it was discovered as
    part of the broader scrutiny of EQNEDT32.EXE following the disclosure of CVE-2017-11882.
    The vulnerability was exploited in the wild by multiple threat actors targeting the
    same unprotected legacy binary.
  why: >-
    CVE-2018-0798 demonstrates that the legacy Equation Editor component harbored multiple
    exploitable vulnerabilities beyond CVE-2017-11882. The same lack of ASLR and DEP
    protections made this vulnerability equally reliable to exploit. Its discovery reinforced
    the decision to remove Equation Editor entirely from Office, highlighting how legacy
    components can contain numerous undiscovered vulnerabilities that compound security risk.
  how: >-
    The vulnerability is triggered by processing a malicious equation object in a crafted
    Office document. The Equation Editor binary mishandles matrix record parsing, causing
    memory corruption through an out-of-bounds write. Because EQNEDT32.EXE lacks modern
    exploit mitigations, the memory corruption can be reliably weaponized for code execution.
    Attack delivery mirrors CVE-2017-11882, using spear-phishing emails with malicious Office
    document attachments that invoke the vulnerable Equation Editor component upon opening.
  core_concepts:
    - key: "Matrix Record Corruption"
      value: "Memory corruption through improper handling of matrix record structures in the Equation Editor binary"
    - key: "Multiple Vulnerabilities in Legacy Component"
      value: "Second critical vulnerability in the same EQNEDT32.EXE binary discovered after CVE-2017-11882"
    - key: "Unprotected Binary Exploitation"
      value: "Reliable exploitation enabled by absence of ASLR, DEP, and stack canaries in the legacy component"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "CVE-2018-0798 is a memory corruption vulnerability in Office Equation Editor"
  - type: "enables"
    target: "VUL-MEMORY-CVE201711882-001"
    description: "Both exploit the same vulnerable EQNEDT32.EXE binary using different memory corruption vectors"
  - type: "precedes"
    target: "VUL-MEMORY-CVE20180802-001"
    description: "CVE-2018-0802 was patched alongside CVE-2018-0798 as part of the same Equation Editor security update"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1203"
    tactic:
      - "Execution"
      - "Initial Access"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Advisory CVE-2018-0798"
    - "MITRE ATT&CK T1203 - Exploitation for Client Execution"
    - "NVD Entry CVE-2018-0798 - CVSS 8.8"
    - "Check Point Research - Equation Editor Analysis"
  search_keywords:
    - "CVE-2018-0798"
    - "Equation Editor"
    - "EQNEDT32"
    - "Office memory corruption"
    - "matrix record"
    - "legacy component"
    - "Office RCE"
  embedding_text: >-
    CVE-2018-0798 is a memory corruption vulnerability in Microsoft Office Equation Editor
    EQNEDT32.EXE with CVSS 8.8 enabling remote code execution through crafted Office
    documents. It involves a different memory corruption vector than CVE-2017-11882 in the
    same legacy binary, specifically through improper matrix record parsing causing
    out-of-bounds writes. The same absence of ASLR and DEP protections makes exploitation
    highly reliable. Discovered during broader scrutiny of the Equation Editor following
    CVE-2017-11882, it was patched in January 2018 and contributed to Microsoft's decision
    to remove Equation Editor entirely from Office.
