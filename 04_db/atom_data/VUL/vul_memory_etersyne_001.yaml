# GR Atom: EternalSynergy
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-ETERSYNE-001"
  name: "EternalSynergy"
  normalized_name: "eternal_synergy"
  aliases:
    - "CVE-2017-0143"
    - "SMBv1 Transaction Validation Bypass"
    - "Shadow Brokers SMB Synergy Exploit"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - INITIAL
    - LATERAL
    - OVERFLOW
    - WINDOWS
    - NETWORK
    - SMB

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L4", "L5"]
  target_zones: ["Z1", "Z2", "Z3"]
  target_components:
    - "Windows SMBv1 server (srv.sys)"
    - "Windows Vista through Windows Server 2016"
    - "Microsoft Server Message Block 1.0 (port 445)"

# ==== Section 5: Definition ====
definition:
  what: >-
    EternalSynergy is a remote code execution exploit (CVSS 8.1, CVE-2017-0143) targeting
    a vulnerability in Microsoft's SMBv1 protocol implementation related to improper
    validation of SMB transaction structures. Part of the NSA's Equation Group toolkit
    leaked by the Shadow Brokers in April 2017, EternalSynergy exploits differences in
    how the SMBv1 server validates and processes certain transaction requests to achieve
    kernel-mode code execution. The exploit combines elements of both buffer overflow and
    type confusion techniques, providing yet another independent exploitation path for
    SMBv1 targets. Patched in MS17-010 alongside EternalBlue and EternalRomance.
  why: >-
    EternalSynergy completes the trio of major Eternal-family SMBv1 exploits (alongside
    EternalBlue and EternalRomance), demonstrating the remarkable depth of the NSA's
    offensive capability against a single protocol. Having three independent exploit
    paths for SMBv1 meant that partial patching or version-specific mitigations could
    be bypassed by switching to a different Eternal variant. This redundancy was
    reflected in real-world malware that incorporated multiple Eternal exploits to
    maximize the range of exploitable targets.
  how: >-
    EternalSynergy targets transaction request validation in the SMBv1 server by sending
    crafted transaction structures that exploit validation weaknesses in srv.sys. The
    exploit manipulates the relationship between transaction request parameters and
    the server's internal processing of those transactions to achieve out-of-bounds
    memory access in kernel space. By combining buffer manipulation with transaction
    structure abuse, the attacker gains kernel memory read/write primitives that are
    leveraged for arbitrary code execution as SYSTEM. The exploit targets different
    code paths than EternalBlue or EternalRomance, providing distinct reliability
    characteristics across Windows versions.
  core_concepts:
    - key: "SMBv1 Transaction Validation Bypass"
      value: "Exploits transaction request validation weaknesses for out-of-bounds kernel memory access"
    - key: "Eternal Exploit Trio"
      value: "Third independent SMBv1 exploitation path alongside EternalBlue and EternalRomance"
    - key: "Exploit Redundancy"
      value: "Multiple independent paths ensure maximum target coverage across Windows versions and configurations"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "EternalSynergy is a memory corruption in Windows SMBv1 transaction handling"
  - type: "alternative_to"
    target: "VUL-MEMORY-ETERBLUE-001"
    description: "Third independent SMBv1 exploitation path alongside EternalBlue"
  - type: "alternative_to"
    target: "VUL-MEMORY-ETERROMA-001"
    description: "Alternative SMBv1 exploit targeting different transaction validation weaknesses"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1210"
    tactic:
      - "Lateral Movement"
      - "Initial Access"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-11"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Bulletin MS17-010"
    - "NVD Entry CVE-2017-0143 - CVSS 8.1"
    - "Shadow Brokers Leak - EternalSynergy exploit"
    - "MITRE ATT&CK T1210 - Exploitation of Remote Services"
  search_keywords:
    - "EternalSynergy"
    - "CVE-2017-0143"
    - "SMBv1"
    - "Shadow Brokers"
    - "NSA"
    - "MS17-010"
    - "transaction validation"
    - "lateral movement"
  embedding_text: >-
    EternalSynergy is a remote code execution exploit targeting CVE-2017-0143 in Windows
    SMBv1, the third major Eternal-family exploit from the Shadow Brokers NSA tool leak.
    It exploits transaction request validation weaknesses in srv.sys for kernel-mode code
    execution via a different path than EternalBlue (buffer overflow) or EternalRomance
    (type confusion). Part of the MS17-010 patch, the three Eternal exploits demonstrate
    the NSA's depth of offensive capability against SMBv1, providing redundant exploitation
    paths for maximum target coverage across Windows versions.
