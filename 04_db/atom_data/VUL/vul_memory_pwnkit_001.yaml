# GR Atom: PwnKit
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-PWNKIT-001"
  name: "PwnKit"
  normalized_name: "pwnkit"
  aliases:
    - "CVE-2021-4034"
    - "Polkit pkexec Privilege Escalation"
    - "pkexec argc Zero Exploit"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - PRIV
    - EXEC
    - OVERFLOW
    - LINUX
    - OS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L1", "L2"]
  target_zones: ["Z3", "Z4"]
  target_components:
    - "Polkit pkexec (all versions since 2009)"
    - "All major Linux distributions"
    - "SUID root binary (/usr/bin/pkexec)"

# ==== Section 5: Definition ====
definition:
  what: >-
    PwnKit (CVE-2021-4034, CVSS 7.8) is a memory corruption vulnerability in Polkit's
    pkexec component that allows any unprivileged local user to gain full root privileges
    on virtually every Linux distribution. The vulnerability is an out-of-bounds write
    triggered when pkexec is invoked with zero command-line arguments (argc=0). Since
    pkexec is installed as a SUID-root binary on all major Linux distributions including
    Ubuntu, Debian, Fedora, and CentOS, exploitation provides immediate root access on
    nearly any Linux system. The vulnerability existed for over 12 years since pkexec's
    initial commit in May 2009. Discovered by Qualys and disclosed in January 2022, public
    exploits are trivially reliable. See also CVE-2021-4034 (VUL-MEMORY-CVE20214034-001).
  why: >-
    PwnKit provides the most universally reliable Linux root escalation technique
    available. With SUID-root pkexec installed by default on all major distributions for
    over 12 years, the vulnerability affected virtually every Linux installation worldwide.
    The trivial exploitation (single binary execution) and 100% reliability made it
    immediately adopted by penetration testers and threat actors alike. It demonstrated
    how long-standing memory safety bugs in fundamental system utilities can persist
    undetected and affect the global Linux ecosystem. PwnKit effectively replaced Dirty
    COW as the default Linux privilege escalation tool.
  how: >-
    The exploit invokes pkexec with argc=0 (zero arguments) using execve(). When pkexec
    processes an empty argv, it reads argv[1] from out-of-bounds memory, which corresponds
    to the first environment variable (envp[0]). Through careful manipulation of
    environment variables, the attacker causes pkexec to write an attacker-controlled
    value to an out-of-bounds position that overwrites the first environment variable.
    This is used to inject a GCONV_PATH or LD_PRELOAD environment variable that causes
    pkexec to load an attacker-controlled shared library with root privileges, achieving
    arbitrary code execution as root. The entire attack executes in a single step with
    no race conditions or timing dependencies.
  core_concepts:
    - key: "argc Zero Out-of-Bounds Write"
      value: "Invoking pkexec with argc=0 causes out-of-bounds read/write in argv/envp memory enabling environment injection"
    - key: "Universal Linux Root Access"
      value: "SUID-root pkexec on all major Linux distributions for 12 years provides trivially reliable root escalation"
    - key: "Environment Variable Injection"
      value: "Out-of-bounds write overwrites envp to inject GCONV_PATH/LD_PRELOAD for shared library loading as root"

# ==== Section 6: Relations ====
relations:
  - type: "instance_of"
    target: "VUL-MEMORY-MEMORY-001"
    description: "PwnKit is an out-of-bounds write memory corruption in the Polkit pkexec SUID binary"
  - type: "supersedes"
    target: "VUL-MEMORY-DIRTCOW-001"
    description: "PwnKit replaced Dirty COW as the go-to Linux privilege escalation due to higher reliability"
  - type: "enables"
    target: "VUL-MEMORY-DIRTPIPE-001"
    description: "Both are trivially reliable Linux privilege escalation vulnerabilities discovered in 2022"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1068"
    tactic:
      - "Privilege Escalation"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-11"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Qualys Security Advisory - PwnKit: Local Privilege Escalation in Polkit pkexec"
    - "NVD Entry CVE-2021-4034 - CVSS 7.8"
    - "MITRE ATT&CK T1068 - Exploitation for Privilege Escalation"
    - "Polkit Security Advisory CVE-2021-4034"
  search_keywords:
    - "PwnKit"
    - "CVE-2021-4034"
    - "pkexec"
    - "Polkit"
    - "Linux privilege escalation"
    - "root exploit"
    - "SUID"
    - "out-of-bounds write"
    - "argc zero"
  embedding_text: >-
    PwnKit (CVE-2021-4034, CVSS 7.8) is a memory corruption vulnerability in Polkit
    pkexec allowing any unprivileged local user to gain root on virtually every Linux
    distribution. The 12-year-old out-of-bounds write triggered by argc=0 enables
    environment variable injection (GCONV_PATH/LD_PRELOAD) to load attacker-controlled
    shared libraries as root. SUID-root pkexec installed by default on all major
    distributions makes exploitation trivially reliable. Discovered by Qualys in January
    2022, PwnKit replaced Dirty COW as the default Linux privilege escalation technique
    due to its universal applicability and deterministic exploitation.
