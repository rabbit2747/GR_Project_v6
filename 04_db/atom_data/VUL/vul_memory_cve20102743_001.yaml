# GR Atom: CVE-2010-2743
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20102743-001"
  name: "CVE-2010-2743"
  normalized_name: "cve_2010_2743"
  aliases:
    - "Windows Kernel Keyboard Layout Vulnerability"
    - "MS10-073"
    - "win32k.sys Keyboard Layout Privilege Escalation"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - PRIV
    - OVERFLOW
    - WINDOWS
    - OS

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L1", "L2"]
  target_zones: ["Z3"]
  target_components:
    - "Microsoft Windows win32k.sys"
    - "Windows XP"
    - "Windows Server 2003"
    - "Windows kernel keyboard layout handling"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2010-2743 (CVSS 7.2) is a privilege escalation vulnerability in the Windows kernel-mode
    driver win32k.sys that occurs when processing keyboard layout files. The vulnerability allows
    a local attacker to execute arbitrary code in kernel mode by loading a specially crafted
    keyboard layout file that triggers a buffer overflow in the kernel. Most notably used by
    the Stuxnet worm as one of its privilege escalation mechanisms. Patched in MS10-073
    (October 2010).
  why: >-
    This vulnerability was one of four zero-day exploits used by Stuxnet, specifically for
    privilege escalation after initial infection via the LNK vulnerability. The exploitation
    of keyboard layout parsing in the kernel demonstrated the broad attack surface of Windows
    kernel input handling subsystems. Combined with CVE-2010-2568, it provided Stuxnet with
    a complete exploit chain from initial access to SYSTEM-level execution.
  how: >-
    The vulnerability exists in how win32k.sys processes keyboard layout files loaded via the
    LoadKeyboardLayout API. A specially crafted keyboard layout file contains malformed data
    that triggers a buffer overflow when parsed by the kernel driver. Stuxnet exploited this
    by dropping a malicious keyboard layout file and loading it through standard Windows APIs,
    escalating from user-level to SYSTEM privileges. The kernel-mode code execution enables
    full system compromise and the ability to install rootkit components.
  core_concepts:
    - key: "Keyboard Layout Kernel Overflow"
      value: "Malformed keyboard layout file causes buffer overflow in win32k.sys during kernel-mode parsing"
    - key: "Stuxnet Privilege Escalation"
      value: "Used by Stuxnet to escalate from user to SYSTEM privileges as part of the multi-exploit attack chain"
    - key: "win32k.sys Attack Surface"
      value: "Windows kernel input handling subsystem provides attack surface for local privilege escalation"

# ==== Section 6: Relations ====
relations:
  - type: "requires"
    target: "VUL-MEMORY-CVE20102568-001"
    description: "Used in combination with the Stuxnet LNK exploit; LNK provides initial access, this CVE provides privilege escalation"
  - type: "is_a"
    target: "VUL-MEMORY-CVE20081084-001"
    description: "Both are win32k.sys kernel privilege escalation vulnerabilities exploiting input processing"
  - type: "applies_to"
    target: "INFRA-OS-WINDOWS-001"
    description: "Affects Windows XP and Server 2003 kernel"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1068"
    tactic:
      - "Privilege Escalation"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Bulletin MS10-073"
    - "CVE-2010-2743 - NIST NVD"
    - "Symantec - W32.Stuxnet Dossier"
    - "MITRE ATT&CK T1068 - Exploitation for Privilege Escalation"
  search_keywords:
    - "CVE-2010-2743"
    - "MS10-073"
    - "win32k.sys keyboard layout"
    - "Stuxnet privilege escalation"
    - "kernel keyboard layout overflow"
    - "Windows kernel escalation"
    - "LoadKeyboardLayout exploit"
  embedding_text: >-
    CVE-2010-2743 is a privilege escalation vulnerability (CVSS 7.2) in Windows win32k.sys
    keyboard layout handling (MS10-073). A specially crafted keyboard layout file triggers a
    kernel buffer overflow enabling SYSTEM-level code execution. Used by Stuxnet as a privilege
    escalation component alongside the LNK exploit (CVE-2010-2568) to form a complete attack
    chain from initial access to kernel-level control. Affects Windows XP and Server 2003.
    Demonstrates the broad kernel attack surface in Windows input handling subsystems.
