# GR Atom: CVE-2004-0200
# Schema: atom_schema.yaml v5.1
# Status: enriched

# ==== Section 1: Identity ====
identity:
  id: "VUL-MEMORY-CVE20040200-001"
  name: "CVE-2004-0200"
  normalized_name: "cve_2004_0200"
  aliases:
    - "GDI+ JPEG Parsing Vulnerability"
    - "MS04-028"
    - "JPEG GDI+ Buffer Overrun"

# ==== Section 2: Classification ====
classification:
  is_infrastructure: false
  type: "vulnerability"
  abstraction_level: 1
  atom_tags:
    - EXEC
    - OVERFLOW
    - WINDOWS
    - INITIAL

# ==== Section 4: Scope (non-INFRA only) ====
scope:
  target_layers: ["L6", "L7"]
  target_zones: ["Z2", "Z3"]
  target_components:
    - "Microsoft Windows GDI+"
    - "Microsoft Office 2003"
    - "Microsoft Internet Explorer 6"
    - "Microsoft .NET Framework"

# ==== Section 5: Definition ====
definition:
  what: >-
    CVE-2004-0200 (CVSS 9.3) is a critical buffer overflow vulnerability in the Microsoft Windows
    GDI+ library (gdiplus.dll) that occurs when parsing maliciously crafted JPEG images. The
    vulnerability affects a wide range of Microsoft products including Windows XP, Server 2003,
    Office 2003, Internet Explorer 6, and the .NET Framework. An attacker could craft a JPEG
    image that, when rendered by any GDI+ consuming application, triggers arbitrary code execution
    with the privileges of the user running the application. Patched in MS04-028 (September 2004).
  why: >-
    This vulnerability was significant because GDI+ is a shared graphics rendering component used
    across virtually all Microsoft products. A single vulnerability in this library exposed every
    application that processed JPEG images to remote code execution. The ubiquity of JPEG images
    on the web and in email made exploitation trivial via social engineering. The vulnerability
    demonstrated the systemic risk of shared library vulnerabilities in operating systems.
  how: >-
    The vulnerability exists in the GDI+ JPEG parsing code where a specially crafted JPEG image
    with malformed header fields triggers a heap-based buffer overflow. When GDI+ attempts to
    decompress the image data, it allocates an insufficient buffer based on manipulated image
    dimensions, then writes decompressed data beyond the buffer boundary. Exploitation involves
    embedding the malicious JPEG in a webpage, email, or Office document. When the victim opens
    or previews the content, the overflow allows arbitrary code execution in the context of the
    current user process.
  core_concepts:
    - key: "GDI+ Shared Library"
      value: "Windows graphics rendering component used by all Microsoft products, making a single vulnerability universally exploitable"
    - key: "JPEG Heap Buffer Overflow"
      value: "Malformed JPEG header causes insufficient heap allocation followed by out-of-bounds write during image decompression"
    - key: "Ubiquitous Attack Surface"
      value: "Any application rendering JPEG images through GDI+ was vulnerable, including browsers, email clients, and Office suite"

# ==== Section 6: Relations ====
relations:
  - type: "is_a"
    target: "VUL-MEMORY-CVE20040597-001"
    description: "Both are 2004-era image parsing buffer overflow vulnerabilities exploitable via crafted image files"
  - type: "enables"
    target: "VUL-MEMORY-CVE20093129-001"
    description: "Established the pattern of Office document memory corruption exploitation continued by later Office CVEs"
  - type: "applies_to"
    target: "INFRA-OS-WINDOWS-001"
    description: "Affects Windows XP and Server 2003 GDI+ graphics subsystem"

# ==== Section 7: Security Profile ====
security_profile:
  mitre_mapping:
    technique_id: "T1203"
    tactic:
      - "Execution"
      - "Initial Access"

# ==== Section 8: Metadata ====
metadata:
  created: "2026-02-06"
  updated: "2026-02-10"
  version: "1.0"
  confidence: "high"
  trust_source: "authoritative"
  sources:
    - "Microsoft Security Bulletin MS04-028"
    - "CVE-2004-0200 - NIST NVD"
    - "MITRE ATT&CK T1203 - Exploitation for Client Execution"
  search_keywords:
    - "CVE-2004-0200"
    - "MS04-028"
    - "GDI+ JPEG vulnerability"
    - "JPEG buffer overflow"
    - "gdiplus.dll"
    - "Windows image parsing"
    - "JPEG heap overflow"
  embedding_text: >-
    CVE-2004-0200 is a critical buffer overflow in Microsoft Windows GDI+ JPEG image parsing
    (MS04-028, CVSS 9.3). The vulnerability in gdiplus.dll affects Windows XP, Server 2003,
    Office 2003, IE 6, and .NET Framework. A malformed JPEG image with crafted header fields
    causes a heap buffer overflow during decompression, enabling arbitrary code execution.
    The shared nature of GDI+ across all Microsoft products created a massive attack surface
    where any application rendering JPEG images was exploitable. Exploitation via web pages,
    email attachments, and Office documents made this vulnerability highly impactful in 2004.
