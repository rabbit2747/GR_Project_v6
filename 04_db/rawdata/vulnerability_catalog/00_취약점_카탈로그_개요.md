# GR Framework 취약점 카탈로그 v1.1

> **목적**: GR Framework에서 관리하는 취약점 분류 체계와 카탈로그 문서
> **역할**: 분류 엔진(Engine B)의 **지식 베이스(Knowledge Base)**

---

## 1. 문서 구조

```
05_Vulnerability_Catalog/
├── 00_취약점_카탈로그_개요.md     (본 문서)
├── 01_CWE_카탈로그.md            CWE Top 25 + 주요 약점
├── 02_OWASP_Top10_2021.md        OWASP Top 10 2021
├── 03_Named_Vulnerabilities.md   유명 취약점 (Log4Shell 등)
├── 04_CVE_GR_매핑_가이드.md      CVE-GR 좌표 매핑 규칙 (AI 프롬프트용)
└── 05_취약점_분류_기준.md        AI 분류 엔진 기준 (시스템 프롬프트)
```

---

## 2. 카탈로그 ↔ DB 스키마 연결

### 2.1 ER 다이어그램

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        취약점 카탈로그 DB 스키마 관계도                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────┐         ┌─────────────────┐                          │
│   │  owasp_versions │◄────────│   owasp_top10   │                          │
│   │  (버전 관리)     │   1:N   │  (A01~A10)      │                          │
│   └─────────────────┘         └────────┬────────┘                          │
│                                        │ mapped_cwes[]                     │
│                                        ▼                                   │
│   ┌─────────────────┐         ┌─────────────────┐         ┌─────────────┐ │
│   │  cwe_categories │◄────────│       cwe       │────────►│ cwe_gr_     │ │
│   │  (카테고리)      │   N:1   │  (CWE-79 등)    │   1:N   │ mapping     │ │
│   └─────────────────┘         └────────┬────────┘         └──────┬──────┘ │
│                                        │ 1:N                     │        │
│                                        ▼                         │        │
│                               ┌─────────────────┐                │        │
│                               │       cve       │                │        │
│                               │ (CVE-2021-xxxx) │                │        │
│                               └────────┬────────┘                │        │
│                                   │    │    │                    │        │
│                            ┌──────┘    │    └──────┐             │        │
│                            ▼           ▼           ▼             ▼        │
│                    ┌────────────┐ ┌─────────┐ ┌─────────────────────────┐ │
│                    │cve_gr_     │ │cve_named│ │    GR 좌표 테이블        │ │
│                    │mapping     │ │_vuln    │ │  ┌─────────────────┐    │ │
│                    └────────────┘ └────┬────┘ │  │ deployment_layer│    │ │
│                                        │      │  ├─────────────────┤    │ │
│                                        ▼      │  │  security_zone  │    │ │
│                               ┌───────────────┐  ├─────────────────┤    │ │
│                               │    named_     │  │  function_tag   │    │ │
│                               │vulnerabilities│  └─────────────────┘    │ │
│                               │ (Log4Shell)   │                         │ │
│                               └───────┬───────┘                         │ │
│                                       │ 1:N                             │ │
│                                       ▼                                 │ │
│                               ┌───────────────┐                         │ │
│                               │named_vuln_    │─────────────────────────┘ │
│                               │gr_mapping     │                           │
│                               └───────────────┘                           │
│                                                                           │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 테이블-필드 요약

| 테이블 | 주요 필드 | FK 연결 | 설명 |
|--------|----------|---------|------|
| **owasp_top10** | id, rank, name, mapped_cwes[] | → owasp_versions | OWASP Top 10 항목 |
| **cwe** | id, name, name_ko, abstraction | → cwe_categories | CWE 약점 정의 |
| **cve** | id, cwe_id, cvss_score | → cwe | CVE 취약점 인스턴스 |
| **named_vulnerabilities** | name, primary_cve_id, cwe_id | → cve, cwe | 유명 취약점 |
| **cwe_gr_mapping** | cwe_id, layer_id, zone_id, tag_id | → 각 차원 테이블 | CWE-GR 좌표 매핑 |
| **cve_gr_mapping** | cve_id, layer_id, zone_id, tag_id | → 각 차원 테이블 | CVE-GR 좌표 매핑 |
| **owasp_gr_mapping** | owasp_id, layer_id, zone_id, tag_id | → 각 차원 테이블 | OWASP-GR 좌표 매핑 |

> 📌 **스키마 상세**: [02_vulnerability_extension_schema.sql](../04_Database_Schema/02_vulnerability_extension_schema.sql) 참조

---

## 3. 취약점 분류 체계

### 3.1 3-Tier 취약점 분류

```
┌─────────────────────────────────────────────────────────────┐
│                    취약점 분류 체계                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Tier 1: CWE (Common Weakness Enumeration)                  │
│  ├── 근본 원인 분류 (약점 유형)                              │
│  ├── 예: CWE-79 (XSS), CWE-89 (SQL Injection)               │
│  └── ~1000+ 개 약점 유형                                    │
│                                                             │
│  Tier 2: OWASP Top 10                                       │
│  ├── 웹 애플리케이션 주요 위험                               │
│  ├── 예: A01 (Broken Access Control), A03 (Injection)       │
│  └── 10개 카테고리 (3~4년 주기 갱신)                        │
│                                                             │
│  Tier 3: CVE (Common Vulnerabilities and Exposures)         │
│  ├── 실제 취약점 인스턴스                                   │
│  ├── 예: CVE-2021-44228 (Log4Shell)                         │
│  └── ~20만+ 개 취약점                                       │
│                                                             │
│  + Named Vulnerabilities (유명 취약점)                       │
│  ├── 대중적으로 알려진 중대 취약점                          │
│  └── 예: Log4Shell, Heartbleed, Shellshock                 │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 GR 좌표 매핑

모든 취약점은 GR Framework의 3차원 좌표에 매핑됩니다:

| 차원 | 설명 | 예시 |
|------|------|------|
| **Layer** | 배포 계층 | L7 (Application), L5 (Data), L3 (Compute) |
| **Zone** | 보안 영역 | Zone_1 (Perimeter), Zone_2 (Application) |
| **Tag** | 기능 태그 | S1.1 (Firewall), S7.1 (SAST), A3.1 (Input Validation) |

---

## 4. 취약점 관계도

```
                    ┌───────────────┐
                    │   OWASP Top 10 │
                    │   (A01~A10)    │
                    └───────┬───────┘
                            │ 1:N
                            ▼
┌───────────────────────────────────────────────────────┐
│                         CWE                            │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  │
│  │ CWE-79  │  │ CWE-89  │  │ CWE-502 │  │ CWE-787 │  │
│  │  (XSS)  │  │(SQLi)   │  │(Deser)  │  │(OOB Wr) │  │
│  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘  │
└───────┼────────────┼────────────┼────────────┼───────┘
        │            │            │            │
        │            │            │            │
        ▼            ▼            ▼            ▼
┌───────────────────────────────────────────────────────┐
│                         CVE                            │
│  CVE-2024-xxxxx  CVE-2023-xxxxx  CVE-2021-44228  ...  │
└───────────────────────────────────────────────────────┘
        │
        │ (유명한 경우)
        ▼
┌───────────────────────────────────────────────────────┐
│                  Named Vulnerabilities                 │
│  Log4Shell  Heartbleed  Shellshock  EternalBlue  ...  │
└───────────────────────────────────────────────────────┘
```

---

## 5. GR 좌표 매핑 예시

### 5.1 SQL Injection (CWE-89)

| GR 좌표 | 값 | 설명 |
|---------|-----|------|
| **Layer** | L7 (Application) | 애플리케이션 계층에서 발생 |
| **Zone** | Zone_2 (Application) | 애플리케이션 영역 |
| **Primary Tag** | A3.1 (Input Validation) | 입력 처리 관련 |
| **Detection Tags** | M1.2 (Log Analytics), S5.1 (SIEM) | 탐지 가능한 기능 |
| **Mitigation Tags** | S7.1 (SAST), D2.1 (Query Parameterization) | 완화 가능한 기능 |

### 5.2 Log4Shell (CVE-2021-44228)

| GR 좌표 | 값 | 설명 |
|---------|-----|------|
| **Layer** | L7, L4, L6 | Application, Platform, Runtime |
| **Zone** | Zone_2, Zone_3 | Application, Data 영역 |
| **Primary Tag** | A1.3 (Logging Framework) | 로깅 프레임워크 |
| **CWE** | CWE-502 (Deserialization) | 역직렬화 취약점 |
| **OWASP** | A08:2021 | Software and Data Integrity Failures |

---

## 6. 분류 엔진(Engine B) 연동

### 6.1 카탈로그의 역할

이 카탈로그는 단순한 정보 모음이 아니라, **분류 엔진(Engine B)의 지식 베이스**로 작동합니다:

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    Engine B 지식 베이스 활용 구조                         │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────────┐                                                   │
│  │   취약점 입력     │  NVD, GitHub Advisory, 보안 공지 등               │
│  └────────┬─────────┘                                                   │
│           │                                                             │
│           ▼                                                             │
│  ┌──────────────────┐     ┌─────────────────────────────────────────┐  │
│  │   Intake Router  │     │         📚 지식 베이스 (본 카탈로그)      │  │
│  │   (Track A/B/C)  │     │  ┌───────────────────────────────────┐  │  │
│  └────────┬─────────┘     │  │ • CWE 정의 + GR 매핑 규칙         │  │  │
│           │               │  │ • OWASP 카테고리 + GR 매핑        │  │  │
│           ▼               │  │ • Named Vuln 패턴 + GR 매핑       │  │  │
│  ┌──────────────────┐     │  │ • CVE-GR 매핑 가이드 (규칙)       │  │  │
│  │  Format Parser   │     │  │ • 분류 기준 (시스템 프롬프트)      │  │  │
│  └────────┬─────────┘     │  └───────────────────────────────────┘  │  │
│           │               └──────────────────┬──────────────────────┘  │
│           ▼                                  │                         │
│  ┌──────────────────┐                        │ 참조                    │
│  │  AI Structurer   │◄───────────────────────┤                         │
│  │ (비정형→정형)     │                        │                         │
│  └────────┬─────────┘                        │                         │
│           │                                  │                         │
│           ▼                                  ▼                         │
│  ┌──────────────────┐     ┌─────────────────────────────────────────┐  │
│  │  AI Classifier   │◄────│  시스템 프롬프트: 05_취약점_분류_기준.md │  │
│  │  (GR 좌표 분류)   │     │  Few-shot 예시: 01~03 카탈로그 매핑     │  │
│  └────────┬─────────┘     └─────────────────────────────────────────┘  │
│           │                                                             │
│           ▼                                                             │
│  ┌──────────────────────────────────────────┐                          │
│  │  vulnerability_classification_log (저장)  │                          │
│  │  • assigned_layer, assigned_zone         │                          │
│  │  • assigned_tags[], confidence_score     │                          │
│  └──────────────────────────────────────────┘                          │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 6.2 지식 베이스 활용 방식

| 컴포넌트 | 참조 문서 | 활용 방식 |
|----------|----------|-----------|
| **AI Classifier** | `05_취약점_분류_기준.md` | 시스템 프롬프트로 주입 |
| **AI Classifier** | `01~03 카탈로그` | Few-shot 예시로 활용 |
| **AI Classifier** | `04_CVE_GR_매핑_가이드.md` | 매핑 규칙 참조 |
| **Format Parser** | CWE, OWASP 정의 | 정규화 기준 |
| **Confidence Calculator** | 기존 매핑 데이터 | 유사도 비교 기준 |

### 6.3 분류 파이프라인

```
취약점 데이터 (NVD, GitHub Advisory, etc.)
            │
            ▼
    ┌───────────────┐
    │ Intake Router │  Track 결정 (A/B/C)
    └───────┬───────┘
            │
            ▼
    ┌───────────────┐
    │ Format Parser │  데이터 정규화
    └───────┬───────┘
            │
            ▼
    ┌───────────────┐
    │ AI Structurer │  비정형 → 정형 (필요시)
    └───────┬───────┘
            │
            ▼
    ┌───────────────┐
    │ AI Classifier │  GR 좌표 분류 (지식베이스 참조)
    └───────┬───────┘
            │
            ▼
    ┌───────────────────────────────────┐
    │ vulnerability_classification_log  │  분류 결과 저장
    └───────────────────────────────────┘
```

### 6.4 분류 신뢰도 기준

| 신뢰도 | 설명 | 처리 |
|--------|------|------|
| ≥ 0.90 | 높은 신뢰도 | 자동 승인 가능 |
| 0.70 ~ 0.89 | 중간 신뢰도 | 검토 권장 |
| < 0.70 | 낮은 신뢰도 | 수동 검토 필수 |

---

## 7. 버전 관리 및 업데이트 전략

### 7.1 데이터 소스별 업데이트 주기

| 소스 | URL | 업데이트 주기 | 동기화 전략 |
|------|-----|--------------|-------------|
| **NVD** | https://nvd.nist.gov | 일간 | CVE Feed API 자동 수집 |
| **CWE** | https://cwe.mitre.org | 분기별 | 수동 검토 후 반영 |
| **OWASP** | https://owasp.org/Top10 | 3~4년 주기 | 버전별 별도 테이블 관리 |
| **MITRE ATT&CK** | https://attack.mitre.org | 분기별 | STIX 포맷 동기화 |
| **GitHub Advisory** | https://github.com/advisories | 일간 | GraphQL API 자동 수집 |
| **Exploit-DB** | https://exploit-db.com | 주간 | RSS Feed 모니터링 |

### 7.2 버전 추적 필드

모든 카탈로그 테이블에 다음 필드 포함:

```sql
-- 버전 추적 필드 (각 테이블 공통)
source_version VARCHAR(50),      -- 원본 데이터 버전 (예: 'CWE_4.14', 'OWASP_2021')
last_sync_date TIMESTAMP,        -- 마지막 동기화 일시
data_source VARCHAR(100),        -- 데이터 출처 URL
```

### 7.3 카탈로그 버전 관리

| 카탈로그 | 현재 버전 | 데이터 기준 | 다음 업데이트 |
|----------|----------|------------|--------------|
| CWE | CWE 4.14 | 2024-12 | 2025 Q1 |
| OWASP | 2021 | 2021-09 | 2024/2025 예정 |
| Named Vuln | v1.0 | 2025-12 | 분기별 검토 |
| CVE | Daily | 실시간 | 자동 동기화 |

---

## 8. 버전 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0 | 2025-12-01 | 초기 버전 생성 |
| 1.1 | 2025-12-01 | ER 다이어그램 추가, Engine B 연동 섹션, 버전 관리 전략 추가 |

---

## 9. 관련 문서

- [01_schema.sql](../04_Database_Schema/01_schema.sql) - 기본 DB 스키마
- [02_vulnerability_extension_schema.sql](../04_Database_Schema/02_vulnerability_extension_schema.sql) - 취약점 확장 스키마
- [Engine B_분류엔진_기획서_v1.3.md](../../framework 엔진/Engine B_분류엔진_기획서_v1.3.md) - 분류 엔진 기획서
- [00_차원3_개요.md](../03_차원3_Function_Tag/00_차원3_개요.md) - Function Tag 체계
- [Domain_S_Security.md](../03_차원3_Function_Tag/Domain_S_Security.md) - Security 도메인 태그
