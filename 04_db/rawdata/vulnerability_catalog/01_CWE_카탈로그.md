# CWE (Common Weakness Enumeration) 카탈로그

> **목적**: GR Framework에서 관리하는 주요 CWE 목록 및 GR 좌표 매핑

---

## 1. CWE Top 25 (2023)

### 1.1 메모리 안전 관련

| CWE ID | 이름 | 한글명 | 추상화 | GR Layer | GR Zone |
|--------|------|--------|--------|----------|---------|
| **CWE-787** | Out-of-bounds Write | 범위 밖 쓰기 | Base | L2, L6 | Zone_2 |
| **CWE-125** | Out-of-bounds Read | 범위 밖 읽기 | Base | L2, L6 | Zone_2 |
| **CWE-416** | Use After Free | 해제 후 사용 | Variant | L6 | Zone_2 |
| **CWE-476** | NULL Pointer Dereference | NULL 포인터 역참조 | Base | L6 | Zone_2 |
| **CWE-190** | Integer Overflow | 정수 오버플로 | Base | L2, L6 | Zone_2 |
| **CWE-119** | Buffer Overflow | 버퍼 오버플로 | Class | L2, L6 | Zone_2 |

### 1.2 인젝션 관련

| CWE ID | 이름 | 한글명 | 추상화 | GR Layer | GR Zone |
|--------|------|--------|--------|----------|---------|
| **CWE-79** | XSS | 크로스 사이트 스크립팅 | Base | L2 | Zone_1, Zone_2 |
| **CWE-89** | SQL Injection | SQL 인젝션 | Base | L2, L3 | Zone_2, Zone_3 |
| **CWE-78** | OS Command Injection | OS 명령 인젝션 | Base | L2, L6 | Zone_2 |
| **CWE-77** | Command Injection | 명령 인젝션 | Class | L2, L6 | Zone_2 |
| **CWE-94** | Code Injection | 코드 인젝션 | Base | L2 | Zone_2 |
| **CWE-917** | Expression Language Injection | EL 인젝션 | Base | L2 | Zone_2 |

### 1.3 인증/권한 관련

| CWE ID | 이름 | 한글명 | 추상화 | GR Layer | GR Zone |
|--------|------|--------|--------|----------|---------|
| **CWE-287** | Improper Authentication | 부적절한 인증 | Class | L1, L2 | Zone_1, Zone_2 |
| **CWE-306** | Missing Authentication | 인증 누락 | Base | L2 | Zone_2 |
| **CWE-862** | Missing Authorization | 권한 부여 누락 | Class | L2 | Zone_2 |
| **CWE-863** | Incorrect Authorization | 잘못된 권한 부여 | Class | L2 | Zone_2 |
| **CWE-798** | Hardcoded Credentials | 하드코딩된 자격증명 | Base | L2, L4 | Zone_2, Zone_4 |
| **CWE-352** | CSRF | 크로스 사이트 요청 위조 | Compound | L2 | Zone_1 |

### 1.4 데이터 처리 관련

| CWE ID | 이름 | 한글명 | 추상화 | GR Layer | GR Zone |
|--------|------|--------|--------|----------|---------|
| **CWE-20** | Improper Input Validation | 부적절한 입력 검증 | Class | L1, L2 | Zone_1, Zone_2 |
| **CWE-22** | Path Traversal | 경로 탐색 | Base | L2 | Zone_2 |
| **CWE-434** | Unrestricted File Upload | 무제한 파일 업로드 | Base | L2 | Zone_2 |
| **CWE-502** | Deserialization | 역직렬화 취약점 | Base | L2, L6 | Zone_2 |
| **CWE-918** | SSRF | 서버 측 요청 위조 | Base | L2 | Zone_2, Zone_3 |

---

## 2. CWE 상세 정의

### 2.1 CWE-79: Cross-site Scripting (XSS)

```yaml
id: CWE-79
name: "Improper Neutralization of Input During Web Page Generation"
name_ko: "웹 페이지 생성 시 입력값 부적절한 무력화"
short_name: "XSS"
abstraction: Base

description: |
  사용자 제어 입력이 동적으로 생성되는 웹 페이지에 포함될 때,
  악성 스크립트가 실행될 수 있는 취약점

likelihood_of_exploit: High

gr_mapping:
  layers: [L2]
  zones: [Zone_1, Zone_2]
  primary_tags: [A3.2]  # Input Processing
  detection_tags: [M6.1, S1.1]  # Log Analytics, WAF
  mitigation_tags: [S2.1, A3.2]  # Input Validation

owasp_mapping: ["A03:2021"]  # Injection

common_consequences:
  - scope: Confidentiality
    impact: Read Data (세션 탈취)
  - scope: Integrity
    impact: Execute Unauthorized Code
  - scope: Access Control
    impact: Bypass Protection Mechanism

subtypes:
  - CWE-79.1: Reflected XSS
  - CWE-79.2: Stored XSS
  - CWE-79.3: DOM-based XSS

mitigations:
  - phase: Implementation
    description: "출력 인코딩 (HTML Entity Encoding)"
  - phase: Implementation
    description: "Content Security Policy (CSP) 헤더 적용"
  - phase: Architecture
    description: "입력 검증 및 허용 목록 기반 필터링"
```

### 2.2 CWE-89: SQL Injection

```yaml
id: CWE-89
name: "Improper Neutralization of Special Elements in SQL Command"
name_ko: "SQL 명령에 사용되는 특수 요소의 부적절한 무력화"
short_name: "SQL Injection"
abstraction: Base

description: |
  사용자 입력이 SQL 쿼리에 직접 포함되어 의도치 않은
  SQL 명령이 실행될 수 있는 취약점

likelihood_of_exploit: High

gr_mapping:
  layers: [L2, L3]
  zones: [Zone_2, Zone_3]
  primary_tags: [D2.1, A3.2]  # Database, Input Processing
  detection_tags: [M6.1, S1.2]  # Log Analytics, IDS
  mitigation_tags: [D2.3, S2.1]  # Prepared Statement, Input Validation

owasp_mapping: ["A03:2021"]  # Injection

common_consequences:
  - scope: Confidentiality
    impact: Read Data (데이터베이스 정보 유출)
  - scope: Integrity
    impact: Modify Data (데이터 변조)
  - scope: Availability
    impact: DoS (데이터 삭제)

mitigations:
  - phase: Implementation
    description: "Prepared Statement / Parameterized Query 사용"
  - phase: Implementation
    description: "ORM 사용 (적절한 설정 필요)"
  - phase: Architecture
    description: "최소 권한 원칙 (DB 계정)"
```

### 2.3 CWE-502: Deserialization of Untrusted Data

```yaml
id: CWE-502
name: "Deserialization of Untrusted Data"
name_ko: "신뢰할 수 없는 데이터의 역직렬화"
short_name: "Deserialization"
abstraction: Base

description: |
  신뢰할 수 없는 데이터를 역직렬화할 때 임의 코드가
  실행되거나 서비스 거부가 발생할 수 있는 취약점

likelihood_of_exploit: High

gr_mapping:
  layers: [L2, L6]
  zones: [Zone_2]
  primary_tags: [A1.5, R3.1]  # Application Framework, Runtime
  detection_tags: [M6.1, S1.2]
  mitigation_tags: [A3.3, S2.2]  # Input Validation, Serialization Control

owasp_mapping: ["A08:2021"]  # Software and Data Integrity Failures

notable_vulnerabilities:
  - Log4Shell (CVE-2021-44228)
  - Apache Commons Collections
  - Java Deserialization

common_consequences:
  - scope: Integrity
    impact: Execute Unauthorized Code (RCE)
  - scope: Availability
    impact: DoS

mitigations:
  - phase: Architecture
    description: "신뢰할 수 없는 소스의 역직렬화 금지"
  - phase: Implementation
    description: "화이트리스트 기반 클래스 필터링"
  - phase: Implementation
    description: "JSON/XML 등 안전한 직렬화 형식 사용"
```

### 2.4 CWE-787: Out-of-bounds Write

```yaml
id: CWE-787
name: "Out-of-bounds Write"
name_ko: "범위 밖 쓰기"
short_name: "OOB Write"
abstraction: Base

description: |
  의도된 버퍼 범위를 벗어나 데이터를 쓸 때 발생하는 취약점.
  메모리 손상, 코드 실행, 시스템 충돌을 유발할 수 있음

likelihood_of_exploit: High

gr_mapping:
  layers: [L2, L6]
  zones: [Zone_2]
  primary_tags: [A1.1, R1.1]  # Application Code, Runtime
  detection_tags: [M1.3, S1.3]  # Memory Monitoring, RASP
  mitigation_tags: [A2.1, R2.1]  # Memory Safe Language, Bounds Checking

owasp_mapping: []  # 메모리 관련 - OWASP Top 10에 직접 매핑 없음

notable_vulnerabilities:
  - EternalBlue (CVE-2017-0144)
  - BlueKeep (CVE-2019-0708)

common_consequences:
  - scope: Integrity
    impact: Execute Unauthorized Code
  - scope: Availability
    impact: DoS (Crash)
  - scope: Confidentiality
    impact: Read Memory

mitigations:
  - phase: Implementation
    description: "메모리 안전 언어 사용 (Rust, Go)"
  - phase: Implementation
    description: "경계 검사 (Bounds Checking)"
  - phase: Build
    description: "ASLR, DEP, Stack Canary 활성화"
```

### 2.5 CWE-918: Server-Side Request Forgery (SSRF)

```yaml
id: CWE-918
name: "Server-Side Request Forgery"
name_ko: "서버 측 요청 위조"
short_name: "SSRF"
abstraction: Base

description: |
  서버가 사용자 제어 URL로 요청을 보내도록 유도하여
  내부 시스템에 접근하거나 정보를 유출하는 취약점

likelihood_of_exploit: High

gr_mapping:
  layers: [L2]
  zones: [Zone_2, Zone_3]
  primary_tags: [N4.1, A3.2]  # Outbound Request, Input Processing
  detection_tags: [N2.1, M6.1]  # Network Monitoring, Log Analytics
  mitigation_tags: [N8.1, S2.1]  # Egress Filtering, Input Validation

owasp_mapping: ["A10:2021"]  # SSRF

notable_vulnerabilities:
  - ProxyLogon (CVE-2021-26855)
  - Capital One Breach (2019)

common_consequences:
  - scope: Confidentiality
    impact: Read Internal Data
  - scope: Integrity
    impact: Modify Internal Systems
  - scope: Access Control
    impact: Bypass Firewall

mitigations:
  - phase: Architecture
    description: "URL 화이트리스트 적용"
  - phase: Implementation
    description: "내부 IP 대역 차단 (127.0.0.1, 10.x, 172.16.x, 192.168.x)"
  - phase: Architecture
    description: "네트워크 세그멘테이션"
```

---

## 3. CWE 계층 구조

```
CWE-1000 (Research Concepts - View)
├── CWE-707 (Improper Neutralization - Pillar)
│   ├── CWE-74 (Injection - Class)
│   │   ├── CWE-77 (Command Injection - Class)
│   │   │   ├── CWE-78 (OS Command Injection - Base)
│   │   │   └── CWE-88 (Argument Injection - Base)
│   │   ├── CWE-89 (SQL Injection - Base)
│   │   ├── CWE-79 (XSS - Base)
│   │   └── CWE-94 (Code Injection - Base)
│   └── CWE-20 (Improper Input Validation - Class)
│
├── CWE-664 (Improper Control of a Resource - Pillar)
│   ├── CWE-118 (Buffer Access - Class)
│   │   ├── CWE-119 (Buffer Overflow - Class)
│   │   │   ├── CWE-787 (Out-of-bounds Write - Base)
│   │   │   └── CWE-125 (Out-of-bounds Read - Base)
│   │   └── CWE-416 (Use After Free - Variant)
│   └── CWE-502 (Deserialization - Base)
│
└── CWE-284 (Improper Access Control - Pillar)
    ├── CWE-287 (Improper Authentication - Class)
    │   ├── CWE-306 (Missing Authentication - Base)
    │   └── CWE-798 (Hardcoded Credentials - Base)
    └── CWE-285 (Improper Authorization - Class)
        ├── CWE-862 (Missing Authorization - Class)
        └── CWE-863 (Incorrect Authorization - Class)
```

---

## 4. GR 좌표 매핑 요약

### 4.1 Layer별 주요 CWE

| Layer | 주요 CWE | 설명 |
|-------|----------|------|
| **L1 (Perimeter)** | CWE-20, CWE-287 | 입력 검증, 인증 |
| **L2 (Application)** | CWE-79, CWE-89, CWE-502, CWE-918 | 웹 애플리케이션 취약점 |
| **L3 (Data)** | CWE-89, CWE-311, CWE-359 | 데이터베이스, 암호화 |
| **L4 (Management)** | CWE-798, CWE-532 | 설정, 로깅 |
| **L5 (Endpoint)** | CWE-79, CWE-352 | 클라이언트 측 |
| **L6 (Runtime)** | CWE-787, CWE-416, CWE-502 | 메모리, 런타임 |

### 4.2 Zone별 주요 CWE

| Zone | 주요 CWE | 설명 |
|------|----------|------|
| **Zone_0-A (External)** | 모든 공격 시작점 | 외부 공격자 |
| **Zone_1 (Perimeter)** | CWE-79, CWE-352, CWE-20 | 경계 보안 |
| **Zone_2 (Application)** | CWE-89, CWE-502, CWE-918 | 애플리케이션 |
| **Zone_3 (Data)** | CWE-89, CWE-311 | 데이터 저장 |
| **Zone_4 (Management)** | CWE-798, CWE-306 | 관리 영역 |

---

## 5. 참고 자료

- [MITRE CWE](https://cwe.mitre.org/)
- [CWE Top 25 (2023)](https://cwe.mitre.org/top25/archive/2023/2023_top25_list.html)
- [OWASP CWE Mapping](https://owasp.org/www-community/vulnerabilities/)
