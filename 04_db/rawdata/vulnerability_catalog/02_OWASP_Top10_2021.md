# OWASP Top 10 2021 카탈로그

> **목적**: OWASP Top 10 2021 상세 정보 및 GR Framework 좌표 매핑

---

## 1. OWASP Top 10 2021 개요

| 순위 | ID | 이름 | 한글명 |
|------|-----|------|--------|
| 1 | A01:2021 | Broken Access Control | 취약한 접근 제어 |
| 2 | A02:2021 | Cryptographic Failures | 암호화 실패 |
| 3 | A03:2021 | Injection | 인젝션 |
| 4 | A04:2021 | Insecure Design | 안전하지 않은 설계 |
| 5 | A05:2021 | Security Misconfiguration | 보안 설정 오류 |
| 6 | A06:2021 | Vulnerable Components | 취약하고 오래된 컴포넌트 |
| 7 | A07:2021 | Auth Failures | 식별 및 인증 실패 |
| 8 | A08:2021 | Integrity Failures | 소프트웨어 및 데이터 무결성 실패 |
| 9 | A09:2021 | Logging Failures | 보안 로깅 및 모니터링 실패 |
| 10 | A10:2021 | SSRF | 서버 측 요청 위조 |

---

## 2. 상세 정의

### A01:2021 - Broken Access Control (취약한 접근 제어)

```yaml
id: "A01:2021"
rank: 1
name: "Broken Access Control"
name_ko: "취약한 접근 제어"

description: |
  사용자가 의도된 권한을 벗어나 행동할 수 있는 취약점.
  인가되지 않은 정보 공개, 수정, 삭제 또는 권한 상승 가능.

statistics:
  max_incidence_rate: 55.97%
  avg_incidence_rate: 3.81%
  total_cves: 318,000+

gr_mapping:
  layers: [L2]
  zones: [Zone_2]
  primary_tags: [S2.2, A4.1]  # Access Control, Authorization
  detection_tags: [M6.1, S1.2]
  mitigation_tags: [S2.2.1, S2.2.2]  # RBAC, ABAC

mapped_cwes:
  - CWE-22 (Path Traversal)
  - CWE-284 (Improper Access Control)
  - CWE-352 (CSRF)
  - CWE-639 (Authorization Bypass)
  - CWE-862 (Missing Authorization)
  - CWE-863 (Incorrect Authorization)

prevention:
  - "기본 거부 원칙 (Deny by Default)"
  - "중앙 집중식 접근 제어 메커니즘"
  - "리소스 소유권 검증"
  - "JWT 토큰 무효화 구현"
  - "CORS 정책 최소화"

attack_scenarios:
  - name: "IDOR (Insecure Direct Object Reference)"
    description: "URL의 ID 값 변경으로 다른 사용자 데이터 접근"
    example: "/api/users/123/profile → /api/users/456/profile"

  - name: "권한 상승"
    description: "일반 사용자가 관리자 기능에 접근"
    example: "role=user 파라미터를 role=admin으로 변조"
```

### A02:2021 - Cryptographic Failures (암호화 실패)

```yaml
id: "A02:2021"
rank: 2
name: "Cryptographic Failures"
name_ko: "암호화 실패"

description: |
  민감한 데이터를 보호하기 위한 암호화 관련 실패.
  이전 명칭: "Sensitive Data Exposure"

gr_mapping:
  layers: [L2, L3, L5]
  zones: [Zone_1, Zone_2, Zone_3]
  primary_tags: [S3.1, S3.2]  # Encryption, Key Management
  detection_tags: [M6.1, S4.1]
  mitigation_tags: [S3.1.1, S3.2.1]  # TLS, HSM

mapped_cwes:
  - CWE-261 (Weak Encoding for Password)
  - CWE-319 (Cleartext Transmission)
  - CWE-326 (Inadequate Encryption Strength)
  - CWE-327 (Broken or Risky Crypto Algorithm)
  - CWE-328 (Reversible One-Way Hash)

prevention:
  - "전송 중 데이터: TLS 1.2+ 사용"
  - "저장 데이터: AES-256 암호화"
  - "비밀번호: bcrypt, scrypt, Argon2 사용"
  - "약한 알고리즘 금지: MD5, SHA1, DES"
  - "키 관리 시스템 사용 (HSM, KMS)"

vulnerable_patterns:
  - "HTTP로 민감 데이터 전송"
  - "MD5/SHA1로 비밀번호 해싱"
  - "하드코딩된 암호화 키"
  - "자체 구현 암호화 알고리즘"
```

### A03:2021 - Injection (인젝션)

```yaml
id: "A03:2021"
rank: 3
name: "Injection"
name_ko: "인젝션"

description: |
  신뢰할 수 없는 데이터가 인터프리터에 명령 또는 쿼리의
  일부로 전송될 때 발생하는 취약점

statistics:
  max_incidence_rate: 19.09%
  avg_incidence_rate: 3.37%
  total_cves: 274,000+

gr_mapping:
  layers: [L2, L3, L6]
  zones: [Zone_2, Zone_3]
  primary_tags: [A3.2, D2.1]  # Input Processing, Database
  detection_tags: [S1.1, M6.1]  # WAF, Log Analytics
  mitigation_tags: [S2.1, D2.3]  # Input Validation, Prepared Statement

mapped_cwes:
  - CWE-79 (XSS)
  - CWE-89 (SQL Injection)
  - CWE-78 (OS Command Injection)
  - CWE-94 (Code Injection)
  - CWE-917 (Expression Language Injection)

prevention:
  - "Prepared Statement / Parameterized Query"
  - "입력 검증 (화이트리스트)"
  - "출력 인코딩"
  - "ORM 사용 (안전한 설정)"
  - "WAF 배포"

injection_types:
  - type: "SQL Injection"
    target: "Database"
    example: "' OR '1'='1"
  - type: "XSS"
    target: "Browser"
    example: "<script>alert('XSS')</script>"
  - type: "OS Command"
    target: "Server OS"
    example: "; rm -rf /"
  - type: "LDAP Injection"
    target: "Directory Service"
    example: "*)(&"
```

### A04:2021 - Insecure Design (안전하지 않은 설계)

```yaml
id: "A04:2021"
rank: 4
name: "Insecure Design"
name_ko: "안전하지 않은 설계"

description: |
  설계 단계에서의 보안 결함. 구현 결함과 구분됨.
  2021년 신규 카테고리.

gr_mapping:
  layers: [L2, L4]
  zones: [Zone_2, Zone_4]
  primary_tags: [A1.1, P1.1]  # Architecture, Design
  detection_tags: [M6.1]
  mitigation_tags: [A1.2, P1.2]  # Security Architecture, Threat Modeling

mapped_cwes:
  - CWE-209 (Error Message Information Leak)
  - CWE-256 (Plaintext Storage of Password)
  - CWE-501 (Trust Boundary Violation)
  - CWE-522 (Insufficiently Protected Credentials)

prevention:
  - "Secure Development Lifecycle (SDL)"
  - "위협 모델링 (Threat Modeling)"
  - "보안 설계 패턴 사용"
  - "보안 사용 사례 / 남용 사례 정의"
  - "계층별 보안 (Defense in Depth)"

design_flaws:
  - name: "Business Logic Flaw"
    description: "비즈니스 로직의 보안 취약점"
  - name: "Missing Rate Limiting"
    description: "무차별 대입 공격 방어 부재"
  - name: "Insecure Defaults"
    description: "안전하지 않은 기본 설정"
```

### A05:2021 - Security Misconfiguration (보안 설정 오류)

```yaml
id: "A05:2021"
rank: 5
name: "Security Misconfiguration"
name_ko: "보안 설정 오류"

description: |
  애플리케이션 스택의 모든 수준에서 발생할 수 있는
  잘못된 보안 설정

statistics:
  max_incidence_rate: 19.84%
  avg_incidence_rate: 4.51%

gr_mapping:
  layers: [L1, L2, L4, L6]
  zones: [Zone_1, Zone_2, Zone_4]
  primary_tags: [P2.1, S4.1]  # Configuration, Hardening
  detection_tags: [M6.1, S5.1]  # Log Analytics, Vulnerability Scanner
  mitigation_tags: [P2.2, S4.2]  # Secure Configuration, IaC

mapped_cwes:
  - CWE-16 (Configuration)
  - CWE-611 (XXE)
  - CWE-1004 (Sensitive Cookie Without HttpOnly)
  - CWE-1032 (OWASP Top 10 2017 A6)

prevention:
  - "보안 강화 가이드라인 적용"
  - "불필요한 기능/서비스 비활성화"
  - "기본 자격 증명 변경"
  - "오류 메시지 최소화"
  - "자동화된 설정 검증"

common_misconfigurations:
  - "디버그 모드 활성화된 프로덕션"
  - "기본 관리자 계정 사용"
  - "불필요한 포트 개방"
  - "디렉토리 리스팅 활성화"
  - "상세한 오류 메시지 노출"
```

### A06:2021 - Vulnerable and Outdated Components

```yaml
id: "A06:2021"
rank: 6
name: "Vulnerable and Outdated Components"
name_ko: "취약하고 오래된 컴포넌트"

description: |
  알려진 취약점이 있는 소프트웨어 컴포넌트 사용

gr_mapping:
  layers: [L2, L4, L6]
  zones: [Zone_2, Zone_4]
  primary_tags: [T1.1, P3.1]  # Tech Stack, Dependency Management
  detection_tags: [S5.1, M6.1]  # Vulnerability Scanner, SCA
  mitigation_tags: [P3.2, P3.3]  # Patch Management, SBOM

mapped_cwes:
  - CWE-829 (Inclusion of Functionality from Untrusted Control Sphere)
  - CWE-1035 (Using Components with Known Vulnerabilities)
  - CWE-1104 (Use of Unmaintained Third Party Components)

prevention:
  - "Software Composition Analysis (SCA)"
  - "SBOM (Software Bill of Materials) 관리"
  - "정기적인 취약점 스캔"
  - "패치 관리 프로세스"
  - "의존성 업데이트 자동화"

tools:
  - "OWASP Dependency-Check"
  - "Snyk"
  - "npm audit / yarn audit"
  - "pip-audit"
  - "Trivy"
```

### A07:2021 - Identification and Authentication Failures

```yaml
id: "A07:2021"
rank: 7
name: "Identification and Authentication Failures"
name_ko: "식별 및 인증 실패"

description: |
  사용자 신원 확인, 인증, 세션 관리와 관련된 취약점

gr_mapping:
  layers: [L1, L2]
  zones: [Zone_1, Zone_2]
  primary_tags: [S2.1, S2.2]  # Authentication, Session Management
  detection_tags: [M6.1, S1.3]  # Log Analytics, Failed Login Detection
  mitigation_tags: [S2.1.1, S2.1.2]  # MFA, Strong Password Policy

mapped_cwes:
  - CWE-287 (Improper Authentication)
  - CWE-384 (Session Fixation)
  - CWE-521 (Weak Password Requirements)
  - CWE-613 (Insufficient Session Expiration)
  - CWE-798 (Hardcoded Credentials)

prevention:
  - "다중 인증 (MFA) 구현"
  - "강력한 비밀번호 정책"
  - "계정 잠금 메커니즘"
  - "안전한 세션 관리"
  - "Credential Stuffing 방어"

attack_vectors:
  - "Brute Force Attack"
  - "Credential Stuffing"
  - "Session Hijacking"
  - "Session Fixation"
```

### A08:2021 - Software and Data Integrity Failures

```yaml
id: "A08:2021"
rank: 8
name: "Software and Data Integrity Failures"
name_ko: "소프트웨어 및 데이터 무결성 실패"

description: |
  소프트웨어 업데이트, 중요 데이터, CI/CD 파이프라인의
  무결성 검증 실패

gr_mapping:
  layers: [L2, L4, L6]
  zones: [Zone_2, Zone_4]
  primary_tags: [P4.1, S6.1]  # CI/CD, Integrity Verification
  detection_tags: [M6.1, S5.2]
  mitigation_tags: [P4.2, S6.2]  # Secure Pipeline, Code Signing

mapped_cwes:
  - CWE-345 (Insufficient Verification of Data Authenticity)
  - CWE-494 (Download of Code Without Integrity Check)
  - CWE-502 (Deserialization of Untrusted Data)
  - CWE-829 (Inclusion of Functionality from Untrusted Control Sphere)

prevention:
  - "코드 서명 및 검증"
  - "의존성 무결성 검증 (checksum)"
  - "CI/CD 파이프라인 보안"
  - "안전한 역직렬화"
  - "자동 업데이트 무결성 검증"

notable_vulnerabilities:
  - "Log4Shell (CVE-2021-44228)"
  - "SolarWinds Supply Chain Attack"
```

### A09:2021 - Security Logging and Monitoring Failures

```yaml
id: "A09:2021"
rank: 9
name: "Security Logging and Monitoring Failures"
name_ko: "보안 로깅 및 모니터링 실패"

description: |
  적절한 로깅, 탐지, 모니터링, 대응이 없으면
  공격을 탐지하거나 대응할 수 없음

gr_mapping:
  layers: [Cross-Layer]
  zones: [Zone_4]
  primary_tags: [M1.1, M6.1]  # Logging, SIEM
  detection_tags: [M6.2, S1.2]  # Alert, IDS
  mitigation_tags: [M1.2, M6.3]  # Centralized Logging, Incident Response

mapped_cwes:
  - CWE-117 (Improper Output Neutralization for Logs)
  - CWE-223 (Omission of Security-relevant Information)
  - CWE-532 (Insertion of Sensitive Information into Log File)
  - CWE-778 (Insufficient Logging)

prevention:
  - "모든 인증 이벤트 로깅"
  - "접근 제어 실패 로깅"
  - "입력 검증 실패 로깅"
  - "중앙 집중식 로그 관리 (SIEM)"
  - "실시간 모니터링 및 알림"

logging_requirements:
  - "Who: 사용자 식별 정보"
  - "What: 수행된 작업"
  - "When: 타임스탬프"
  - "Where: IP, 위치"
  - "Result: 성공/실패"
```

### A10:2021 - Server-Side Request Forgery (SSRF)

```yaml
id: "A10:2021"
rank: 10
name: "Server-Side Request Forgery"
name_ko: "서버 측 요청 위조"

description: |
  서버가 사용자 제공 URL로 요청을 보내도록 유도하여
  내부 리소스에 접근하는 취약점. 2021년 신규 항목.

gr_mapping:
  layers: [L2]
  zones: [Zone_2, Zone_3]
  primary_tags: [N4.1, A3.2]  # Outbound Request, Input Processing
  detection_tags: [N2.1, M6.1]  # Network Monitoring, Log Analytics
  mitigation_tags: [N8.1, S2.1]  # Egress Filtering, Input Validation

mapped_cwes:
  - CWE-918 (Server-Side Request Forgery)

prevention:
  - "URL 화이트리스트 적용"
  - "내부 IP 대역 차단"
  - "DNS 리바인딩 방어"
  - "네트워크 세그멘테이션"
  - "Egress 방화벽 규칙"

attack_scenarios:
  - name: "Internal Port Scanning"
    description: "내부 네트워크 포트 스캔"
  - name: "Cloud Metadata Access"
    description: "AWS/GCP 메타데이터 서비스 접근 (169.254.169.254)"
  - name: "Internal Service Access"
    description: "내부 관리 서비스 접근"

notable_vulnerabilities:
  - "ProxyLogon (CVE-2021-26855)"
  - "Capital One Breach (2019)"
```

---

## 3. GR 좌표 매핑 요약

| OWASP ID | 주요 Layer | 주요 Zone | 주요 Tag |
|----------|-----------|-----------|----------|
| A01 | L2 | Zone_2 | S2.2 (Access Control) |
| A02 | L2, L3 | Zone_1, Zone_3 | S3.1 (Encryption) |
| A03 | L2 | Zone_2 | A3.2 (Input Processing) |
| A04 | L2, L4 | Zone_2 | A1.1 (Architecture) |
| A05 | L1, L2, L4 | Zone_1, Zone_4 | P2.1 (Configuration) |
| A06 | L2, L4 | Zone_2 | T1.1 (Tech Stack) |
| A07 | L1, L2 | Zone_1 | S2.1 (Authentication) |
| A08 | L2, L4 | Zone_4 | P4.1 (CI/CD) |
| A09 | Cross-Layer | Zone_4 | M6.1 (SIEM) |
| A10 | L2 | Zone_2 | N4.1 (Outbound Request) |

---

## 4. 2017 → 2021 변경 사항

| 2017 | 2021 | 변경 |
|------|------|------|
| A1 Injection | A03 Injection | 순위 하락 |
| A2 Broken Authentication | A07 Auth Failures | 순위 하락 |
| A3 Sensitive Data Exposure | A02 Cryptographic Failures | 이름 변경 |
| A4 XXE | A05 (병합) | Security Misconfiguration에 병합 |
| A5 Broken Access Control | A01 Broken Access Control | **1위로 상승** |
| A6 Security Misconfiguration | A05 Security Misconfiguration | - |
| A7 XSS | A03 (병합) | Injection에 병합 |
| A8 Insecure Deserialization | A08 Integrity Failures | 범위 확대 |
| A9 Using Components | A06 Vulnerable Components | - |
| A10 Insufficient Logging | A09 Logging Failures | - |
| - | **A04 Insecure Design** | **신규** |
| - | **A10 SSRF** | **신규** |

---

## 5. 참고 자료

- [OWASP Top 10 2021](https://owasp.org/Top10/)
- [OWASP Top 10 2017](https://owasp.org/www-project-top-ten/2017/)
- [OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/)
